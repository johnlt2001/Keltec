{"version":3,"file":"storefront-kit-react.prod.js","sources":["../../../../node_modules/@xstate/fsm/es/index.js","../../../../node_modules/use-isomorphic-layout-effect/dist/use-isomorphic-layout-effect.browser.esm.js","../../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js","../../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.development.js","../../../../node_modules/use-sync-external-store/shim/index.js","../../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.min.js","../../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.development.js","../../../../node_modules/use-sync-external-store/shim/with-selector.js","../../../../node_modules/@xstate/react/es/useConstant.js","../../../../node_modules/@xstate/react/es/fsm.js","../../src/flatten-connection.ts","../../src/cart-queries.ts","../../src/storefront-api-constants.ts","../../src/storefront-client.ts","../../src/ShopifyProvider.tsx","../../src/cart-constants.ts","../../../../node_modules/worktop/cookie/index.mjs","../../src/cookies-utils.tsx","../../src/cart-hooks.tsx","../../src/useCartActions.tsx","../../src/useCartAPIStateMachine.tsx","../../src/CartProvider.tsx","../../src/ProductProvider.tsx","../../src/BaseButton.tsx","../../src/AddToCartButton.tsx","../../src/BuyNowButton.tsx","../../src/CartCheckoutButton.tsx","../../src/codegen.helpers.ts","../../src/ExternalVideo.tsx","../../src/image-size.ts","../../src/Image.tsx","../../src/Video.tsx","../../src/load-script.tsx","../../src/ModelViewer.tsx","../../src/MediaFile.tsx","../../src/parse-metafield.ts","../../src/useMoney.tsx","../../src/Money.tsx","../../src/ProductPrice.tsx","../../src/analytics-utils.ts","../../src/ShopPayButton.tsx","../../src/analytics-constants.ts","../../src/useShopifyCookies.tsx","../../src/analytics-schema-trekkie-storefront-page-view.ts","../../src/analytics-schema-custom-storefront-customer-tracking.ts","../../src/analytics.ts"],"sourcesContent":["/*! *****************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\nfunction t(t,n){var e=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,i,o=e.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(i)throw i.error}}return a}var n;!function(t){t[t.NotStarted=0]=\"NotStarted\",t[t.Running=1]=\"Running\",t[t.Stopped=2]=\"Stopped\"}(n||(n={}));var e={type:\"xstate.init\"};function r(t){return void 0===t?[]:[].concat(t)}function i(t){return{type:\"xstate.assign\",assignment:t}}function o(t,n){return\"string\"==typeof(t=\"string\"==typeof t&&n&&n[t]?n[t]:t)?{type:t}:\"function\"==typeof t?{type:t.name,exec:t}:t}function a(t){return function(n){return t===n}}function u(t){return\"string\"==typeof t?{type:t}:t}function c(t,n){return{value:t,context:n,actions:[],changed:!1,matches:a(t)}}function f(t,n,e){var r=n,i=!1;return[t.filter((function(t){if(\"xstate.assign\"===t.type){i=!0;var n=Object.assign({},r);return\"function\"==typeof t.assignment?n=t.assignment(r,e):Object.keys(t.assignment).forEach((function(i){n[i]=\"function\"==typeof t.assignment[i]?t.assignment[i](r,e):t.assignment[i]})),r=n,!1}return!0})),r,i]}function s(n,i){void 0===i&&(i={});var s=t(f(r(n.states[n.initial].entry).map((function(t){return o(t,i.actions)})),n.context,e),2),l=s[0],v=s[1],y={config:n,_options:i,initialState:{value:n.initial,actions:l,context:v,matches:a(n.initial)},transition:function(e,i){var s,l,v=\"string\"==typeof e?{value:e,context:n.context}:e,p=v.value,g=v.context,d=u(i),x=n.states[p];if(x.on){var m=r(x.on[d.type]);try{for(var h=function(t){var n=\"function\"==typeof Symbol&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}(m),b=h.next();!b.done;b=h.next()){var S=b.value;if(void 0===S)return c(p,g);var w=\"string\"==typeof S?{target:S}:S,j=w.target,E=w.actions,R=void 0===E?[]:E,N=w.cond,O=void 0===N?function(){return!0}:N,_=void 0===j,k=null!=j?j:p,T=n.states[k];if(O(g,d)){var q=t(f((_?r(R):[].concat(x.exit,R,T.entry).filter((function(t){return t}))).map((function(t){return o(t,y._options.actions)})),g,d),3),z=q[0],A=q[1],B=q[2],C=null!=j?j:p;return{value:C,context:A,actions:z,changed:j!==p||z.length>0||B,matches:a(C)}}}}catch(t){s={error:t}}finally{try{b&&!b.done&&(l=h.return)&&l.call(h)}finally{if(s)throw s.error}}}return c(p,g)}};return y}var l=function(t,n){return t.actions.forEach((function(e){var r=e.exec;return r&&r(t.context,n)}))};function v(t){var r=t.initialState,i=n.NotStarted,o=new Set,c={_machine:t,send:function(e){i===n.Running&&(r=t.transition(r,e),l(r,u(e)),o.forEach((function(t){return t(r)})))},subscribe:function(t){return o.add(t),t(r),{unsubscribe:function(){return o.delete(t)}}},start:function(o){if(o){var u=\"object\"==typeof o?o:{context:t.config.context,value:o};r={value:u.value,actions:[],context:u.context,matches:a(u.value)}}else r=t.initialState;return i=n.Running,l(r,e),c},stop:function(){return i=n.Stopped,o.clear(),c},get state(){return r},get status(){return i}};return c}export{n as InterpreterStatus,i as assign,s as createMachine,v as interpret};\n","import { useLayoutEffect } from 'react';\n\nvar index =  useLayoutEffect ;\n\nexport default index;\n","/**\n * @license React\n * use-sync-external-store-shim.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var e=require(\"react\");function h(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var k=\"function\"===typeof Object.is?Object.is:h,l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];n(function(){c.value=d;c.getSnapshot=b;r(c)&&g({inst:c})},[a,d,b]);m(function(){r(c)&&g({inst:c});return a(function(){r(c)&&g({inst:c})})},[a]);p(d);return d}\nfunction r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}function t(a,b){return b()}var u=\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement?t:q;exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u;\n","/**\n * @license React\n * use-sync-external-store-shim.development.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nif (process.env.NODE_ENV !== \"production\") {\n  (function() {\n\n          'use strict';\n\n/* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\nif (\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ !== 'undefined' &&\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart ===\n    'function'\n) {\n  __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error());\n}\n          var React = require('react');\n\nvar ReactSharedInternals = React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\nfunction error(format) {\n  {\n    {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      printWarning('error', format, args);\n    }\n  }\n}\n\nfunction printWarning(level, format, args) {\n  // When changing this logic, you might want to also\n  // update consoleWithStackDev.www.js as well.\n  {\n    var ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\n    var stack = ReactDebugCurrentFrame.getStackAddendum();\n\n    if (stack !== '') {\n      format += '%s';\n      args = args.concat([stack]);\n    } // eslint-disable-next-line react-internal/safe-string-coercion\n\n\n    var argsWithFormat = args.map(function (item) {\n      return String(item);\n    }); // Careful: RN currently depends on this prefix\n\n    argsWithFormat.unshift('Warning: ' + format); // We intentionally don't use spread (or .apply) directly because it\n    // breaks IE9: https://github.com/facebook/react/issues/13610\n    // eslint-disable-next-line react-internal/no-production-logging\n\n    Function.prototype.apply.call(console[level], console, argsWithFormat);\n  }\n}\n\n/**\n * inlined Object.is polyfill to avoid requiring consumers ship their own\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n */\nfunction is(x, y) {\n  return x === y && (x !== 0 || 1 / x === 1 / y) || x !== x && y !== y // eslint-disable-line no-self-compare\n  ;\n}\n\nvar objectIs = typeof Object.is === 'function' ? Object.is : is;\n\n// dispatch for CommonJS interop named imports.\n\nvar useState = React.useState,\n    useEffect = React.useEffect,\n    useLayoutEffect = React.useLayoutEffect,\n    useDebugValue = React.useDebugValue;\nvar didWarnOld18Alpha = false;\nvar didWarnUncachedGetSnapshot = false; // Disclaimer: This shim breaks many of the rules of React, and only works\n// because of a very particular set of implementation details and assumptions\n// -- change any one of them and it will break. The most important assumption\n// is that updates are always synchronous, because concurrent rendering is\n// only available in versions of React that also have a built-in\n// useSyncExternalStore API. And we only use this shim when the built-in API\n// does not exist.\n//\n// Do not assume that the clever hacks used by this hook also work in general.\n// The point of this shim is to replace the need for hacks by other libraries.\n\nfunction useSyncExternalStore(subscribe, getSnapshot, // Note: The shim does not use getServerSnapshot, because pre-18 versions of\n// React do not expose a way to check if we're hydrating. So users of the shim\n// will need to track that themselves and return the correct value\n// from `getSnapshot`.\ngetServerSnapshot) {\n  {\n    if (!didWarnOld18Alpha) {\n      if (React.startTransition !== undefined) {\n        didWarnOld18Alpha = true;\n\n        error('You are using an outdated, pre-release alpha of React 18 that ' + 'does not support useSyncExternalStore. The ' + 'use-sync-external-store shim will not work correctly. Upgrade ' + 'to a newer pre-release.');\n      }\n    }\n  } // Read the current snapshot from the store on every render. Again, this\n  // breaks the rules of React, and only works here because of specific\n  // implementation details, most importantly that updates are\n  // always synchronous.\n\n\n  var value = getSnapshot();\n\n  {\n    if (!didWarnUncachedGetSnapshot) {\n      var cachedValue = getSnapshot();\n\n      if (!objectIs(value, cachedValue)) {\n        error('The result of getSnapshot should be cached to avoid an infinite loop');\n\n        didWarnUncachedGetSnapshot = true;\n      }\n    }\n  } // Because updates are synchronous, we don't queue them. Instead we force a\n  // re-render whenever the subscribed state changes by updating an some\n  // arbitrary useState hook. Then, during render, we call getSnapshot to read\n  // the current value.\n  //\n  // Because we don't actually use the state returned by the useState hook, we\n  // can save a bit of memory by storing other stuff in that slot.\n  //\n  // To implement the early bailout, we need to track some things on a mutable\n  // object. Usually, we would put that in a useRef hook, but we can stash it in\n  // our useState hook instead.\n  //\n  // To force a re-render, we call forceUpdate({inst}). That works because the\n  // new object always fails an equality check.\n\n\n  var _useState = useState({\n    inst: {\n      value: value,\n      getSnapshot: getSnapshot\n    }\n  }),\n      inst = _useState[0].inst,\n      forceUpdate = _useState[1]; // Track the latest getSnapshot function with a ref. This needs to be updated\n  // in the layout phase so we can access it during the tearing check that\n  // happens on subscribe.\n\n\n  useLayoutEffect(function () {\n    inst.value = value;\n    inst.getSnapshot = getSnapshot; // Whenever getSnapshot or subscribe changes, we need to check in the\n    // commit phase if there was an interleaved mutation. In concurrent mode\n    // this can happen all the time, but even in synchronous mode, an earlier\n    // effect may have mutated the store.\n\n    if (checkIfSnapshotChanged(inst)) {\n      // Force a re-render.\n      forceUpdate({\n        inst: inst\n      });\n    }\n  }, [subscribe, value, getSnapshot]);\n  useEffect(function () {\n    // Check for changes right before subscribing. Subsequent changes will be\n    // detected in the subscription handler.\n    if (checkIfSnapshotChanged(inst)) {\n      // Force a re-render.\n      forceUpdate({\n        inst: inst\n      });\n    }\n\n    var handleStoreChange = function () {\n      // TODO: Because there is no cross-renderer API for batching updates, it's\n      // up to the consumer of this library to wrap their subscription event\n      // with unstable_batchedUpdates. Should we try to detect when this isn't\n      // the case and print a warning in development?\n      // The store changed. Check if the snapshot changed since the last time we\n      // read from the store.\n      if (checkIfSnapshotChanged(inst)) {\n        // Force a re-render.\n        forceUpdate({\n          inst: inst\n        });\n      }\n    }; // Subscribe to the store and return a clean-up function.\n\n\n    return subscribe(handleStoreChange);\n  }, [subscribe]);\n  useDebugValue(value);\n  return value;\n}\n\nfunction checkIfSnapshotChanged(inst) {\n  var latestGetSnapshot = inst.getSnapshot;\n  var prevValue = inst.value;\n\n  try {\n    var nextValue = latestGetSnapshot();\n    return !objectIs(prevValue, nextValue);\n  } catch (error) {\n    return true;\n  }\n}\n\nfunction useSyncExternalStore$1(subscribe, getSnapshot, getServerSnapshot) {\n  // Note: The shim does not use getServerSnapshot, because pre-18 versions of\n  // React do not expose a way to check if we're hydrating. So users of the shim\n  // will need to track that themselves and return the correct value\n  // from `getSnapshot`.\n  return getSnapshot();\n}\n\nvar canUseDOM = !!(typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.document.createElement !== 'undefined');\n\nvar isServerEnvironment = !canUseDOM;\n\nvar shim = isServerEnvironment ? useSyncExternalStore$1 : useSyncExternalStore;\nvar useSyncExternalStore$2 = React.useSyncExternalStore !== undefined ? React.useSyncExternalStore : shim;\n\nexports.useSyncExternalStore = useSyncExternalStore$2;\n          /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\nif (\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ !== 'undefined' &&\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop ===\n    'function'\n) {\n  __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error());\n}\n        \n  })();\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var h=require(\"react\"),n=require(\"use-sync-external-store/shim\");function p(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var q=\"function\"===typeof Object.is?Object.is:p,r=n.useSyncExternalStore,t=h.useRef,u=h.useEffect,v=h.useMemo,w=h.useDebugValue;\nexports.useSyncExternalStoreWithSelector=function(a,b,e,l,g){var c=t(null);if(null===c.current){var f={hasValue:!1,value:null};c.current=f}else f=c.current;c=v(function(){function a(a){if(!c){c=!0;d=a;a=l(a);if(void 0!==g&&f.hasValue){var b=f.value;if(g(b,a))return k=b}return k=a}b=k;if(q(d,a))return b;var e=l(a);if(void 0!==g&&g(b,e))return b;d=a;return k=e}var c=!1,d,k,m=void 0===e?null:e;return[function(){return a(b())},null===m?void 0:function(){return a(m())}]},[b,e,l,g]);var d=r(a,c[0],c[1]);\nu(function(){f.hasValue=!0;f.value=d},[d]);w(d);return d};\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.development.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nif (process.env.NODE_ENV !== \"production\") {\n  (function() {\n\n          'use strict';\n\n/* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\nif (\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ !== 'undefined' &&\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart ===\n    'function'\n) {\n  __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error());\n}\n          var React = require('react');\nvar shim = require('use-sync-external-store/shim');\n\n/**\n * inlined Object.is polyfill to avoid requiring consumers ship their own\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n */\nfunction is(x, y) {\n  return x === y && (x !== 0 || 1 / x === 1 / y) || x !== x && y !== y // eslint-disable-line no-self-compare\n  ;\n}\n\nvar objectIs = typeof Object.is === 'function' ? Object.is : is;\n\nvar useSyncExternalStore = shim.useSyncExternalStore;\n\n// for CommonJS interop.\n\nvar useRef = React.useRef,\n    useEffect = React.useEffect,\n    useMemo = React.useMemo,\n    useDebugValue = React.useDebugValue; // Same as useSyncExternalStore, but supports selector and isEqual arguments.\n\nfunction useSyncExternalStoreWithSelector(subscribe, getSnapshot, getServerSnapshot, selector, isEqual) {\n  // Use this to track the rendered snapshot.\n  var instRef = useRef(null);\n  var inst;\n\n  if (instRef.current === null) {\n    inst = {\n      hasValue: false,\n      value: null\n    };\n    instRef.current = inst;\n  } else {\n    inst = instRef.current;\n  }\n\n  var _useMemo = useMemo(function () {\n    // Track the memoized state using closure variables that are local to this\n    // memoized instance of a getSnapshot function. Intentionally not using a\n    // useRef hook, because that state would be shared across all concurrent\n    // copies of the hook/component.\n    var hasMemo = false;\n    var memoizedSnapshot;\n    var memoizedSelection;\n\n    var memoizedSelector = function (nextSnapshot) {\n      if (!hasMemo) {\n        // The first time the hook is called, there is no memoized result.\n        hasMemo = true;\n        memoizedSnapshot = nextSnapshot;\n\n        var _nextSelection = selector(nextSnapshot);\n\n        if (isEqual !== undefined) {\n          // Even if the selector has changed, the currently rendered selection\n          // may be equal to the new selection. We should attempt to reuse the\n          // current value if possible, to preserve downstream memoizations.\n          if (inst.hasValue) {\n            var currentSelection = inst.value;\n\n            if (isEqual(currentSelection, _nextSelection)) {\n              memoizedSelection = currentSelection;\n              return currentSelection;\n            }\n          }\n        }\n\n        memoizedSelection = _nextSelection;\n        return _nextSelection;\n      } // We may be able to reuse the previous invocation's result.\n\n\n      // We may be able to reuse the previous invocation's result.\n      var prevSnapshot = memoizedSnapshot;\n      var prevSelection = memoizedSelection;\n\n      if (objectIs(prevSnapshot, nextSnapshot)) {\n        // The snapshot is the same as last time. Reuse the previous selection.\n        return prevSelection;\n      } // The snapshot has changed, so we need to compute a new selection.\n\n\n      // The snapshot has changed, so we need to compute a new selection.\n      var nextSelection = selector(nextSnapshot); // If a custom isEqual function is provided, use that to check if the data\n      // has changed. If it hasn't, return the previous selection. That signals\n      // to React that the selections are conceptually equal, and we can bail\n      // out of rendering.\n\n      // If a custom isEqual function is provided, use that to check if the data\n      // has changed. If it hasn't, return the previous selection. That signals\n      // to React that the selections are conceptually equal, and we can bail\n      // out of rendering.\n      if (isEqual !== undefined && isEqual(prevSelection, nextSelection)) {\n        return prevSelection;\n      }\n\n      memoizedSnapshot = nextSnapshot;\n      memoizedSelection = nextSelection;\n      return nextSelection;\n    }; // Assigning this to a constant so that Flow knows it can't change.\n\n\n    // Assigning this to a constant so that Flow knows it can't change.\n    var maybeGetServerSnapshot = getServerSnapshot === undefined ? null : getServerSnapshot;\n\n    var getSnapshotWithSelector = function () {\n      return memoizedSelector(getSnapshot());\n    };\n\n    var getServerSnapshotWithSelector = maybeGetServerSnapshot === null ? undefined : function () {\n      return memoizedSelector(maybeGetServerSnapshot());\n    };\n    return [getSnapshotWithSelector, getServerSnapshotWithSelector];\n  }, [getSnapshot, getServerSnapshot, selector, isEqual]),\n      getSelection = _useMemo[0],\n      getServerSelection = _useMemo[1];\n\n  var value = useSyncExternalStore(subscribe, getSelection, getServerSelection);\n  useEffect(function () {\n    inst.hasValue = true;\n    inst.value = value;\n  }, [value]);\n  useDebugValue(value);\n  return value;\n}\n\nexports.useSyncExternalStoreWithSelector = useSyncExternalStoreWithSelector;\n          /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\nif (\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ !== 'undefined' &&\n  typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop ===\n    'function'\n) {\n  __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error());\n}\n        \n  })();\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","import * as React from 'react';\nexport default function useConstant(fn) {\n    var ref = React.useRef();\n    if (!ref.current) {\n        ref.current = { v: fn() };\n    }\n    return ref.current.v;\n}\n","var __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { createMachine, interpret, InterpreterStatus } from '@xstate/fsm';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport useIsomorphicLayoutEffect from 'use-isomorphic-layout-effect';\nimport { useSyncExternalStoreWithSelector } from 'use-sync-external-store/shim/with-selector';\nimport useConstant from './useConstant';\nfunction identity(a) {\n    return a;\n}\nvar getServiceState = function (service) {\n    var currentValue;\n    service\n        .subscribe(function (state) {\n        currentValue = state;\n    })\n        .unsubscribe();\n    return currentValue;\n};\nexport function useMachine(stateMachine, options) {\n    var persistedStateRef = useRef();\n    if (process.env.NODE_ENV !== 'production') {\n        var _a = __read(useState(stateMachine), 1), initialMachine = _a[0];\n        if (stateMachine !== initialMachine) {\n            console.warn('Machine given to `useMachine` has changed between renders. This is not supported and might lead to unexpected results.\\n' +\n                'Please make sure that you pass the same Machine as argument each time.');\n        }\n    }\n    var _b = __read(useConstant(function () {\n        var queue = [];\n        var service = interpret(createMachine(stateMachine.config, options ? options : stateMachine._options));\n        var send = service.send;\n        service.send = function (event) {\n            if (service.status === InterpreterStatus.NotStarted) {\n                queue.push(event);\n                return;\n            }\n            send(event);\n            persistedStateRef.current = service.state;\n        };\n        return [service, queue];\n    }), 2), service = _b[0], queue = _b[1];\n    useIsomorphicLayoutEffect(function () {\n        if (options) {\n            service._machine._options = options;\n        }\n    });\n    var useServiceResult = useService(service);\n    useEffect(function () {\n        service.start(persistedStateRef.current);\n        queue.forEach(service.send);\n        persistedStateRef.current = service.state;\n        return function () {\n            service.stop();\n        };\n    }, []);\n    return useServiceResult;\n}\nvar isEqual = function (_prevState, nextState) { return nextState.changed === false; };\nexport function useService(service) {\n    var getSnapshot = useCallback(function () { return getServiceState(service); }, [service]);\n    var subscribe = useCallback(function (handleStoreChange) {\n        var unsubscribe = service.subscribe(handleStoreChange).unsubscribe;\n        return unsubscribe;\n    }, [service]);\n    var storeSnapshot = useSyncExternalStoreWithSelector(subscribe, getSnapshot, getSnapshot, identity, isEqual);\n    return [storeSnapshot, service.send, service];\n}\n","import type {PartialDeep} from 'type-fest';\n\n/**\n * The `flattenConnection` utility transforms a connection object from the Storefront API (for example, [Product-related connections](https://shopify.dev/api/storefront/reference/products/product)) into a flat array of nodes.\n * The utility works with either `nodes` or `edges.node`.\n *\n * If `connection` is null or undefined, will return an empty array instead in production. In development, an error will be thrown.\n */\nexport function flattenConnection<\n  ConnectionGeneric extends\n    | PartialDeep<ConnectionEdges, {recurseIntoArrays: true}>\n    | PartialDeep<ConnectionNodes, {recurseIntoArrays: true}>\n    | ConnectionEdges\n    | ConnectionNodes\n>(\n  connection?: ConnectionGeneric\n): ConnectionGeneric extends\n  | {\n      edges: {node: Array<infer ConnectionBaseType>};\n    }\n  | {\n      nodes: Array<infer ConnectionBaseType>;\n    }\n  ? // if it's not a PartialDeep, then return the infered type\n    ConnectionBaseType[]\n  : ConnectionGeneric extends\n      | PartialDeep<\n          {edges: {node: Array<infer ConnectionBaseType>}},\n          {recurseIntoArrays: true}\n        >\n      | PartialDeep<\n          {\n            nodes: Array<infer ConnectionBaseType>;\n          },\n          {recurseIntoArrays: true}\n        >\n  ? // if it is a PartialDeep, return a PartialDeep inferred type\n    PartialDeep<ConnectionBaseType[], {recurseIntoArrays: true}>\n  : never {\n  if (!connection) {\n    const noConnectionErr = `flattenConnection(): needs a 'connection' to flatten, but received '${connection}' instead.`;\n    if (__HYDROGEN_DEV__) {\n      throw new Error(noConnectionErr);\n    } else {\n      console.error(noConnectionErr + ` Returning an empty array`);\n      // @ts-expect-error We don't want to crash prod, so return an empty array\n      return [];\n    }\n  }\n\n  if ('nodes' in connection) {\n    // @ts-expect-error return type is failing\n    return connection.nodes;\n  }\n\n  if ('edges' in connection && Array.isArray(connection.edges)) {\n    // @ts-expect-error return type is failing\n    return connection.edges.map((edge) => {\n      if (!edge?.node) {\n        throw new Error(\n          'flattenConnection(): Connection edges must contain nodes'\n        );\n      }\n      return edge.node;\n    });\n  }\n\n  if (__HYDROGEN_DEV__) {\n    console.warn(\n      `flattenConnection(): The connection did not contain either \"nodes\" or \"edges.node\". Returning an empty array.`\n    );\n  }\n\n  // @ts-expect-error We don't want to crash prod, so return an empty array\n  return [];\n}\n\ntype ConnectionEdges = {\n  edges: {node: Array<unknown>};\n};\n\ntype ConnectionNodes = {\n  nodes: Array<unknown>;\n};\n","export const CartLineAdd = (cartFragment: string) => /* GraphQL */ `\n  mutation CartLineAdd(\n    $cartId: ID!\n    $lines: [CartLineInput!]!\n    $numCartLines: Int = 250\n    $country: CountryCode = ZZ\n  ) @inContext(country: $country) {\n    cartLinesAdd(cartId: $cartId, lines: $lines) {\n      cart {\n        ...CartFragment\n      }\n    }\n  }\n\n  ${cartFragment}\n`;\n\nexport const CartCreate = (cartFragment: string) => /* GraphQL */ `\n  mutation CartCreate(\n    $input: CartInput!\n    $numCartLines: Int = 250\n    $country: CountryCode = ZZ\n  ) @inContext(country: $country) {\n    cartCreate(input: $input) {\n      cart {\n        ...CartFragment\n      }\n    }\n  }\n\n  ${cartFragment}\n`;\n\nexport const CartLineRemove = (cartFragment: string) => /* GraphQL */ `\n  mutation CartLineRemove(\n    $cartId: ID!\n    $lines: [ID!]!\n    $numCartLines: Int = 250\n    $country: CountryCode = ZZ\n  ) @inContext(country: $country) {\n    cartLinesRemove(cartId: $cartId, lineIds: $lines) {\n      cart {\n        ...CartFragment\n      }\n    }\n  }\n\n  ${cartFragment}\n`;\n\nexport const CartLineUpdate = (cartFragment: string) => /* GraphQL */ `\n  mutation CartLineUpdate(\n    $cartId: ID!\n    $lines: [CartLineUpdateInput!]!\n    $numCartLines: Int = 250\n    $country: CountryCode = ZZ\n  ) @inContext(country: $country) {\n    cartLinesUpdate(cartId: $cartId, lines: $lines) {\n      cart {\n        ...CartFragment\n      }\n    }\n  }\n\n  ${cartFragment}\n`;\n\nexport const CartNoteUpdate = (cartFragment: string) => /* GraphQL */ `\n  mutation CartNoteUpdate(\n    $cartId: ID!\n    $note: String\n    $numCartLines: Int = 250\n    $country: CountryCode = ZZ\n  ) @inContext(country: $country) {\n    cartNoteUpdate(cartId: $cartId, note: $note) {\n      cart {\n        ...CartFragment\n      }\n    }\n  }\n\n  ${cartFragment}\n`;\n\nexport const CartBuyerIdentityUpdate = (cartFragment: string) => /* GraphQL */ `\n  mutation CartBuyerIdentityUpdate(\n    $cartId: ID!\n    $buyerIdentity: CartBuyerIdentityInput!\n    $numCartLines: Int = 250\n    $country: CountryCode = ZZ\n  ) @inContext(country: $country) {\n    cartBuyerIdentityUpdate(cartId: $cartId, buyerIdentity: $buyerIdentity) {\n      cart {\n        ...CartFragment\n      }\n    }\n  }\n\n  ${cartFragment}\n`;\n\nexport const CartAttributesUpdate = (cartFragment: string) => /* GraphQL */ `\n  mutation CartAttributesUpdate(\n    $attributes: [AttributeInput!]!\n    $cartId: ID!\n    $numCartLines: Int = 250\n    $country: CountryCode = ZZ\n  ) @inContext(country: $country) {\n    cartAttributesUpdate(attributes: $attributes, cartId: $cartId) {\n      cart {\n        ...CartFragment\n      }\n    }\n  }\n\n  ${cartFragment}\n`;\n\nexport const CartDiscountCodesUpdate = (cartFragment: string) => /* GraphQL */ `\n  mutation CartDiscountCodesUpdate(\n    $cartId: ID!\n    $discountCodes: [String!]\n    $numCartLines: Int = 250\n    $country: CountryCode = ZZ\n  ) @inContext(country: $country) {\n    cartDiscountCodesUpdate(cartId: $cartId, discountCodes: $discountCodes) {\n      cart {\n        ...CartFragment\n      }\n    }\n  }\n\n  ${cartFragment}\n`;\n\nexport const CartQuery = (cartFragment: string) => /* GraphQL */ `\n  query CartQuery(\n    $id: ID!\n    $numCartLines: Int = 250\n    $country: CountryCode = ZZ\n  ) @inContext(country: $country) {\n    cart(id: $id) {\n      ...CartFragment\n    }\n  }\n\n  ${cartFragment}\n`;\n\nexport const defaultCartFragment = /* GraphQL */ `\n  fragment CartFragment on Cart {\n    id\n    checkoutUrl\n    totalQuantity\n    buyerIdentity {\n      countryCode\n      customer {\n        id\n        email\n        firstName\n        lastName\n        displayName\n      }\n      email\n      phone\n    }\n    lines(first: $numCartLines) {\n      edges {\n        node {\n          id\n          quantity\n          attributes {\n            key\n            value\n          }\n          cost {\n            totalAmount {\n              amount\n              currencyCode\n            }\n            compareAtAmountPerQuantity {\n              amount\n              currencyCode\n            }\n          }\n          merchandise {\n            ... on ProductVariant {\n              id\n              availableForSale\n              compareAtPrice {\n                ...MoneyFragment\n              }\n              price {\n                ...MoneyFragment\n              }\n              requiresShipping\n              title\n              image {\n                ...ImageFragment\n              }\n              product {\n                handle\n                title\n                id\n              }\n              selectedOptions {\n                name\n                value\n              }\n            }\n          }\n        }\n      }\n    }\n    cost {\n      subtotalAmount {\n        ...MoneyFragment\n      }\n      totalAmount {\n        ...MoneyFragment\n      }\n      totalDutyAmount {\n        ...MoneyFragment\n      }\n      totalTaxAmount {\n        ...MoneyFragment\n      }\n    }\n    note\n    attributes {\n      key\n      value\n    }\n    discountCodes {\n      code\n    }\n  }\n\n  fragment MoneyFragment on MoneyV2 {\n    currencyCode\n    amount\n  }\n  fragment ImageFragment on Image {\n    id\n    url\n    altText\n    width\n    height\n  }\n`;\n","export const SFAPI_VERSION = '2023-01';\n","import {SFAPI_VERSION} from './storefront-api-constants.js';\n\nconst warnings = new Set<string>();\nconst warnOnce = (string: string) => {\n  if (!warnings.has(string)) {\n    console.warn(string);\n    warnings.add(string);\n  }\n};\n\n/**\n * The `createStorefrontClient()` function creates helpers that enable you to quickly query the Shopify Storefront API.\n *\n * When used on the server, it is recommended to use the `privateStorefrontToken` prop. When used on the client, it is recommended to use the `publicStorefrontToken` prop.\n */\nexport function createStorefrontClient({\n  storeDomain,\n  privateStorefrontToken,\n  publicStorefrontToken,\n  storefrontApiVersion,\n  contentType,\n}: StorefrontClientProps): StorefrontClientReturn {\n  if (storefrontApiVersion !== SFAPI_VERSION) {\n    warnOnce(\n      `StorefrontClient: The Storefront API version that you're using is different than the version this build of React Storefront Kit is targeting. You may run into unexpected errors if these versions don't match. Received verion: \"${storefrontApiVersion}\"; expected version \"${SFAPI_VERSION}\"`\n    );\n  }\n\n  // only warn if not in a browser environment\n  if (__HYDROGEN_DEV__ && !privateStorefrontToken && !globalThis.document) {\n    warnOnce(\n      `StorefrontClient: Using a private storefront token is recommended for server environments. Refer to the authentication https://shopify.dev/api/storefront#authentication documentation for more details.`\n    );\n  }\n\n  // only warn if in a browser environment and you're using the privateStorefrontToken\n  if (__HYDROGEN_DEV__ && privateStorefrontToken && globalThis) {\n    warnOnce(\n      `StorefrontClient: You are attempting to use a private token in an environment where it can be easily accessed by anyone. This is a security risk; please use the public token and the 'publicStorefrontToken' prop`\n    );\n  }\n\n  return {\n    getShopifyDomain(overrideProps) {\n      return overrideProps?.storeDomain ?? storeDomain;\n    },\n    getStorefrontApiUrl(overrideProps) {\n      const finalDomainUrl = overrideProps?.storeDomain ?? storeDomain;\n      return `${finalDomainUrl}${finalDomainUrl.endsWith('/') ? '' : '/'}api/${\n        overrideProps?.storefrontApiVersion ?? storefrontApiVersion\n      }/graphql.json`;\n    },\n    getPrivateTokenHeaders(overrideProps) {\n      if (!privateStorefrontToken && !overrideProps?.privateStorefrontToken) {\n        throw new Error(\n          `StorefrontClient: You did not pass in a 'privateStorefrontToken' while using 'getPrivateTokenHeaders()'`\n        );\n      }\n\n      if (__HYDROGEN_DEV__ && !overrideProps?.buyerIp) {\n        warnOnce(\n          `StorefrontClient: it is recommended to pass in the 'buyerIp' property which improves analytics and data in the admin.`\n        );\n      }\n\n      const finalContentType = overrideProps?.contentType ?? contentType;\n\n      return {\n        // default to json\n        'content-type':\n          finalContentType === 'graphql'\n            ? 'application/graphql'\n            : 'application/json',\n        'X-SDK-Variant': 'storefront-kit',\n        'X-SDK-Variant-Source': 'react',\n        'X-SDK-Version': storefrontApiVersion,\n        'Shopify-Storefront-Private-Token':\n          overrideProps?.privateStorefrontToken ?? privateStorefrontToken ?? '',\n        ...(overrideProps?.buyerIp\n          ? {'Shopify-Storefront-Buyer-IP': overrideProps.buyerIp}\n          : {}),\n      };\n    },\n    getPublicTokenHeaders(overrideProps) {\n      if (!publicStorefrontToken && !overrideProps?.publicStorefrontToken) {\n        throw new Error(\n          `StorefrontClient: You did not pass in a 'publicStorefrontToken' while using 'getPublicTokenHeaders()'`\n        );\n      }\n\n      const finalContentType =\n        overrideProps?.contentType ?? contentType ?? 'json';\n\n      return getPublicTokenHeadersRaw(\n        finalContentType,\n        storefrontApiVersion,\n        overrideProps?.publicStorefrontToken ?? publicStorefrontToken ?? ''\n      );\n    },\n  };\n}\n\nexport function getPublicTokenHeadersRaw(\n  contentType: 'graphql' | 'json',\n  storefrontApiVersion: string,\n  accessToken: string\n) {\n  return {\n    // default to json\n    'content-type':\n      contentType === 'graphql' ? 'application/graphql' : 'application/json',\n    'X-SDK-Variant': 'storefront-kit',\n    'X-SDK-Variant-Source': 'react',\n    'X-SDK-Version': storefrontApiVersion,\n    'X-Shopify-Storefront-Access-Token': accessToken,\n  };\n}\n\ntype StorefrontClientProps = {\n  /** The host name of the domain (eg: `{shop}.myshopify.com`). */\n  storeDomain: string;\n  /** The Storefront API delegate access token. Refer to the [authentication](https://shopify.dev/api/storefront#authentication) and [delegate access token](https://shopify.dev/apps/auth/oauth/delegate-access-tokens) documentation for more details. */\n  privateStorefrontToken?: string;\n  /** The Storefront API access token. Refer to the [authentication](https://shopify.dev/api/storefront#authentication) documentation for more details. */\n  publicStorefrontToken?: string;\n  /** The Storefront API version. This should almost always be the same as the version Storefront Kit was built for. Learn more about Shopify [API versioning](https://shopify.dev/api/usage/versioning) for more details.  */\n  storefrontApiVersion: string;\n  /**\n   * Customizes which `\"content-type\"` header is added when using `getPrivateTokenHeaders()` and `getPublicTokenHeaders()`. When fetching with a `JSON.stringify()`-ed `body`, use `\"json\"`. When fetching with a `body` that is a plain string, use `\"graphql\"`. Defaults to `\"json\"`\n   *\n   * Can also be customized on a call-by-call basis by passing in `'contentType'` to both `getPrivateTokenHeaders({...})` and `getPublicTokenHeaders({...})`, for example: `getPublicTokenHeaders({contentType: 'graphql'})`\n   */\n  contentType?: 'json' | 'graphql';\n};\n\ntype OverrideTokenHeaderProps = Partial<\n  Pick<StorefrontClientProps, 'contentType'>\n>;\n\ntype StorefrontClientReturn = {\n  /**\n   * Creates the fully-qualified URL to your myshopify.com domain.\n   *\n   * By default, it will use the config you passed in when calling `createStorefrontClient()`. However, you can override the following settings on each invocation of `getShopifyDomain({...})`:\n   *\n   * - `storeDomain`\n   */\n  getShopifyDomain: (\n    props?: Partial<Pick<StorefrontClientProps, 'storeDomain'>>\n  ) => string;\n  /**\n   * Creates the fully-qualified URL to your store's GraphQL endpoint.\n   *\n   * By default, it will use the config you passed in when calling `createStorefrontClient()`. However, you can override the following settings on each invocation of `getStorefrontApiUrl({...})`:\n   *\n   * - `storeDomain`\n   * - `storefrontApiVersion`\n   */\n  getStorefrontApiUrl: (\n    props?: Partial<\n      Pick<StorefrontClientProps, 'storeDomain' | 'storefrontApiVersion'>\n    >\n  ) => string;\n  /**\n   * Returns an object that contains headers that are needed for each query to Storefront API GraphQL endpoint. This method uses the private Server-to-Server token which reduces the chance of throttling but must not be exposed to clients. Server-side calls should prefer using this over `getPublicTokenHeaders()`.\n   *\n   * By default, it will use the config you passed in when calling `createStorefrontClient()`. However, you can override the following settings on each invocation of `getPrivateTokenHeaders({...})`:\n   *\n   * - `contentType`\n   * - `privateStorefrontToken`\n   * - `buyerIp`\n   *\n   * Note that `contentType` defaults to what you configured in `createStorefrontClient({...})` and defaults to `'json'`, but a specific call may require using `graphql`. When using `JSON.stringify()` on the `body`, use `'json'`; otherwise, use `'graphql'`.\n   */\n  getPrivateTokenHeaders: (\n    props?: OverrideTokenHeaderProps &\n      Pick<StorefrontClientProps, 'privateStorefrontToken'> & {\n        /**\n         * The client's IP address. Passing this to the Storefront API when using a server-to-server token will help improve your store's analytics data.\n         */\n        buyerIp?: string;\n      }\n  ) => Record<string, string>;\n  /**\n   * Returns an object that contains headers that are needed for each query to Storefront API GraphQL endpoint. This method uses the public token which increases the chance of throttling but also can be exposed to clients. Server-side calls should prefer using `getPublicTokenHeaders()`.\n   *\n   * By default, it will use the config you passed in when calling `createStorefrontClient()`. However, you can override the following settings on each invocation of `getPublicTokenHeaders({...})`:\n   *\n   * - `contentType`\n   * - `publicStorefrontToken`\n   *\n   * Note that `contentType` defaults to what you configured in `createStorefrontClient({...})` and defaults to `'json'`, but a specific call may require using `graphql`. When using `JSON.stringify()` on the `body`, use `'json'`; otherwise, use `'graphql'`.\n   */\n  getPublicTokenHeaders: (\n    props?: OverrideTokenHeaderProps &\n      Pick<StorefrontClientProps, 'publicStorefrontToken'>\n  ) => Record<string, string>;\n};\n","import {createContext, useContext, useMemo, type ReactNode} from 'react';\nimport type {LanguageCode, CountryCode} from './storefront-api-types.js';\nimport {SFAPI_VERSION} from './storefront-api-constants.js';\nimport {getPublicTokenHeadersRaw} from './storefront-client.js';\n\nconst ShopifyContext = createContext<ShopifyContextValue>({\n  storeDomain: 'test',\n  storefrontToken: 'abc123',\n  storefrontApiVersion: SFAPI_VERSION,\n  country: {\n    isoCode: 'US',\n  },\n  language: {\n    isoCode: 'EN',\n  },\n  locale: 'EN-US',\n  getStorefrontApiUrl() {\n    return '';\n  },\n  getPublicTokenHeaders() {\n    return {};\n  },\n  getShopifyDomain() {\n    return '';\n  },\n});\n\ntype ShopifyProviderProps = {\n  children: ReactNode;\n  shopifyConfig: ShopifyContextProps;\n};\n\n/**\n * The `<ShopifyProvider/>` component enables use of the `useShop()` hook. The component should wrap your app.\n */\nexport function ShopifyProvider({\n  children,\n  shopifyConfig,\n}: ShopifyProviderProps) {\n  if (!shopifyConfig) {\n    throw new Error(\n      `The 'shopifyConfig' prop must be passed to '<ShopifyProvider/>'`\n    );\n  }\n\n  if (shopifyConfig.storefrontApiVersion !== SFAPI_VERSION) {\n    console.warn(\n      `<ShopifyProvider/>: This version of React Storefront Kit is built for Shopify's Storefront API version ${SFAPI_VERSION}, but it looks like you're using version ${shopifyConfig.storefrontApiVersion}. There may be issues or bugs if you use a mismatched version of React Storefront Kit and the Storefront API.`\n    );\n  }\n\n  const finalConfig = useMemo<ShopifyContextValue>(() => {\n    function getShopifyDomain(overrideProps?: {storeDomain?: string}) {\n      return overrideProps?.storeDomain ?? shopifyConfig.storeDomain;\n    }\n\n    return {\n      ...shopifyConfig,\n      getPublicTokenHeaders(overrideProps) {\n        return getPublicTokenHeadersRaw(\n          overrideProps.contentType,\n          shopifyConfig.storefrontApiVersion,\n          overrideProps.storefrontToken ?? shopifyConfig.storefrontToken\n        );\n      },\n      getShopifyDomain,\n      getStorefrontApiUrl(overrideProps) {\n        const finalDomainUrl = getShopifyDomain({\n          storeDomain: overrideProps?.storeDomain ?? shopifyConfig.storeDomain,\n        });\n        return `${finalDomainUrl}${\n          finalDomainUrl.endsWith('/') ? '' : '/'\n        }api/${\n          overrideProps?.storefrontApiVersion ??\n          shopifyConfig.storefrontApiVersion\n        }/graphql.json`;\n      },\n    };\n  }, [shopifyConfig]);\n\n  return (\n    <ShopifyContext.Provider value={finalConfig}>\n      {children}\n    </ShopifyContext.Provider>\n  );\n}\n\n/**\n * Provides access to the `shopifyConfig` prop of `<ShopifyProvider/>`. Must be a descendent of `<ShopifyProvider/>`.\n */\nexport function useShop() {\n  const shopContext = useContext(ShopifyContext);\n  if (!shopContext) {\n    throw new Error(`'useShop()' must be a descendent of <ShopifyProvider/>`);\n  }\n  return shopContext;\n}\n\n/**\n * Shopify-specific values that are used in various React Storefront Kit components and hooks.\n */\nexport type ShopifyContextProps = {\n  /** The globally-unique identifier for the Shop */\n  storefrontId?: string;\n  /** The full domain of your Shopify storefront URL (eg: the complete string of `{subdomain}.myshopify.com`). */\n  storeDomain: string;\n  /** The Storefront API public access token. Refer to the [authentication](https://shopify.dev/api/storefront#authentication) documentation for more details. */\n  storefrontToken: string;\n  /** The Storefront API version. This should almost always be the same as the version React Storefront Kit was built for. Learn more about Shopify [API versioning](https://shopify.dev/api/usage/versioning) for more details.  */\n  storefrontApiVersion: string;\n  country?: ContextCountry;\n  language?: ContextLanguage;\n  /**\n   * The locale string based on `country` and `language`.\n   */\n  locale?: string;\n};\n\ntype ContextCountry = {\n  /**\n   * The code designating a country, which generally follows ISO 3166-1 alpha-2 guidelines. If a territory doesn't have a country code value in the `CountryCode` enum, it might be considered a subdivision of another country. For example, the territories associated with Spain are represented by the country code `ES`, and the territories associated with the United States of America are represented by the country code `US`.\n   */\n  isoCode: CountryCode;\n};\n\ntype ContextLanguage = {\n  /**\n   * `ISO 369` language codes supported by Shopify.\n   */\n  isoCode: LanguageCode;\n};\n\nexport type ShopifyContextValue = ShopifyContextProps & ShopifyContextReturn;\n\ntype ShopifyContextReturn = {\n  /**\n   * Creates the fully-qualified URL to your store's GraphQL endpoint.\n   *\n   * By default, it will use the config you passed in when creating `<ShopifyProvider/>`. However, you can override the following settings on each invocation of `getStorefrontApiUrl({...})`:\n   *\n   * - `storeDomain`\n   * - `storefrontApiVersion`\n   */\n  getStorefrontApiUrl: (props?: GetStorefrontApiUrlProps) => string;\n  /**\n   * Returns an object that contains headers that are needed for each query to Storefront API GraphQL endpoint. This uses the public Storefront API token.\n   *\n   * By default, it will use the config you passed in when creating `<ShopifyProvider/>`. However, you can override the following settings on each invocation of `getPublicTokenHeaders({...})`:\n   *\n   * - `contentType`\n   * - `storefrontToken`\n   *\n   */\n  getPublicTokenHeaders: (\n    props: GetPublicTokenHeadersProps\n  ) => Record<string, string>;\n  /**\n   * Creates the fully-qualified URL to your myshopify.com domain.\n   *\n   * By default, it will use the config you passed in when calling `<ShopifyProvider/>`. However, you can override the following settings on each invocation of `getShopifyDomain({...})`:\n   *\n   * - `storeDomain`\n   */\n  getShopifyDomain: (props?: GetShopifyDomainProps) => string;\n};\n\ntype GetStorefrontApiUrlProps = {\n  /** The host name of the domain (eg: `{shop}.myshopify.com`). */\n  storeDomain?: string;\n  /** The Storefront API version. This should almost always be the same as the version Hydrogen-UI was built for. Learn more about Shopify [API versioning](https://shopify.dev/api/usage/versioning) for more details. */\n  storefrontApiVersion?: string;\n};\n\ntype GetPublicTokenHeadersProps = {\n  /**\n   * Customizes which `\"content-type\"` header is added when using `getPrivateTokenHeaders()` and `getPublicTokenHeaders()`. When fetching with a `JSON.stringify()`-ed `body`, use `\"json\"`. When fetching with a `body` that is a plain string, use `\"graphql\"`. Defaults to `\"json\"`\n   */\n  contentType: 'json' | 'graphql';\n  /** The Storefront API access token. Refer to the [authentication](https://shopify.dev/api/storefront#authentication) documentation for more details. */\n  storefrontToken?: string;\n};\n\ntype GetShopifyDomainProps = {storeDomain?: string};\n","export const CART_ID_STORAGE_KEY = 'shopifyCartId';\nexport const CART_COOKIE_TTL_DAYS = 14;\n\n// Needed for cart analytics within Shopify\nexport const SHOPIFY_STOREFRONT_ID_HEADER = 'Shopify-Storefront-Id';\nexport const SHOPIFY_STOREFRONT_Y_HEADER = 'Shopify-Storefront-Y';\nexport const SHOPIFY_STOREFRONT_S_HEADER = 'Shopify-Storefront-S';\nexport const SHOPIFY_Y = '_shopify_y';\nexport const SHOPIFY_S = '_shopify_s';\n","// src/cookie.ts\nvar g = new Set([\n  \"domain\",\n  \"path\",\n  \"max-age\",\n  \"expires\",\n  \"samesite\",\n  \"secure\",\n  \"httponly\"\n]);\nfunction u(a) {\n  let r = {}, e, t, n = 0, m = a.split(/;\\s*/g), s, i;\n  for (; n < m.length; n++)\n    if (t = m[n], e = t.indexOf(\"=\"), ~e) {\n      if (s = t.substring(0, e++).trim(), i = t.substring(e).trim(), i[0] === '\"' && (i = i.substring(1, i.length - 1)), ~i.indexOf(\"%\"))\n        try {\n          i = decodeURIComponent(i);\n        } catch (f) {\n        }\n      g.has(t = s.toLowerCase()) ? t === \"expires\" ? r.expires = new Date(i) : t === \"max-age\" ? r.maxage = +i : r[t] = i : r[s] = i;\n    } else\n      (s = t.trim().toLowerCase()) && (s === \"httponly\" || s === \"secure\") && (r[s] = !0);\n  return r;\n}\nfunction l(a, r, e = {}) {\n  let t = a + \"=\" + encodeURIComponent(r);\n  return e.expires && (t += \"; Expires=\" + new Date(e.expires).toUTCString()), e.maxage != null && e.maxage >= 0 && (t += \"; Max-Age=\" + (e.maxage | 0)), e.domain && (t += \"; Domain=\" + e.domain), e.path && (t += \"; Path=\" + e.path), e.samesite && (t += \"; SameSite=\" + e.samesite), (e.secure || e.samesite === \"None\") && (t += \"; Secure\"), e.httponly && (t += \"; HttpOnly\"), t;\n}\nexport {\n  u as parse,\n  l as stringify\n};\n","import {parse} from 'worktop/cookie';\nimport {ShopifyCookies} from './analytics-types.js';\nimport {SHOPIFY_Y, SHOPIFY_S} from './cart-constants.js';\n\nconst tokenHash = 'xxxx-4xxx-xxxx-xxxxxxxxxxxx';\n\nexport function buildUUID(): string {\n  let hash = '';\n\n  try {\n    const crypto: Crypto = window.crypto;\n    const randomValuesArray = new Uint16Array(31);\n    crypto.getRandomValues(randomValuesArray);\n\n    // Generate a strong UUID\n    let i = 0;\n    hash = tokenHash\n      .replace(/[x]/g, (c: string): string => {\n        const r = randomValuesArray[i] % 16;\n        const v = c === 'x' ? r : (r & 0x3) | 0x8;\n        i++;\n        return v.toString(16);\n      })\n      .toUpperCase();\n  } catch (err) {\n    // crypto not available, generate weak UUID\n    hash = tokenHash\n      .replace(/[x]/g, (c: string): string => {\n        const r = (Math.random() * 16) | 0;\n        const v = c === 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n      })\n      .toUpperCase();\n  }\n\n  return `${hexTime()}-${hash}`;\n}\n\nexport function hexTime(): string {\n  // 32 bit representations of new Date().getTime() and performance.now()\n  let dateNumber = 0;\n  let perfNumber = 0;\n\n  // Result of zero-fill right shift is always positive\n  dateNumber = new Date().getTime() >>> 0;\n\n  try {\n    perfNumber = performance.now() >>> 0;\n  } catch (err) {\n    perfNumber = 0;\n  }\n\n  const output = Math.abs(dateNumber + perfNumber)\n    .toString(16)\n    .toLowerCase();\n\n  return output.padStart(8 - output.length, '0');\n}\n\n/**\n * Returns Shopify cookies\n * @returns Empty string if cookie not found\n *\n * @example\n * ```tsx\n *   getShopifyCookies(document.cookie);\n * ```\n **/\nexport function getShopifyCookies(cookies: string): ShopifyCookies {\n  const cookieData = parse(cookies);\n  return {\n    [SHOPIFY_Y]: cookieData[SHOPIFY_Y] || '',\n    [SHOPIFY_S]: cookieData[SHOPIFY_S] || '',\n  };\n}\n","import {useState, useCallback} from 'react';\nimport {useShop} from './ShopifyProvider.js';\nimport {flattenConnection} from './flatten-connection.js';\nimport {CartInput, Cart as CartType} from './storefront-api-types.js';\nimport {CartCreate, defaultCartFragment} from './cart-queries.js';\nimport {Cart} from './cart-types.js';\nimport {\n  SHOPIFY_STOREFRONT_ID_HEADER,\n  SHOPIFY_STOREFRONT_Y_HEADER,\n  SHOPIFY_STOREFRONT_S_HEADER,\n  SHOPIFY_Y,\n  SHOPIFY_S,\n} from './cart-constants.js';\nimport type {StorefrontApiResponseOkPartial} from './storefront-api-response.types.js';\nimport {getShopifyCookies} from './cookies-utils.js';\n\nexport function useCartFetch() {\n  const {storefrontId, getPublicTokenHeaders, getStorefrontApiUrl} = useShop();\n\n  return useCallback(\n    <ReturnDataGeneric,>({\n      query,\n      variables,\n    }: {\n      query: string;\n      variables: Record<string, unknown>;\n    }): Promise<StorefrontApiResponseOkPartial<ReturnDataGeneric>> => {\n      const headers = getPublicTokenHeaders({contentType: 'json'});\n\n      if (storefrontId) {\n        headers[SHOPIFY_STOREFRONT_ID_HEADER] = storefrontId;\n      }\n\n      // Find Shopify cookies\n      const cookieData = getShopifyCookies(document.cookie);\n      headers[SHOPIFY_STOREFRONT_Y_HEADER] = cookieData[SHOPIFY_Y];\n      headers[SHOPIFY_STOREFRONT_S_HEADER] = cookieData[SHOPIFY_S];\n\n      return fetch(getStorefrontApiUrl(), {\n        method: 'POST',\n        headers,\n        body: JSON.stringify({\n          query: query.toString(),\n          variables,\n        }),\n      })\n        .then((res) => res.json())\n        .catch((error) => {\n          return {\n            data: undefined,\n            errors: error.toString(),\n          };\n        });\n    },\n    [getPublicTokenHeaders, storefrontId, getStorefrontApiUrl]\n  );\n}\n\nexport function useInstantCheckout() {\n  const [cart, updateCart] = useState<Cart | undefined>();\n  const [checkoutUrl, updateCheckoutUrl] = useState<Cart['checkoutUrl']>();\n  const [error, updateError] = useState<string | undefined>();\n\n  const fetch = useCartFetch();\n\n  const createInstantCheckout = useCallback(\n    async (cartInput: CartInput) => {\n      const {data, errors} = await fetch<{\n        cartCreate: {cart: CartType};\n      }>({\n        query: CartCreate(defaultCartFragment),\n        variables: {\n          input: cartInput,\n        },\n      });\n\n      if (errors) {\n        updateError(errors.toString());\n        updateCart(undefined);\n        updateCheckoutUrl(undefined);\n      }\n\n      if (data?.cartCreate?.cart) {\n        const dataCart = data.cartCreate.cart;\n        updateCart({\n          ...dataCart,\n          lines: flattenConnection(dataCart.lines),\n          note: dataCart.note ?? undefined,\n        });\n        updateCheckoutUrl(dataCart.checkoutUrl);\n      }\n    },\n    [fetch]\n  );\n\n  return {cart, checkoutUrl, error, createInstantCheckout};\n}\n","import {useCallback, useMemo} from 'react';\nimport {\n  AttributeInput,\n  CartBuyerIdentityInput,\n  CartInput,\n  CartLineInput,\n  CartLineUpdateInput,\n  CountryCode,\n  Cart as CartType,\n  MutationCartDiscountCodesUpdateArgs,\n  MutationCartNoteUpdateArgs,\n} from './storefront-api-types.js';\nimport {\n  CartAttributesUpdate,\n  CartBuyerIdentityUpdate,\n  CartCreate,\n  CartDiscountCodesUpdate,\n  CartLineAdd,\n  CartLineRemove,\n  CartLineUpdate,\n  CartNoteUpdate,\n  CartQuery,\n} from './cart-queries.js';\nimport {useCartFetch} from './cart-hooks.js';\nimport {PartialDeep} from 'type-fest';\n\ntype CartResponse = PartialDeep<CartType, {recurseIntoArrays: true}>;\n\n/**\n * The `useCartActions` hook returns helper graphql functions for Storefront Cart API\n *\n * See [cart API graphql mutations](https://shopify.dev/api/storefront/2023-01/objects/Cart)\n */\nexport function useCartActions({\n  numCartLines,\n  cartFragment,\n  countryCode = 'US',\n}: {\n  /**  Maximum number of cart lines to fetch. Defaults to 250 cart lines. */\n  numCartLines?: number;\n  /** A fragment used to query the Storefront API's [Cart object](https://shopify.dev/api/storefront/latest/objects/cart) for all queries and mutations. A default value is used if no argument is provided. */\n  cartFragment: string;\n  /** The ISO country code for i18n. */\n  countryCode?: CountryCode;\n}) {\n  const fetchCart = useCartFetch();\n\n  const cartFetch = useCallback(\n    (cartId: string) => {\n      return fetchCart<{cart: CartResponse}>({\n        query: CartQuery(cartFragment),\n        variables: {\n          id: cartId,\n          numCartLines,\n          country: countryCode,\n        },\n      });\n    },\n    [fetchCart, cartFragment, numCartLines, countryCode]\n  );\n\n  const cartCreate = useCallback(\n    (cart: CartInput) => {\n      return fetchCart<{cartCreate: {cart: CartResponse}}>({\n        query: CartCreate(cartFragment),\n        variables: {\n          input: cart,\n          numCartLines,\n          country: countryCode,\n        },\n      });\n    },\n    [cartFragment, countryCode, fetchCart, numCartLines]\n  );\n\n  const cartLineAdd = useCallback(\n    (cartId: string, lines: CartLineInput[]) => {\n      return fetchCart<{cartLinesAdd: {cart: CartResponse}}>({\n        query: CartLineAdd(cartFragment),\n        variables: {\n          cartId,\n          lines,\n          numCartLines,\n          country: countryCode,\n        },\n      });\n    },\n    [cartFragment, countryCode, fetchCart, numCartLines]\n  );\n\n  const cartLineUpdate = useCallback(\n    (cartId: string, lines: CartLineUpdateInput[]) => {\n      return fetchCart<{cartLinesUpdate: {cart: CartResponse}}>({\n        query: CartLineUpdate(cartFragment),\n        variables: {\n          cartId,\n          lines,\n          numCartLines,\n          country: countryCode,\n        },\n      });\n    },\n    [cartFragment, countryCode, fetchCart, numCartLines]\n  );\n\n  const cartLineRemove = useCallback(\n    (cartId: string, lines: string[]) => {\n      return fetchCart<{cartLinesRemove: {cart: CartResponse}}>({\n        query: CartLineRemove(cartFragment),\n        variables: {\n          cartId,\n          lines,\n          numCartLines,\n          country: countryCode,\n        },\n      });\n    },\n    [cartFragment, countryCode, fetchCart, numCartLines]\n  );\n\n  const noteUpdate = useCallback(\n    (cartId: string, note: MutationCartNoteUpdateArgs['note']) => {\n      return fetchCart<{cartNoteUpdate: {cart: CartResponse}}>({\n        query: CartNoteUpdate(cartFragment),\n        variables: {\n          cartId,\n          note,\n          numCartLines,\n          country: countryCode,\n        },\n      });\n    },\n    [fetchCart, cartFragment, numCartLines, countryCode]\n  );\n\n  const buyerIdentityUpdate = useCallback(\n    (cartId: string, buyerIdentity: CartBuyerIdentityInput) => {\n      return fetchCart<{cartBuyerIdentityUpdate: {cart: CartResponse}}>({\n        query: CartBuyerIdentityUpdate(cartFragment),\n        variables: {\n          cartId,\n          buyerIdentity,\n          numCartLines,\n          country: countryCode,\n        },\n      });\n    },\n    [cartFragment, countryCode, fetchCart, numCartLines]\n  );\n\n  const cartAttributesUpdate = useCallback(\n    (cartId: string, attributes: AttributeInput[]) => {\n      return fetchCart<{cartAttributesUpdate: {cart: CartResponse}}>({\n        query: CartAttributesUpdate(cartFragment),\n        variables: {\n          cartId,\n          attributes,\n          numCartLines,\n          country: countryCode,\n        },\n      });\n    },\n    [cartFragment, countryCode, fetchCart, numCartLines]\n  );\n\n  const discountCodesUpdate = useCallback(\n    (\n      cartId: string,\n      discountCodes: MutationCartDiscountCodesUpdateArgs['discountCodes']\n    ) => {\n      return fetchCart<{cartDiscountCodesUpdate: {cart: CartResponse}}>({\n        query: CartDiscountCodesUpdate(cartFragment),\n        variables: {\n          cartId,\n          discountCodes,\n          numCartLines,\n          country: countryCode,\n        },\n      });\n    },\n    [cartFragment, countryCode, fetchCart, numCartLines]\n  );\n\n  return useMemo(\n    () => ({\n      cartFetch,\n      cartCreate,\n      cartLineAdd,\n      cartLineUpdate,\n      cartLineRemove,\n      noteUpdate,\n      buyerIdentityUpdate,\n      cartAttributesUpdate,\n      discountCodesUpdate,\n      cartFragment,\n    }),\n    [\n      cartFetch,\n      cartCreate,\n      cartLineAdd,\n      cartLineUpdate,\n      cartLineRemove,\n      noteUpdate,\n      buyerIdentityUpdate,\n      cartAttributesUpdate,\n      discountCodesUpdate,\n      cartFragment,\n    ]\n  );\n}\n","import {useMachine} from '@xstate/react/fsm';\nimport {createMachine, assign, StateMachine} from '@xstate/fsm';\nimport {\n  Cart,\n  CartMachineActionEvent,\n  CartMachineActions,\n  CartMachineContext,\n  CartMachineEvent,\n  CartMachineFetchResultEvent,\n  CartMachineTypeState,\n} from './cart-types.js';\nimport {flattenConnection} from './flatten-connection.js';\nimport {useCartActions} from './useCartActions.js';\nimport {useMemo} from 'react';\nimport {InitEvent} from '@xstate/fsm/lib/types.js';\nimport {CountryCode, Cart as CartType} from './storefront-api-types.js';\nimport type {PartialDeep} from 'type-fest';\n\nfunction invokeCart(\n  action: keyof CartMachineActions,\n  options?: {\n    entryActions?: [keyof CartMachineActions];\n    resolveTarget?: CartMachineTypeState['value'];\n    errorTarget?: CartMachineTypeState['value'];\n    exitActions?: [keyof CartMachineActions];\n  }\n): StateMachine.Config<CartMachineContext, CartMachineEvent>['states']['on'] {\n  return {\n    entry: [\n      ...(options?.entryActions || []),\n      assign({\n        lastValidCart: (context) => context?.cart,\n      }),\n      'onCartActionEntry',\n      'onCartActionOptimisticUI',\n      action,\n    ],\n    on: {\n      RESOLVE: {\n        target: options?.resolveTarget || 'idle',\n        actions: [\n          assign({\n            prevCart: (context) => context?.lastValidCart,\n            cart: (_, event) => event?.payload?.cart,\n            rawCartResult: (_, event) => event?.payload?.rawCartResult,\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            errors: (_) => undefined,\n          }),\n        ],\n      },\n      ERROR: {\n        target: options?.errorTarget || 'error',\n        actions: [\n          assign({\n            prevCart: (context) => context?.lastValidCart,\n            cart: (context) => context?.lastValidCart,\n            errors: (_, event) => event?.payload?.errors,\n          }),\n        ],\n      },\n      CART_COMPLETED: {\n        target: 'cartCompleted',\n        actions: assign({\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          prevCart: (_) => undefined,\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          cart: (_) => undefined,\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          lastValidCart: (_) => undefined,\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          rawCartResult: (_) => undefined,\n          // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          errors: (_) => undefined,\n        }),\n      },\n    },\n    exit: ['onCartActionComplete', ...(options?.exitActions || [])],\n  };\n}\n\nconst INITIALIZING_CART_EVENTS: StateMachine.Machine<\n  CartMachineContext,\n  CartMachineEvent,\n  CartMachineTypeState\n>['config']['states']['uninitialized']['on'] = {\n  CART_FETCH: {\n    target: 'cartFetching',\n  },\n  CART_CREATE: {\n    target: 'cartCreating',\n  },\n  CART_SET: {\n    target: 'idle',\n    actions: [\n      assign({\n        rawCartResult: (_, event) => event.payload.cart,\n        cart: (_, event) => cartFromGraphQL(event.payload.cart),\n      }),\n    ],\n  },\n};\n\nconst UPDATING_CART_EVENTS: StateMachine.Machine<\n  CartMachineContext,\n  CartMachineEvent,\n  CartMachineTypeState\n>['config']['states']['idle']['on'] = {\n  CARTLINE_ADD: {\n    target: 'cartLineAdding',\n  },\n  CARTLINE_UPDATE: {\n    target: 'cartLineUpdating',\n  },\n  CARTLINE_REMOVE: {\n    target: 'cartLineRemoving',\n  },\n  NOTE_UPDATE: {\n    target: 'noteUpdating',\n  },\n  BUYER_IDENTITY_UPDATE: {\n    target: 'buyerIdentityUpdating',\n  },\n  CART_ATTRIBUTES_UPDATE: {\n    target: 'cartAttributesUpdating',\n  },\n  DISCOUNT_CODES_UPDATE: {\n    target: 'discountCodesUpdating',\n  },\n};\n\nfunction createCartMachine(\n  initialCart?: PartialDeep<CartType, {recurseIntoArrays: true}>\n) {\n  return createMachine<\n    CartMachineContext,\n    CartMachineEvent,\n    CartMachineTypeState\n  >({\n    id: 'Cart',\n    initial: initialCart ? 'idle' : 'uninitialized',\n    context: {\n      cart: initialCart && cartFromGraphQL(initialCart),\n    },\n    states: {\n      uninitialized: {\n        on: INITIALIZING_CART_EVENTS,\n      },\n      cartCompleted: {\n        on: INITIALIZING_CART_EVENTS,\n      },\n      initializationError: {\n        on: INITIALIZING_CART_EVENTS,\n      },\n      idle: {\n        on: {...INITIALIZING_CART_EVENTS, ...UPDATING_CART_EVENTS},\n      },\n      error: {\n        on: {...INITIALIZING_CART_EVENTS, ...UPDATING_CART_EVENTS},\n      },\n      cartFetching: invokeCart('cartFetchAction', {\n        errorTarget: 'initializationError',\n      }),\n      cartCreating: invokeCart('cartCreateAction', {\n        errorTarget: 'initializationError',\n      }),\n      cartLineRemoving: invokeCart('cartLineRemoveAction'),\n      cartLineUpdating: invokeCart('cartLineUpdateAction'),\n      cartLineAdding: invokeCart('cartLineAddAction'),\n      noteUpdating: invokeCart('noteUpdateAction'),\n      buyerIdentityUpdating: invokeCart('buyerIdentityUpdateAction'),\n      cartAttributesUpdating: invokeCart('cartAttributesUpdateAction'),\n      discountCodesUpdating: invokeCart('discountCodesUpdateAction'),\n    },\n  });\n}\n\nexport function useCartAPIStateMachine({\n  numCartLines,\n  onCartActionEntry,\n  onCartActionOptimisticUI,\n  onCartActionComplete,\n  data: cart,\n  cartFragment,\n  countryCode,\n}: {\n  /**  Maximum number of cart lines to fetch. Defaults to 250 cart lines. */\n  numCartLines?: number;\n  /** A callback that is invoked just before a Cart API action executes. */\n  onCartActionEntry?: (\n    context: CartMachineContext,\n    event: CartMachineActionEvent\n  ) => void;\n  /** A callback that is invoked after executing the entry actions for optimistic UI changes.  */\n  onCartActionOptimisticUI?: (\n    context: CartMachineContext,\n    event: CartMachineEvent\n  ) => Partial<CartMachineContext>;\n  /** A callback that is invoked after a Cart API completes. */\n  onCartActionComplete?: (\n    context: CartMachineContext,\n    event: CartMachineFetchResultEvent\n  ) => void;\n  /** An object with fields that correspond to the Storefront API's [Cart object](https://shopify.dev/api/storefront/latest/objects/cart). */\n  data?: PartialDeep<CartType, {recurseIntoArrays: true}>;\n  /** A fragment used to query the Storefront API's [Cart object](https://shopify.dev/api/storefront/latest/objects/cart) for all queries and mutations. A default value is used if no argument is provided. */\n  cartFragment: string;\n  /** The ISO country code for i18n. */\n  countryCode?: CountryCode;\n}) {\n  const {\n    cartFetch,\n    cartCreate,\n    cartLineAdd,\n    cartLineUpdate,\n    cartLineRemove,\n    noteUpdate,\n    buyerIdentityUpdate,\n    cartAttributesUpdate,\n    discountCodesUpdate,\n  } = useCartActions({\n    numCartLines,\n    cartFragment,\n    countryCode,\n  });\n\n  const cartMachine = useMemo(() => createCartMachine(cart), [cart]);\n\n  const [state, send, service] = useMachine(cartMachine, {\n    actions: {\n      cartFetchAction: async (_, event): Promise<void> => {\n        if (event.type !== 'CART_FETCH') return;\n\n        const {data, errors} = await cartFetch(event?.payload?.cartId);\n        const resultEvent = eventFromFetchResult(event, data?.cart, errors);\n        send(resultEvent);\n      },\n      cartCreateAction: async (_, event): Promise<void> => {\n        if (event.type !== 'CART_CREATE') return;\n\n        const {data, errors} = await cartCreate(event?.payload);\n        const resultEvent = eventFromFetchResult(\n          event,\n          data?.cartCreate?.cart,\n          errors\n        );\n        send(resultEvent);\n      },\n      cartLineAddAction: async (context, event): Promise<void> => {\n        if (event.type !== 'CARTLINE_ADD' || !context?.cart?.id) return;\n\n        const {data, errors} = await cartLineAdd(\n          context.cart.id,\n          event.payload.lines\n        );\n\n        const resultEvent = eventFromFetchResult(\n          event,\n          data?.cartLinesAdd?.cart,\n          errors\n        );\n\n        send(resultEvent);\n      },\n      cartLineUpdateAction: async (context, event): Promise<void> => {\n        if (event.type !== 'CARTLINE_UPDATE' || !context?.cart?.id) return;\n        const {data, errors} = await cartLineUpdate(\n          context.cart.id,\n          event.payload.lines\n        );\n\n        const resultEvent = eventFromFetchResult(\n          event,\n          data?.cartLinesUpdate?.cart,\n          errors\n        );\n\n        send(resultEvent);\n      },\n      cartLineRemoveAction: async (context, event): Promise<void> => {\n        if (event.type !== 'CARTLINE_REMOVE' || !context?.cart?.id) return;\n        const {data, errors} = await cartLineRemove(\n          context.cart.id,\n          event.payload.lines\n        );\n\n        const resultEvent = eventFromFetchResult(\n          event,\n          data?.cartLinesRemove?.cart,\n          errors\n        );\n\n        send(resultEvent);\n      },\n      noteUpdateAction: async (context, event): Promise<void> => {\n        if (event.type !== 'NOTE_UPDATE' || !context?.cart?.id) return;\n        const {data, errors} = await noteUpdate(\n          context.cart.id,\n          event.payload.note\n        );\n\n        const resultEvent = eventFromFetchResult(\n          event,\n          data?.cartNoteUpdate?.cart,\n          errors\n        );\n\n        send(resultEvent);\n      },\n      buyerIdentityUpdateAction: async (context, event): Promise<void> => {\n        if (event.type !== 'BUYER_IDENTITY_UPDATE' || !context?.cart?.id)\n          return;\n        const {data, errors} = await buyerIdentityUpdate(\n          context.cart.id,\n          event.payload.buyerIdentity\n        );\n\n        const resultEvent = eventFromFetchResult(\n          event,\n          data?.cartBuyerIdentityUpdate?.cart,\n          errors\n        );\n\n        send(resultEvent);\n      },\n      cartAttributesUpdateAction: async (context, event): Promise<void> => {\n        if (event.type !== 'CART_ATTRIBUTES_UPDATE' || !context?.cart?.id)\n          return;\n        const {data, errors} = await cartAttributesUpdate(\n          context.cart.id,\n          event.payload.attributes\n        );\n\n        const resultEvent = eventFromFetchResult(\n          event,\n          data?.cartAttributesUpdate?.cart,\n          errors\n        );\n\n        send(resultEvent);\n      },\n      discountCodesUpdateAction: async (context, event): Promise<void> => {\n        if (event.type !== 'DISCOUNT_CODES_UPDATE' || !context?.cart?.id)\n          return;\n        const {data, errors} = await discountCodesUpdate(\n          context.cart.id,\n          event.payload.discountCodes\n        );\n        const resultEvent = eventFromFetchResult(\n          event,\n          data?.cartDiscountCodesUpdate?.cart,\n          errors\n        );\n\n        send(resultEvent);\n      },\n      ...(onCartActionEntry && {\n        onCartActionEntry: (context, event) => {\n          if (isCartActionEvent(event)) {\n            onCartActionEntry(context, event);\n          }\n        },\n      }),\n      ...(onCartActionOptimisticUI && {\n        onCartActionOptimisticUI: assign((context, event) => {\n          return onCartActionOptimisticUI(context, event);\n        }),\n      }),\n      ...(onCartActionComplete && {\n        onCartActionComplete: (context, event) => {\n          if (isCartFetchResultEvent(event)) {\n            onCartActionComplete(context, event);\n          }\n        },\n      }),\n    } as CartMachineActions,\n  });\n\n  return useMemo(() => [state, send, service] as const, [state, send, service]);\n}\n\nexport function cartFromGraphQL(\n  cart: PartialDeep<CartType, {recurseIntoArrays: true}>\n): Cart {\n  return {\n    ...cart,\n    lines: flattenConnection(cart?.lines),\n    note: cart.note ?? undefined,\n  };\n}\n\nfunction eventFromFetchResult(\n  cartActionEvent: CartMachineActionEvent,\n  cart?: PartialDeep<CartType, {recurseIntoArrays: true}> | null,\n  errors?: unknown\n): CartMachineFetchResultEvent {\n  if (errors) {\n    return {type: 'ERROR', payload: {errors, cartActionEvent}};\n  }\n\n  if (!cart) {\n    return {\n      type: 'CART_COMPLETED',\n      payload: {\n        cartActionEvent,\n      },\n    };\n  }\n\n  return {\n    type: 'RESOLVE',\n    payload: {\n      cart: cartFromGraphQL(cart),\n      rawCartResult: cart,\n      cartActionEvent,\n    },\n  };\n}\n\nfunction isCartActionEvent(\n  event: CartMachineEvent | InitEvent\n): event is CartMachineActionEvent {\n  return (\n    event.type === 'CART_CREATE' ||\n    event.type === 'CARTLINE_ADD' ||\n    event.type === 'CARTLINE_UPDATE' ||\n    event.type === 'CARTLINE_REMOVE' ||\n    event.type === 'NOTE_UPDATE' ||\n    event.type === 'BUYER_IDENTITY_UPDATE' ||\n    event.type === 'CART_ATTRIBUTES_UPDATE' ||\n    event.type === 'DISCOUNT_CODES_UPDATE'\n  );\n}\n\nfunction isCartFetchResultEvent(\n  event: CartMachineEvent | InitEvent\n): event is CartMachineFetchResultEvent {\n  return (\n    event.type === 'RESOLVE' ||\n    event.type === 'ERROR' ||\n    event.type === 'CART_COMPLETED'\n  );\n}\n","import {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  useTransition,\n  createContext,\n  useContext,\n} from 'react';\nimport {\n  AttributeInput,\n  CartBuyerIdentityInput,\n  CartInput,\n  CartLineInput,\n  CartLineUpdateInput,\n  CountryCode,\n  Cart as CartType,\n  MutationCartNoteUpdateArgs,\n} from './storefront-api-types.js';\nimport {\n  BuyerIdentityUpdateEvent,\n  CartMachineContext,\n  CartMachineEvent,\n  CartMachineTypeState,\n  CartWithActions,\n} from './cart-types.js';\nimport {useCartAPIStateMachine} from './useCartAPIStateMachine.js';\nimport {CART_ID_STORAGE_KEY} from './cart-constants.js';\nimport {PartialDeep} from 'type-fest';\nimport {defaultCartFragment} from './cart-queries.js';\n\nexport const CartContext = createContext<CartWithActions | null>(null);\n\n/**\n * The `useCart` hook provides access to the cart object. It must be a descendent of a `CartProvider` component.\n */\nexport function useCart() {\n  const context = useContext(CartContext);\n\n  if (!context) {\n    throw new Error('Expected a Cart Context, but no Cart Context was found');\n  }\n\n  return context;\n}\n\nexport function CartProvider({\n  children,\n  numCartLines,\n  onCreate,\n  onLineAdd,\n  onLineRemove,\n  onLineUpdate,\n  onNoteUpdate,\n  onBuyerIdentityUpdate,\n  onAttributesUpdate,\n  onDiscountCodesUpdate,\n  onCreateComplete,\n  onLineAddComplete,\n  onLineRemoveComplete,\n  onLineUpdateComplete,\n  onNoteUpdateComplete,\n  onBuyerIdentityUpdateComplete,\n  onAttributesUpdateComplete,\n  onDiscountCodesUpdateComplete,\n  data: cart,\n  cartFragment = defaultCartFragment,\n  customerAccessToken,\n  countryCode = 'US',\n}: {\n  /** Any `ReactNode` elements. */\n  children: React.ReactNode;\n  /**  Maximum number of cart lines to fetch. Defaults to 250 cart lines. */\n  numCartLines?: number;\n  /** A callback that is invoked when the process to create a cart begins, but before the cart is created in the Storefront API. */\n  onCreate?: () => void;\n  /** A callback that is invoked when the process to add a line item to the cart begins, but before the line item is added to the Storefront API. */\n  onLineAdd?: () => void;\n  /** A callback that is invoked when the process to remove a line item to the cart begins, but before the line item is removed from the Storefront API. */\n  onLineRemove?: () => void;\n  /** A callback that is invoked when the process to update a line item in the cart begins, but before the line item is updated in the Storefront API. */\n  onLineUpdate?: () => void;\n  /** A callback that is invoked when the process to add or update a note in the cart begins, but before the note is added or updated in the Storefront API. */\n  onNoteUpdate?: () => void;\n  /** A callback that is invoked when the process to update the buyer identity begins, but before the buyer identity is updated in the Storefront API. */\n  onBuyerIdentityUpdate?: () => void;\n  /** A callback that is invoked when the process to update the cart attributes begins, but before the attributes are updated in the Storefront API. */\n  onAttributesUpdate?: () => void;\n  /** A callback that is invoked when the process to update the cart discount codes begins, but before the discount codes are updated in the Storefront API. */\n  onDiscountCodesUpdate?: () => void;\n  /** A callback that is invoked when the process to create a cart completes */\n  onCreateComplete?: () => void;\n  /** A callback that is invoked when the process to add a line item to the cart completes */\n  onLineAddComplete?: () => void;\n  /** A callback that is invoked when the process to remove a line item to the cart completes */\n  onLineRemoveComplete?: () => void;\n  /** A callback that is invoked when the process to update a line item in the cart completes */\n  onLineUpdateComplete?: () => void;\n  /** A callback that is invoked when the process to add or update a note in the cart completes */\n  onNoteUpdateComplete?: () => void;\n  /** A callback that is invoked when the process to update the buyer identity completes */\n  onBuyerIdentityUpdateComplete?: () => void;\n  /** A callback that is invoked when the process to update the cart attributes completes */\n  onAttributesUpdateComplete?: () => void;\n  /** A callback that is invoked when the process to update the cart discount codes completes */\n  onDiscountCodesUpdateComplete?: () => void;\n  /** An object with fields that correspond to the Storefront API's [Cart object](https://shopify.dev/api/storefront/latest/objects/cart). */\n  data?: PartialDeep<CartType, {recurseIntoArrays: true}>;\n  /** A fragment used to query the Storefront API's [Cart object](https://shopify.dev/api/storefront/latest/objects/cart) for all queries and mutations. A default value is used if no argument is provided. */\n  cartFragment?: string;\n  /** A customer access token that's accessible on the server if there's a customer login. */\n  customerAccessToken?: CartBuyerIdentityInput['customerAccessToken'];\n  /** The ISO country code for i18n. */\n  countryCode?: CountryCode;\n}) {\n  if (countryCode) countryCode = countryCode.toUpperCase() as CountryCode;\n  const [prevCountryCode, setPrevCountryCode] = useState(countryCode);\n  const [prevCustomerAccessToken, setPrevCustomerAccessToken] =\n    useState(customerAccessToken);\n  const customerOverridesCountryCode = useRef(false);\n\n  if (\n    prevCountryCode !== countryCode ||\n    prevCustomerAccessToken !== customerAccessToken\n  ) {\n    setPrevCountryCode(countryCode);\n    setPrevCustomerAccessToken(customerAccessToken);\n    customerOverridesCountryCode.current = false;\n  }\n\n  const [cartState, cartSend] = useCartAPIStateMachine({\n    numCartLines,\n    data: cart,\n    cartFragment,\n    countryCode,\n    onCartActionEntry(_, event) {\n      try {\n        switch (event.type) {\n          case 'CART_CREATE':\n            return onCreate?.();\n          case 'CARTLINE_ADD':\n            return onLineAdd?.();\n          case 'CARTLINE_REMOVE':\n            return onLineRemove?.();\n          case 'CARTLINE_UPDATE':\n            return onLineUpdate?.();\n          case 'NOTE_UPDATE':\n            return onNoteUpdate?.();\n          case 'BUYER_IDENTITY_UPDATE':\n            return onBuyerIdentityUpdate?.();\n          case 'CART_ATTRIBUTES_UPDATE':\n            return onAttributesUpdate?.();\n          case 'DISCOUNT_CODES_UPDATE':\n            return onDiscountCodesUpdate?.();\n        }\n      } catch (error) {\n        console.error('Cart entry action failed', error);\n      }\n    },\n    onCartActionOptimisticUI(context, event) {\n      if (!context.cart) return {...context};\n      switch (event.type) {\n        case 'CARTLINE_REMOVE':\n          return {\n            ...context,\n            cart: {\n              ...context.cart,\n              lines: context?.cart?.lines?.filter(\n                (line) => line?.id && !event.payload.lines.includes(line?.id)\n              ),\n            },\n          };\n        case 'CARTLINE_UPDATE':\n          return {\n            ...context,\n            cart: {\n              ...context.cart,\n              lines: context?.cart?.lines?.map((line) => {\n                const updatedLine = event.payload.lines.find(\n                  ({id}) => id === line?.id\n                );\n\n                if (updatedLine && updatedLine.quantity) {\n                  return {\n                    ...line,\n                    quantity: updatedLine.quantity,\n                  };\n                }\n\n                return line;\n              }),\n            },\n          };\n      }\n      return {...context};\n    },\n    onCartActionComplete(context, event) {\n      const cartActionEvent = event.payload.cartActionEvent;\n      try {\n        switch (event.type) {\n          case 'RESOLVE':\n            switch (cartActionEvent.type) {\n              case 'CART_CREATE':\n                return onCreateComplete?.();\n              case 'CARTLINE_ADD':\n                return onLineAddComplete?.();\n              case 'CARTLINE_REMOVE':\n                return onLineRemoveComplete?.();\n              case 'CARTLINE_UPDATE':\n                return onLineUpdateComplete?.();\n              case 'NOTE_UPDATE':\n                return onNoteUpdateComplete?.();\n              case 'BUYER_IDENTITY_UPDATE':\n                if (countryCodeNotUpdated(context, cartActionEvent)) {\n                  customerOverridesCountryCode.current = true;\n                }\n                return onBuyerIdentityUpdateComplete?.();\n              case 'CART_ATTRIBUTES_UPDATE':\n                return onAttributesUpdateComplete?.();\n              case 'DISCOUNT_CODES_UPDATE':\n                return onDiscountCodesUpdateComplete?.();\n            }\n        }\n      } catch (error) {\n        console.error('onCartActionComplete failed', error);\n      }\n    },\n  });\n\n  const cartReady = useRef(false);\n  const cartCompleted = cartState.matches('cartCompleted');\n\n  const countryChanged =\n    (cartState.value === 'idle' ||\n      cartState.value === 'error' ||\n      cartState.value === 'cartCompleted') &&\n    countryCode !== cartState?.context?.cart?.buyerIdentity?.countryCode &&\n    !cartState.context.errors;\n\n  const fetchingFromStorage = useRef(false);\n\n  /**\n   * Initializes cart with priority in this order:\n   * 1. cart props\n   * 2. localStorage cartId\n   */\n  useEffect(() => {\n    if (!cartReady.current && !fetchingFromStorage.current) {\n      if (!cart && storageAvailable('localStorage')) {\n        fetchingFromStorage.current = true;\n        try {\n          const cartId = window.localStorage.getItem(CART_ID_STORAGE_KEY);\n          if (cartId) {\n            cartSend({type: 'CART_FETCH', payload: {cartId}});\n          }\n        } catch (error) {\n          console.warn('error fetching cartId');\n          console.warn(error);\n        }\n      }\n      cartReady.current = true;\n    }\n  }, [cart, cartReady, cartSend]);\n\n  // Update cart country code if cart and props countryCode's as different\n  useEffect(() => {\n    if (!countryChanged || customerOverridesCountryCode.current) return;\n    cartSend({\n      type: 'BUYER_IDENTITY_UPDATE',\n      payload: {buyerIdentity: {countryCode, customerAccessToken}},\n    });\n  }, [\n    countryCode,\n    customerAccessToken,\n    countryChanged,\n    customerOverridesCountryCode,\n    cartSend,\n  ]);\n\n  // send cart events when ready\n  const onCartReadySend = useCallback(\n    (cartEvent: CartMachineEvent) => {\n      if (!cartReady.current) {\n        return console.warn(\"Cart isn't ready yet\");\n      }\n      cartSend(cartEvent);\n    },\n    [cartSend]\n  );\n\n  // save cart id to local storage\n  useEffect(() => {\n    if (cartState?.context?.cart?.id && storageAvailable('localStorage')) {\n      try {\n        window.localStorage.setItem(\n          CART_ID_STORAGE_KEY,\n          cartState.context.cart?.id\n        );\n      } catch (error) {\n        console.warn('Failed to save cartId to localStorage', error);\n      }\n    }\n  }, [cartState?.context?.cart?.id]);\n\n  // delete cart from local storage if cart fetched has been completed\n  useEffect(() => {\n    if (cartCompleted && storageAvailable('localStorage')) {\n      try {\n        window.localStorage.removeItem(CART_ID_STORAGE_KEY);\n      } catch (error) {\n        console.warn('Failed to delete cartId from localStorage', error);\n      }\n    }\n  }, [cartCompleted]);\n\n  const cartCreate = useCallback(\n    (cartInput: CartInput) => {\n      if (countryCode && !cartInput.buyerIdentity?.countryCode) {\n        if (cartInput.buyerIdentity == null) {\n          cartInput.buyerIdentity = {};\n        }\n        cartInput.buyerIdentity.countryCode = countryCode;\n      }\n\n      if (\n        customerAccessToken &&\n        !cartInput.buyerIdentity?.customerAccessToken\n      ) {\n        if (cartInput.buyerIdentity == null) {\n          cartInput.buyerIdentity = {};\n        }\n        cartInput.buyerIdentity.customerAccessToken = customerAccessToken;\n      }\n      onCartReadySend({\n        type: 'CART_CREATE',\n        payload: cartInput,\n      });\n    },\n    [countryCode, customerAccessToken, onCartReadySend]\n  );\n\n  // Delays the cart state in the context if the page is hydrating\n  // preventing suspense boundary errors.\n  const cartDisplayState = useDelayedStateUntilHydration(cartState);\n\n  const cartContextValue = useMemo<CartWithActions>(() => {\n    return {\n      ...(cartDisplayState?.context?.cart ?? {lines: [], attributes: []}),\n      status: transposeStatus(cartDisplayState.value),\n      error: cartDisplayState?.context?.errors,\n      totalQuantity: cartDisplayState?.context?.cart?.totalQuantity ?? 0,\n      cartCreate,\n      linesAdd(lines: CartLineInput[]) {\n        if (cartDisplayState?.context?.cart?.id) {\n          onCartReadySend({\n            type: 'CARTLINE_ADD',\n            payload: {lines},\n          });\n        } else {\n          cartCreate({lines});\n        }\n      },\n      linesRemove(lines: string[]) {\n        onCartReadySend({\n          type: 'CARTLINE_REMOVE',\n          payload: {\n            lines,\n          },\n        });\n      },\n      linesUpdate(lines: CartLineUpdateInput[]) {\n        onCartReadySend({\n          type: 'CARTLINE_UPDATE',\n          payload: {\n            lines,\n          },\n        });\n      },\n      noteUpdate(note: MutationCartNoteUpdateArgs['note']) {\n        onCartReadySend({\n          type: 'NOTE_UPDATE',\n          payload: {\n            note,\n          },\n        });\n      },\n      buyerIdentityUpdate(buyerIdentity: CartBuyerIdentityInput) {\n        onCartReadySend({\n          type: 'BUYER_IDENTITY_UPDATE',\n          payload: {\n            buyerIdentity,\n          },\n        });\n      },\n      cartAttributesUpdate(attributes: AttributeInput[]) {\n        onCartReadySend({\n          type: 'CART_ATTRIBUTES_UPDATE',\n          payload: {\n            attributes,\n          },\n        });\n      },\n      discountCodesUpdate(discountCodes: string[]) {\n        onCartReadySend({\n          type: 'DISCOUNT_CODES_UPDATE',\n          payload: {\n            discountCodes,\n          },\n        });\n      },\n      cartFragment,\n    };\n  }, [\n    cartCreate,\n    cartDisplayState?.context?.cart,\n    cartDisplayState?.context?.errors,\n    cartDisplayState.value,\n    cartFragment,\n    onCartReadySend,\n  ]);\n\n  return (\n    <CartContext.Provider value={cartContextValue}>\n      {children}\n    </CartContext.Provider>\n  );\n}\n\nfunction transposeStatus(\n  status: CartMachineTypeState['value']\n): CartWithActions['status'] {\n  switch (status) {\n    case 'uninitialized':\n    case 'initializationError':\n      return 'uninitialized';\n    case 'idle':\n    case 'cartCompleted':\n    case 'error':\n      return 'idle';\n    case 'cartFetching':\n      return 'fetching';\n    case 'cartCreating':\n      return 'creating';\n    case 'cartLineAdding':\n    case 'cartLineRemoving':\n    case 'cartLineUpdating':\n    case 'noteUpdating':\n    case 'buyerIdentityUpdating':\n    case 'cartAttributesUpdating':\n    case 'discountCodesUpdating':\n      return 'updating';\n  }\n}\n\n/**\n * Delays a state update until hydration finishes. Useful for preventing suspense boundaries errors when updating a context\n * @remarks this uses startTransition and waits for it to finish.\n */\nfunction useDelayedStateUntilHydration<T>(state: T) {\n  const [isPending, startTransition] = useTransition();\n  const [delayedState, setDelayedState] = useState(state);\n\n  const firstTimePending = useRef(false);\n  if (isPending) {\n    firstTimePending.current = true;\n  }\n\n  const firstTimePendingFinished = useRef(false);\n  if (!isPending && firstTimePending.current) {\n    firstTimePendingFinished.current = true;\n  }\n\n  useEffect(() => {\n    startTransition(() => {\n      if (!firstTimePendingFinished.current) {\n        setDelayedState(state);\n      }\n    });\n  }, [state]);\n\n  const displayState = firstTimePendingFinished.current ? state : delayedState;\n\n  return displayState;\n}\n\n/** Check for storage availability funciton obtained from\n * https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API\n */\nexport function storageAvailable(type: 'localStorage' | 'sessionStorage') {\n  let storage;\n  try {\n    storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return (\n      e instanceof DOMException &&\n      // everything except Firefox\n      (e.code === 22 ||\n        // Firefox\n        e.code === 1014 ||\n        // test name field too, because code might not be present\n        // everything except Firefox\n        e.name === 'QuotaExceededError' ||\n        // Firefox\n        e.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&\n      // acknowledge QuotaExceededError only if there's something already stored\n      storage &&\n      storage.length !== 0\n    );\n  }\n}\n\nfunction countryCodeNotUpdated(\n  context: CartMachineContext,\n  event: BuyerIdentityUpdateEvent\n) {\n  return (\n    event.payload.buyerIdentity.countryCode &&\n    context.cart?.buyerIdentity?.countryCode !==\n      event.payload.buyerIdentity.countryCode\n  );\n}\n","import {\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n  createContext,\n  useContext,\n} from 'react';\nimport type {\n  SelectedOption as SelectedOptionType,\n  SellingPlan,\n  SellingPlanAllocation,\n  Product,\n  ProductVariant as ProductVariantType,\n  ProductVariantConnection,\n  SellingPlan as SellingPlanType,\n  SellingPlanAllocation as SellingPlanAllocationType,\n  SellingPlanGroup as SellingPlanGroupType,\n  SellingPlanGroupConnection,\n} from './storefront-api-types.js';\nimport type {PartialDeep} from 'type-fest';\nimport {flattenConnection} from './flatten-connection.js';\n\nconst ProductOptionsContext = createContext<ProductHookValue | null>(null);\n\ntype InitialVariantId = ProductVariantType['id'] | null;\n\ninterface ProductProviderProps {\n  /** A Storefront API [Product object](https://shopify.dev/api/storefront/reference/products/product). */\n  data: PartialDeep<Product, {recurseIntoArrays: true}>;\n  /** A `ReactNode` element. */\n  children: React.ReactNode;\n  /**\n   * The initially selected variant.\n   * The following logic applies to `initialVariantId`:\n   * 1. If `initialVariantId` is provided, then it's used even if it's out of stock.\n   * 2. If `initialVariantId` is provided but is `null`, then no variant is used.\n   * 3. If nothing is passed to `initialVariantId` then the first available / in-stock variant is used.\n   * 4. If nothing is passed to `initialVariantId` and no variants are in stock, then the first variant is used.\n   */\n  initialVariantId?: InitialVariantId;\n}\n\n/**\n * `<ProductProvider />` is a context provider that enables use of the `useProduct()` hook.\n *\n * It helps manage selected options and variants for a product.\n */\nexport function ProductProvider({\n  children,\n  data: product,\n  initialVariantId: explicitVariantId,\n}: ProductProviderProps) {\n  // The flattened variants\n  const variants = useMemo(\n    () => flattenConnection(product.variants ?? {}),\n    [product.variants]\n  );\n\n  if (!isProductVariantArray(variants)) {\n    throw new Error(\n      `<ProductProvider/> requires 'product.variants.nodes' or 'product.variants.edges'`\n    );\n  }\n\n  // All the options available for a product, based on all the variants\n  const options = useMemo(() => getOptions(variants), [variants]);\n\n  /**\n   * Track the selectedVariant within the provider.\n   */\n  const [selectedVariant, setSelectedVariant] = useState<\n    | PartialDeep<ProductVariantType, {recurseIntoArrays: true}>\n    | undefined\n    | null\n  >(() => getVariantBasedOnIdProp(explicitVariantId, variants));\n\n  /**\n   * Track the selectedOptions within the provider. If a `initialVariantId`\n   * is passed, use that to select initial options.\n   */\n  const [selectedOptions, setSelectedOptions] = useState<SelectedOptions>(() =>\n    getSelectedOptions(selectedVariant)\n  );\n\n  /**\n   * When the initialVariantId changes, we need to make sure we\n   * update the selected variant and selected options. If not,\n   * then the selected variant and options will reference incorrect\n   * values.\n   */\n  useEffect(() => {\n    const newSelectedVariant = getVariantBasedOnIdProp(\n      explicitVariantId,\n      variants\n    );\n    setSelectedVariant(newSelectedVariant);\n    setSelectedOptions(getSelectedOptions(newSelectedVariant));\n  }, [explicitVariantId, variants]);\n\n  /**\n   * Allow the developer to select an option.\n   */\n  const setSelectedOption = useCallback(\n    (name: string, value: string) => {\n      setSelectedOptions((selectedOptions) => {\n        const opts = {...selectedOptions, [name]: value};\n        setSelectedVariant(getSelectedVariant(variants, opts));\n        return opts;\n      });\n    },\n    [setSelectedOptions, variants]\n  );\n\n  const isOptionInStock = useCallback(\n    (option: string, value: string) => {\n      const proposedVariant = getSelectedVariant(variants, {\n        ...selectedOptions,\n        ...{[option]: value},\n      });\n\n      return proposedVariant?.availableForSale ?? true;\n    },\n    [selectedOptions, variants]\n  );\n\n  const sellingPlanGroups = useMemo(\n    () =>\n      flattenConnection(product.sellingPlanGroups ?? {}).map(\n        (sellingPlanGroup) => ({\n          ...sellingPlanGroup,\n          sellingPlans: flattenConnection(sellingPlanGroup?.sellingPlans ?? {}),\n        })\n      ),\n    [product.sellingPlanGroups]\n  );\n\n  /**\n   * Track the selectedSellingPlan within the hook. If `initialSellingPlanId`\n   * is passed, use that as an initial value. Look it up from the `selectedVariant`, since\n   * that is also a requirement.\n   */\n  const [selectedSellingPlan, setSelectedSellingPlan] = useState<\n    PartialDeep<SellingPlan, {recurseIntoArrays: true}> | undefined\n  >(undefined);\n\n  const selectedSellingPlanAllocation = useMemo<\n    PartialDeep<SellingPlanAllocation, {recurseIntoArrays: true}> | undefined\n  >(() => {\n    if (!selectedVariant || !selectedSellingPlan) {\n      return;\n    }\n\n    if (\n      !selectedVariant.sellingPlanAllocations?.nodes &&\n      !selectedVariant.sellingPlanAllocations?.edges\n    ) {\n      throw new Error(\n        `<ProductProvider/>: You must include 'sellingPlanAllocations.nodes' or 'sellingPlanAllocations.edges' in your variants in order to calculate selectedSellingPlanAllocation`\n      );\n    }\n\n    return flattenConnection(selectedVariant.sellingPlanAllocations).find(\n      (allocation) => allocation?.sellingPlan?.id === selectedSellingPlan.id\n    );\n  }, [selectedVariant, selectedSellingPlan]);\n\n  const value = useMemo<ProductHookValue>(\n    () => ({\n      variants,\n      variantsConnection: product.variants,\n      options,\n      selectedVariant,\n      setSelectedVariant,\n      selectedOptions,\n      setSelectedOption,\n      setSelectedOptions,\n      isOptionInStock,\n      selectedSellingPlan,\n      setSelectedSellingPlan,\n      selectedSellingPlanAllocation,\n      sellingPlanGroups,\n      sellingPlanGroupsConnection: product.sellingPlanGroups,\n    }),\n    [\n      isOptionInStock,\n      options,\n      product.sellingPlanGroups,\n      product.variants,\n      selectedOptions,\n      selectedSellingPlan,\n      selectedSellingPlanAllocation,\n      selectedVariant,\n      sellingPlanGroups,\n      setSelectedOption,\n      variants,\n    ]\n  );\n\n  return (\n    <ProductOptionsContext.Provider value={value}>\n      {children}\n    </ProductOptionsContext.Provider>\n  );\n}\n\n/**\n * Provides access to the context value provided by `<ProductProvider />`. Must be a descendent of `<ProductProvider />`.\n */\nexport function useProduct() {\n  const context = useContext(ProductOptionsContext);\n\n  if (!context) {\n    throw new Error(`'useProduct' must be a child of <ProductProvider />`);\n  }\n\n  return context;\n}\n\nfunction getSelectedVariant(\n  variants: PartialDeep<ProductVariantType, {recurseIntoArrays: true}>[],\n  choices: SelectedOptions\n): PartialDeep<ProductVariantType, {recurseIntoArrays: true}> | undefined {\n  /**\n   * Ensure the user has selected all the required options, not just some.\n   */\n  if (\n    !variants.length ||\n    variants?.[0]?.selectedOptions?.length !== Object.keys(choices).length\n  ) {\n    return;\n  }\n\n  return variants?.find((variant) => {\n    return Object.entries(choices).every(([name, value]) => {\n      return variant?.selectedOptions?.some(\n        (option) => option?.name === name && option?.value === value\n      );\n    });\n  });\n}\n\nfunction getOptions(\n  variants: PartialDeep<ProductVariantType, {recurseIntoArrays: true}>[]\n): OptionWithValues[] {\n  const map = variants.reduce((memo, variant) => {\n    if (!variant.selectedOptions) {\n      throw new Error(`'getOptions' requires 'variant.selectedOptions'`);\n    }\n    variant?.selectedOptions?.forEach((opt) => {\n      memo[opt?.name ?? ''] = memo[opt?.name ?? ''] || new Set();\n      memo[opt?.name ?? ''].add(opt?.value ?? '');\n    });\n\n    return memo;\n  }, {} as Record<string, Set<string>>);\n\n  return Object.keys(map).map((option) => {\n    return {\n      name: option,\n      values: Array.from(map[option]),\n    };\n  });\n}\n\nfunction getVariantBasedOnIdProp(\n  explicitVariantId: InitialVariantId | undefined,\n  variants: Array<\n    PartialDeep<ProductVariantType, {recurseIntoArrays: true}> | undefined\n  >\n) {\n  // get the initial variant based on the logic outlined in the comments for 'initialVariantId' above\n  // * 1. If `initialVariantId` is provided, then it's used even if it's out of stock.\n  if (explicitVariantId) {\n    const foundVariant = variants.find(\n      (variant) => variant?.id === explicitVariantId\n    );\n    if (!foundVariant) {\n      console.warn(\n        `<ProductProvider/> received a 'initialVariantId' prop, but could not actually find a variant with that ID`\n      );\n    }\n    return foundVariant;\n  }\n  // * 2. If `initialVariantId` is provided but is `null`, then no variant is used.\n  if (explicitVariantId === null) {\n    return null;\n  }\n  // * 3. If nothing is passed to `initialVariantId` then the first available / in-stock variant is used.\n  // * 4. If nothing is passed to `initialVariantId` and no variants are in stock, then the first variant is used.\n  if (explicitVariantId === undefined) {\n    return variants.find((variant) => variant?.availableForSale) || variants[0];\n  }\n}\n\nfunction getSelectedOptions(\n  selectedVariant:\n    | PartialDeep<ProductVariantType, {recurseIntoArrays: true}>\n    | undefined\n    | null\n): SelectedOptions {\n  return selectedVariant?.selectedOptions\n    ? selectedVariant.selectedOptions.reduce<SelectedOptions>(\n        (memo, optionSet) => {\n          memo[optionSet?.name ?? ''] = optionSet?.value ?? '';\n          return memo;\n        },\n        {}\n      )\n    : {};\n}\n\nfunction isProductVariantArray(\n  maybeVariantArray:\n    | (PartialDeep<ProductVariantType, {recurseIntoArrays: true}> | undefined)[]\n    | undefined\n): maybeVariantArray is PartialDeep<\n  ProductVariantType,\n  {recurseIntoArrays: true}\n>[] {\n  if (!maybeVariantArray || !Array.isArray(maybeVariantArray)) {\n    return false;\n  }\n\n  return true;\n}\n\nexport interface OptionWithValues {\n  name: SelectedOptionType['name'];\n  values: SelectedOptionType['value'][];\n}\n\ntype ProductHookValue = PartialDeep<\n  {\n    /** An array of the variant `nodes` from the `VariantConnection`. */\n    variants: ProductVariantType[];\n    variantsConnection?: ProductVariantConnection;\n    /** An array of the product's options and values. */\n    options: OptionWithValues[];\n    /** The selected variant. */\n    selectedVariant?: ProductVariantType | null;\n    selectedOptions: SelectedOptions;\n    /** The selected selling plan. */\n    selectedSellingPlan?: SellingPlanType;\n    /** The selected selling plan allocation. */\n    selectedSellingPlanAllocation?: SellingPlanAllocationType;\n    /** The selling plan groups. */\n    sellingPlanGroups?: (Omit<SellingPlanGroupType, 'sellingPlans'> & {\n      sellingPlans: SellingPlanType[];\n    })[];\n    sellingPlanGroupsConnection?: SellingPlanGroupConnection;\n  },\n  {recurseIntoArrays: true}\n> & {\n  /** A callback to set the selected variant to the variant passed as an argument. */\n  setSelectedVariant: (\n    variant: PartialDeep<ProductVariantType, {recurseIntoArrays: true}> | null\n  ) => void;\n  /** A callback to set the selected option. */\n  setSelectedOption: (\n    name: SelectedOptionType['name'],\n    value: SelectedOptionType['value']\n  ) => void;\n  /** A callback to set multiple selected options at once. */\n  setSelectedOptions: (options: SelectedOptions) => void;\n  /** A callback to set the selected selling plan to the one passed as an argument. */\n  setSelectedSellingPlan: (\n    sellingPlan: PartialDeep<SellingPlanType, {recurseIntoArrays: true}>\n  ) => void;\n  /** A callback that returns a boolean indicating if the option is in stock. */\n  isOptionInStock: (\n    name: SelectedOptionType['name'],\n    value: SelectedOptionType['value']\n  ) => boolean;\n};\n\nexport type SelectedOptions = {\n  [key: string]: string;\n};\n","import {ReactNode, Ref, useCallback} from 'react';\n\nexport interface CustomBaseButtonProps<AsType> {\n  /** Provide a React element or component to render as the underlying button. Note: for accessibility compliance, almost always you should use a `button` element, or a component that renders an underlying button. */\n  as?: AsType;\n  /** Any ReactNode elements. */\n  children: ReactNode;\n  /** Click event handler. Default behaviour triggers unless prevented */\n  onClick?: (\n    event?: React.MouseEvent<HTMLButtonElement, MouseEvent>\n  ) => void | boolean;\n  /** A default onClick behavior */\n  defaultOnClick?: (\n    event?: React.MouseEvent<HTMLButtonElement, MouseEvent>\n  ) => void | boolean;\n  /** A ref to the underlying button */\n  buttonRef?: Ref<HTMLButtonElement>;\n}\n\nexport type BaseButtonProps<AsType extends React.ElementType> =\n  CustomBaseButtonProps<AsType> &\n    Omit<\n      React.ComponentPropsWithoutRef<AsType>,\n      keyof CustomBaseButtonProps<AsType>\n    >;\n\nexport function BaseButton<AsType extends React.ElementType = 'button'>(\n  props: BaseButtonProps<AsType>\n) {\n  const {\n    as,\n    onClick,\n    defaultOnClick,\n    children,\n    buttonRef,\n    ...passthroughProps\n  } = props;\n\n  const handleOnClick = useCallback(\n    (event?: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n      if (onClick) {\n        const clickShouldContinue = onClick(event);\n        if (\n          (typeof clickShouldContinue === 'boolean' &&\n            clickShouldContinue === false) ||\n          event?.defaultPrevented\n        )\n          return;\n      }\n\n      defaultOnClick?.(event);\n    },\n    [defaultOnClick, onClick]\n  );\n\n  const Component = as || 'button';\n\n  return (\n    <Component ref={buttonRef} onClick={handleOnClick} {...passthroughProps}>\n      {children}\n    </Component>\n  );\n}\n","import {useCallback, useEffect, useState} from 'react';\n\nimport {useCart} from './CartProvider.js';\nimport {useProduct} from './ProductProvider.js';\nimport {BaseButton, BaseButtonProps} from './BaseButton.js';\n\nexport interface AddToCartButtonProps {\n  /** An array of cart line attributes that belong to the item being added to the cart. */\n  attributes?: {\n    key: string;\n    value: string;\n  }[];\n  /** The ID of the variant. */\n  variantId?: string | null;\n  /** The item quantity. */\n  quantity?: number;\n  /** The text that is announced by the screen reader when the item is being added to the cart. Used for accessibility purposes only and not displayed on the page. */\n  accessibleAddingToCartLabel?: string;\n  /** The selling plan ID of the subscription variant */\n  sellingPlanId?: string;\n}\n\n/**\n * The `AddToCartButton` component renders a button that adds an item to the cart when pressed.\n * It must be a descendent of the `CartProvider` component.\n */\nexport function AddToCartButton<AsType extends React.ElementType = 'button'>(\n  props: AddToCartButtonProps & BaseButtonProps<AsType>\n) {\n  const [addingItem, setAddingItem] = useState<boolean>(false);\n  const {\n    variantId: explicitVariantId,\n    quantity = 1,\n    attributes,\n    sellingPlanId,\n    onClick,\n    children,\n    accessibleAddingToCartLabel,\n    ...passthroughProps\n  } = props;\n  const {status, linesAdd} = useCart();\n  const {selectedVariant} = useProduct();\n  const variantId = explicitVariantId ?? selectedVariant?.id ?? '';\n  const disabled =\n    explicitVariantId === null ||\n    variantId === '' ||\n    selectedVariant === null ||\n    addingItem ||\n    passthroughProps.disabled;\n\n  useEffect(() => {\n    if (addingItem && status === 'idle') {\n      setAddingItem(false);\n    }\n  }, [status, addingItem]);\n\n  const handleAddItem = useCallback(() => {\n    setAddingItem(true);\n    linesAdd([\n      {\n        quantity,\n        merchandiseId: variantId || '',\n        attributes,\n        sellingPlanId,\n      },\n    ]);\n  }, [linesAdd, quantity, variantId, attributes, sellingPlanId]);\n\n  return (\n    <>\n      <BaseButton\n        {...passthroughProps}\n        disabled={disabled}\n        onClick={onClick}\n        defaultOnClick={handleAddItem}\n      >\n        {children}\n      </BaseButton>\n      {accessibleAddingToCartLabel ? (\n        <p\n          style={{\n            position: 'absolute',\n            width: '1px',\n            height: '1px',\n            padding: '0',\n            margin: '-1px',\n            overflow: 'hidden',\n            clip: 'rect(0, 0, 0, 0)',\n            whiteSpace: 'nowrap',\n            borderWidth: '0',\n          }}\n          role=\"alert\"\n          aria-live=\"assertive\"\n        >\n          {addingItem ? accessibleAddingToCartLabel : null}\n        </p>\n      ) : null}\n    </>\n  );\n}\n","import {useEffect, useState, useCallback} from 'react';\nimport {useCart} from './CartProvider.js';\nimport {BaseButton, BaseButtonProps} from './BaseButton.js';\n\ninterface BuyNowButtonProps {\n  /** The item quantity. Defaults to 1. */\n  quantity?: number;\n  /** The ID of the variant. */\n  variantId: string;\n  /** An array of cart line attributes that belong to the item being added to the cart. */\n  attributes?: {\n    key: string;\n    value: string;\n  }[];\n}\n\n/** The `BuyNowButton` component renders a button that adds an item to the cart and redirects the customer to checkout. */\nexport function BuyNowButton<AsType extends React.ElementType = 'button'>(\n  props: BuyNowButtonProps & BaseButtonProps<AsType>\n) {\n  const {cartCreate, checkoutUrl} = useCart();\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const {\n    quantity,\n    variantId,\n    onClick,\n    attributes,\n    children,\n    ...passthroughProps\n  } = props;\n\n  useEffect(() => {\n    if (checkoutUrl) {\n      window.location.href = checkoutUrl;\n    }\n  }, [checkoutUrl]);\n\n  const handleBuyNow = useCallback(() => {\n    setLoading(true);\n    cartCreate({\n      lines: [\n        {\n          quantity: quantity ?? 1,\n          merchandiseId: variantId,\n          attributes,\n        },\n      ],\n    });\n  }, [cartCreate, quantity, variantId, attributes]);\n\n  return (\n    <BaseButton\n      disabled={loading ?? passthroughProps.disabled}\n      {...passthroughProps}\n      onClick={onClick}\n      defaultOnClick={handleBuyNow}\n    >\n      {children}\n    </BaseButton>\n  );\n}\n","import {ReactNode, useEffect, useState} from 'react';\nimport {useCart} from './CartProvider.js';\nimport {BaseButton, BaseButtonProps} from './BaseButton.js';\n\ntype PropsWeControl = 'onClick';\n\n/**\n * The `CartCheckoutButton` component renders a button that redirects to the checkout URL for the cart.\n * It must be a descendent of a `CartProvider` component.\n */\nexport function CartCheckoutButton(\n  props: Omit<BaseButtonProps<'button'>, PropsWeControl> & {\n    /** A `ReactNode` element. */\n    children: ReactNode;\n  }\n) {\n  const [requestedCheckout, setRequestedCheckout] = useState(false);\n  const {status, checkoutUrl} = useCart();\n  const {children, ...passthroughProps} = props;\n\n  useEffect(() => {\n    if (requestedCheckout && checkoutUrl && status === 'idle') {\n      window.location.href = checkoutUrl;\n    }\n  }, [requestedCheckout, status, checkoutUrl]);\n\n  return (\n    <BaseButton\n      {...passthroughProps}\n      disabled={requestedCheckout || passthroughProps.disabled}\n      onClick={() => setRequestedCheckout(true)}\n    >\n      {children}\n    </BaseButton>\n  );\n}\n","/** Meant to be used with GraphQL CodeGen to type the Storefront API's custom scalars correctly */\nexport const storefrontApiCustomScalars = {\n  // Keep in sync with the definitions in the app/nextjs/codegen.ts!\n  DateTime: 'string',\n  Decimal: 'string',\n  HTML: 'string',\n  URL: 'string',\n  Color: 'string',\n  UnsignedInt64: 'string',\n};\n","import type {ExternalVideo as ExternalVideoType} from './storefront-api-types.js';\nimport type {PartialDeep} from 'type-fest';\n\ninterface BaseProps {\n  /**\n   * An object with fields that correspond to the Storefront API's [ExternalVideo object](https://shopify.dev/api/storefront/reference/products/externalvideo).\n   */\n  data: PartialDeep<ExternalVideoType, {recurseIntoArrays: true}>;\n  /** An object containing the options available for either\n   * [YouTube](https://developers.google.com/youtube/player_parameters#Parameters) or\n   * [Vimeo](https://vimeo.zendesk.com/hc/en-us/articles/360001494447-Using-Player-Parameters).\n   */\n  options?: YouTube | Vimeo;\n}\n\nexport type ExternalVideoProps = Omit<JSX.IntrinsicElements['iframe'], 'src'> &\n  BaseProps;\n\n/**\n * The `ExternalVideo` component renders an embedded video for the Storefront\n * API's [ExternalVideo object](https://shopify.dev/api/storefront/reference/products/externalvideo).\n */\nexport function ExternalVideo(props: ExternalVideoProps) {\n  const {\n    data,\n    options,\n    id = data.id,\n    frameBorder = '0',\n    allow = 'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture',\n    allowFullScreen = true,\n    loading = 'lazy',\n    ...passthroughProps\n  } = props;\n\n  if (!data.embedUrl) {\n    throw new Error(`<ExternalVideo/> requires the 'embedUrl' property`);\n  }\n\n  let finalUrl: string = data.embedUrl;\n\n  if (options) {\n    const urlObject = new URL(data.embedUrl);\n    for (const key of Object.keys(options)) {\n      // @ts-expect-error https://github.com/microsoft/TypeScript/issues/32951\n      urlObject.searchParams.set(key, options[key]);\n    }\n    finalUrl = urlObject.toString();\n  }\n\n  return (\n    <iframe\n      {...passthroughProps}\n      id={id ?? data.embedUrl}\n      title={data.alt ?? data.id ?? 'external video'}\n      frameBorder={frameBorder}\n      allow={allow}\n      allowFullScreen={allowFullScreen}\n      src={finalUrl}\n      loading={loading}\n    ></iframe>\n  );\n}\n\ninterface YouTube {\n  autoplay?: 0 | 1;\n  cc_lang_pref?: string;\n  cc_load_policy?: 1;\n  color?: 'red' | 'white';\n  controls?: 0 | 1;\n  disablekb?: 0 | 1;\n  enablejsapi?: 0 | 1;\n  end?: number;\n  fs?: 0 | 1;\n  hl?: string;\n  iv_load_policy?: 1 | 3;\n  list?: string;\n  list_type?: 'playlist' | 'user_uploads';\n  loop?: 0 | 1;\n  modest_branding?: 1;\n  origin?: string;\n  playlist?: string;\n  plays_inline?: 0 | 1;\n  rel?: 0 | 1;\n  start?: number;\n  widget_referrer?: string;\n}\n\ntype VimeoBoolean = 0 | 1 | boolean;\n\ninterface Vimeo {\n  autopause?: VimeoBoolean;\n  autoplay?: VimeoBoolean;\n  background?: VimeoBoolean;\n  byline?: VimeoBoolean;\n  color?: string;\n  controls?: VimeoBoolean;\n  dnt?: VimeoBoolean;\n  loop?: VimeoBoolean;\n  muted?: VimeoBoolean;\n  pip?: VimeoBoolean;\n  playsinline?: VimeoBoolean;\n  portrait?: VimeoBoolean;\n  quality?: '240p' | '360p' | '540p' | '720p' | '1080p' | '2k' | '4k';\n  speed?: VimeoBoolean;\n  '#t'?: string;\n  texttrack?: string;\n  title?: VimeoBoolean;\n  transparent?: VimeoBoolean;\n}\n","import type {Image as ImageType} from './storefront-api-types.js';\nimport type {PartialDeep} from 'type-fest';\nimport type {ShopifyLoaderOptions, ShopifyLoaderParams} from './Image.js';\n\n// TODO: Are there other CDNs missing from here?\nconst PRODUCTION_CDN_HOSTNAMES = [\n  'cdn.shopify.com',\n  'cdn.shopifycdn.net',\n  'shopify-assets.shopifycdn.com',\n  'shopify-assets.shopifycdn.net',\n];\nconst LOCAL_CDN_HOSTNAMES = ['spin.dev'];\nconst ALL_CDN_HOSTNAMES = [...PRODUCTION_CDN_HOSTNAMES, ...LOCAL_CDN_HOSTNAMES];\n\n// based on the default width sizes used by the Shopify liquid HTML tag img_tag plus a 2560 width to account for 2k resolutions\n// reference: https://shopify.dev/api/liquid/filters/html-filters#image_tag\nexport const IMG_SRC_SET_SIZES = [352, 832, 1200, 1920, 2560];\n\n/**\n * Adds image size parameters to an image URL hosted by Shopify's CDN\n */\nexport function addImageSizeParametersToUrl({\n  src,\n  width,\n  height,\n  crop,\n  scale,\n}: ShopifyLoaderParams) {\n  const newUrl = new URL(src);\n\n  const multipliedScale = scale ?? 1;\n\n  if (width) {\n    let finalWidth: string;\n\n    if (typeof width === 'string') {\n      finalWidth = (IMG_SRC_SET_SIZES[0] * multipliedScale).toString();\n    } else {\n      finalWidth = (Number(width) * multipliedScale).toString();\n    }\n\n    newUrl.searchParams.append('width', finalWidth);\n  }\n\n  if (height && typeof height === 'number') {\n    newUrl.searchParams.append('height', (height * multipliedScale).toString());\n  }\n\n  crop && newUrl.searchParams.append('crop', crop);\n\n  // for now we intentionally leave off the scale param, and instead multiple width & height by scale instead\n  // scale && newUrl.searchParams.append('scale', scale.toString());\n\n  return newUrl.toString();\n}\n\nexport function shopifyImageLoader(params: ShopifyLoaderParams) {\n  const newSrc = new URL(params.src);\n  const isShopifyServedImage = ALL_CDN_HOSTNAMES.some((allowedHostname) =>\n    newSrc.hostname.endsWith(allowedHostname)\n  );\n\n  if (\n    !isShopifyServedImage ||\n    (!params.width && !params.height && !params.crop && !params.scale)\n  ) {\n    return params.src;\n  }\n\n  return addImageSizeParametersToUrl(params);\n}\n\ntype HtmlImageProps = React.ImgHTMLAttributes<HTMLImageElement>;\n\nexport type GetShopifyImageDimensionsProps = {\n  data: Pick<\n    PartialDeep<ImageType, {recurseIntoArrays: true}>,\n    'altText' | 'url' | 'id' | 'width' | 'height'\n  >;\n  loaderOptions?: ShopifyLoaderOptions;\n  elementProps?: {\n    width?: HtmlImageProps['width'];\n    height?: HtmlImageProps['height'];\n  };\n};\n\ntype GetShopifyImageDimensionsPropsReturn = {\n  width: number | string | null;\n  height: number | string | null;\n};\n\n/**\n * Width and height are determined using the followiing priority list:\n * 1. `loaderOptions`'s width/height\n * 2. `elementProps`'s width/height\n * 3. `data`'s width/height\n *\n * If only one of `width` or `height` are defined, then the other will attempt to be calculated based on the Image's aspect ratio,\n * provided that both `data.width` and `data.height` are available. If not, then the aspect ratio cannot be determined and the missing\n * value will reamin as `null`\n */\nexport function getShopifyImageDimensions({\n  data: sfapiImage,\n  loaderOptions,\n  elementProps,\n}: GetShopifyImageDimensionsProps): GetShopifyImageDimensionsPropsReturn {\n  let aspectRatio: number | null = null;\n\n  if (sfapiImage?.width && sfapiImage?.height) {\n    aspectRatio = sfapiImage?.width / sfapiImage?.height;\n  }\n\n  //  * 1. `loaderOptions`'s width/height\n  if (loaderOptions?.width || loaderOptions?.height) {\n    return {\n      width:\n        loaderOptions?.width ??\n        (aspectRatio && typeof loaderOptions.height === 'number'\n          ? Math.round(aspectRatio * loaderOptions.height)\n          : null),\n      height:\n        loaderOptions?.height ??\n        (aspectRatio && typeof loaderOptions.width === 'number'\n          ? Math.round(aspectRatio * loaderOptions.width)\n          : null),\n    };\n  }\n\n  //  * 2. `elementProps`'s width/height\n  if (elementProps?.width || elementProps?.height) {\n    return {\n      width:\n        elementProps?.width ??\n        (aspectRatio && typeof elementProps.height === 'number'\n          ? Math.round(aspectRatio * elementProps.height)\n          : null),\n      height:\n        elementProps?.height ??\n        (aspectRatio && typeof elementProps.width === 'number'\n          ? Math.round(aspectRatio * elementProps.width)\n          : null),\n    };\n  }\n\n  //  * 3. `data`'s width/height\n  if (sfapiImage?.width || sfapiImage?.height) {\n    return {\n      // can't calculate the aspect ratio here\n      width: sfapiImage?.width ?? null,\n      height: sfapiImage?.height ?? null,\n    };\n  }\n\n  return {width: null, height: null};\n}\n","import * as React from 'react';\nimport {\n  getShopifyImageDimensions,\n  shopifyImageLoader,\n  addImageSizeParametersToUrl,\n  IMG_SRC_SET_SIZES,\n} from './image-size.js';\nimport type {Image as ImageType} from './storefront-api-types.js';\nimport type {PartialDeep, Simplify} from 'type-fest';\n\ntype HtmlImageProps = React.ImgHTMLAttributes<HTMLImageElement>;\n\nexport type ShopifyLoaderOptions = {\n  crop?: 'top' | 'bottom' | 'left' | 'right' | 'center';\n  scale?: 2 | 3;\n  width?: HtmlImageProps['width'] | ImageType['width'];\n  height?: HtmlImageProps['height'] | ImageType['height'];\n};\nexport type ShopifyLoaderParams = Simplify<ShopifyLoaderOptions & ImageSrc>;\n\ntype ImageSrc = {\n  src: ImageType['url'];\n};\n\nexport type ShopifyImageProps = Omit<HtmlImageProps, 'src'> &\n  ShopifyImageBaseProps;\n\ntype ShopifyImageBaseProps = {\n  /** An object with fields that correspond to the Storefront API's\n   * [Image object](https://shopify.dev/api/storefront/reference/common-objects/image).\n   * The `data` prop is required.\n   */\n  data: PartialDeep<ImageType, {recurseIntoArrays: true}>;\n  /** A custom function that generates the image URL. Parameters passed in\n   * are `ShopifyLoaderParams`\n   */\n  loader?: (params: ShopifyLoaderParams) => string;\n  /** An object of `loader` function options. For example, if the `loader` function\n   * requires a `scale` option, then the value can be a property of the\n   * `loaderOptions` object (for example, `{scale: 2}`). The object shape is `ShopifyLoaderOptions`.\n   */\n  loaderOptions?: ShopifyLoaderOptions;\n  /**\n   * `src` isn't used, and should instead be passed as part of the `data` object\n   */\n  src?: never;\n  /**\n   * An array of pixel widths to overwrite the default generated srcset. For example, `[300, 600, 800]`.\n   */\n  widths?: (HtmlImageProps['width'] | ImageType['width'])[];\n};\n\n/**\n * The `Image` component renders an image for the Storefront API's\n * [Image object](https://shopify.dev/api/storefront/reference/common-objects/image) by using the `data` prop. You can [customize this component](https://shopify.dev/api/hydrogen/components#customizing-hydrogen-components) using passthrough props.\n *\n * An image's width and height are determined using the following priority list:\n * 1. The width and height values for the `loaderOptions` prop\n * 2. The width and height values for bare props\n * 3. The width and height values for the `data` prop\n *\n * If only one of `width` or `height` are defined, then the other will attempt to be calculated based on the image's aspect ratio,\n * provided that both `data.width` and `data.height` are available. If `data.width` and `data.height` aren't available, then the aspect ratio cannot be determined and the missing\n * value will remain as `null`\n */\nexport function Image({\n  data,\n  width,\n  height,\n  loading,\n  loader = shopifyImageLoader,\n  loaderOptions,\n  widths,\n  decoding = 'async',\n  ...rest\n}: ShopifyImageProps) {\n  if (!data.url) {\n    const missingUrlError = `<Image/>: the 'data' prop requires the 'url' property. Image: ${\n      data.id ?? 'no ID provided'\n    }`;\n\n    if (__HYDROGEN_DEV__) {\n      throw new Error(missingUrlError);\n    } else {\n      console.error(missingUrlError);\n    }\n\n    return null;\n  }\n\n  if (__HYDROGEN_DEV__ && !data.altText && !rest.alt) {\n    console.warn(\n      `<Image/>: the 'data' prop should have the 'altText' property, or the 'alt' prop, and one of them should not be empty. Image: ${\n        data.id ?? data.url\n      }`\n    );\n  }\n\n  const {width: imgElementWidth, height: imgElementHeight} =\n    getShopifyImageDimensions({\n      data,\n      loaderOptions,\n      elementProps: {\n        width,\n        height,\n      },\n    });\n\n  if (__HYDROGEN_DEV__ && (!imgElementWidth || !imgElementHeight)) {\n    console.warn(\n      `<Image/>: the 'data' prop requires either 'width' or 'data.width', and 'height' or 'data.height' properties. Image: ${\n        data.id ?? data.url\n      }`\n    );\n  }\n\n  let finalSrc = data.url;\n\n  if (loader) {\n    finalSrc = loader({\n      ...loaderOptions,\n      src: data.url,\n      width: imgElementWidth,\n      height: imgElementHeight,\n    });\n    if (typeof finalSrc !== 'string' || !finalSrc) {\n      throw new Error(\n        `<Image/>: 'loader' did not return a valid string. Image: ${\n          data.id ?? data.url\n        }`\n      );\n    }\n  }\n\n  // determining what the intended width of the image is. For example, if the width is specified and lower than the image width, then that is the maximum image width\n  // to prevent generating a srcset with widths bigger than needed or to generate images that would distort because of being larger than original\n  const maxWidth =\n    width && imgElementWidth && width < imgElementWidth\n      ? width\n      : imgElementWidth;\n  const finalSrcset =\n    rest.srcSet ??\n    internalImageSrcSet({\n      ...loaderOptions,\n      widths,\n      src: data.url,\n      width: maxWidth,\n      height: imgElementHeight,\n      loader,\n    });\n\n  /* eslint-disable hydrogen/prefer-image-component */\n  return (\n    <img\n      id={data.id ?? ''}\n      alt={data.altText ?? rest.alt ?? ''}\n      loading={loading ?? 'lazy'}\n      {...rest}\n      src={finalSrc}\n      width={imgElementWidth ?? undefined}\n      height={imgElementHeight ?? undefined}\n      srcSet={finalSrcset}\n      decoding={decoding}\n    />\n  );\n  /* eslint-enable hydrogen/prefer-image-component */\n}\n\ntype InternalShopifySrcSetGeneratorsParams = Simplify<\n  ShopifyLoaderOptions & {\n    src: ImageType['url'];\n    widths?: (HtmlImageProps['width'] | ImageType['width'])[];\n    loader?: (params: ShopifyLoaderParams) => string;\n  }\n>;\nfunction internalImageSrcSet({\n  src,\n  width,\n  crop,\n  scale,\n  widths,\n  loader,\n  height,\n}: InternalShopifySrcSetGeneratorsParams) {\n  const hasCustomWidths = widths && Array.isArray(widths);\n  if (hasCustomWidths && widths.some((size) => isNaN(size as number))) {\n    throw new Error(\n      `<Image/>: the 'widths' must be an array of numbers. Image: ${src}`\n    );\n  }\n\n  let aspectRatio = 1;\n  if (width && height) {\n    aspectRatio = Number(height) / Number(width);\n  }\n\n  let setSizes = hasCustomWidths ? widths : IMG_SRC_SET_SIZES;\n  if (\n    !hasCustomWidths &&\n    width &&\n    width < IMG_SRC_SET_SIZES[IMG_SRC_SET_SIZES.length - 1]\n  ) {\n    setSizes = IMG_SRC_SET_SIZES.filter((size) => size <= width);\n  }\n  const srcGenerator = loader ? loader : addImageSizeParametersToUrl;\n  return setSizes\n    .map(\n      (size) =>\n        `${srcGenerator({\n          src,\n          width: size,\n          // height is not applied if there is no crop\n          // if there is crop, then height is applied as a ratio of the original width + height aspect ratio * size\n          height: crop ? Number(size) * aspectRatio : undefined,\n          crop,\n          scale,\n        })} ${size}w`\n    )\n    .join(', ');\n}\n","import {type HTMLAttributes} from 'react';\nimport {shopifyImageLoader} from './image-size.js';\nimport type {Video as VideoType} from './storefront-api-types.js';\nimport type {PartialDeep} from 'type-fest';\n\nexport interface VideoProps {\n  /** An object with fields that correspond to the Storefront API's [Video object](https://shopify.dev/api/storefront/latest/objects/video). */\n  data: PartialDeep<VideoType, {recurseIntoArrays: true}>;\n  /** An object of image size options for the video's `previewImage`. Uses `shopifyImageLoader` to generate the `poster` URL. */\n  previewImageOptions?: Parameters<typeof shopifyImageLoader>[0];\n  /** Props that will be passed to the `video` element's `source` children elements. */\n  sourceProps?: HTMLAttributes<HTMLSourceElement> & {\n    'data-testid'?: string;\n  };\n}\n\n/**\n * The `Video` component renders a `video` for the Storefront API's [Video object](https://shopify.dev/api/storefront/reference/products/video).\n */\nexport function Video(props: JSX.IntrinsicElements['video'] & VideoProps) {\n  const {\n    data,\n    previewImageOptions,\n    id = data.id,\n    playsInline = true,\n    controls = true,\n    sourceProps = {},\n    ...passthroughProps\n  } = props;\n\n  const posterUrl = shopifyImageLoader({\n    src: data.previewImage?.url ?? '',\n    ...previewImageOptions,\n  });\n\n  if (!data.sources) {\n    throw new Error(`<Video/> requires a 'data.sources' array`);\n  }\n\n  return (\n    // eslint-disable-next-line jsx-a11y/media-has-caption\n    <video\n      {...passthroughProps}\n      id={id}\n      playsInline={playsInline}\n      controls={controls}\n      poster={posterUrl}\n    >\n      {data.sources.map((source) => {\n        if (!(source?.url && source?.mimeType)) {\n          throw new Error(`<Video/> needs 'source.url' and 'source.mimeType'`);\n        }\n        return (\n          <source\n            {...sourceProps}\n            key={source.url}\n            src={source.url}\n            type={source.mimeType}\n          />\n        );\n      })}\n    </video>\n  );\n}\n","import {useState, useEffect} from 'react';\n\nconst SCRIPTS_LOADED: Record<string, Promise<boolean>> = {};\n\nexport function loadScript(\n  src: string,\n  options?: {module?: boolean; in?: 'head' | 'body'}\n): Promise<boolean> {\n  const isScriptLoaded: Promise<boolean> = SCRIPTS_LOADED[src];\n\n  if (isScriptLoaded) {\n    return isScriptLoaded;\n  }\n\n  const promise = new Promise<boolean>((resolve, reject) => {\n    const script = document.createElement('script');\n    if (options?.module) {\n      script.type = 'module';\n    } else {\n      script.type = 'text/javascript';\n    }\n    script.src = src;\n    script.onload = () => {\n      resolve(true);\n    };\n    script.onerror = () => {\n      reject(false);\n    };\n    if (options?.in === 'head') {\n      document.head.appendChild(script);\n    } else {\n      document.body.appendChild(script);\n    }\n  });\n\n  SCRIPTS_LOADED[src] = promise;\n\n  return promise;\n}\n\ntype LoadScriptParams = Parameters<typeof loadScript>;\n\n/**\n * The `useLoadScript` hook loads an external script tag in the browser. It allows React components to lazy-load large third-party dependencies.\n */\nexport function useLoadScript(\n  url: LoadScriptParams[0],\n  options?: LoadScriptParams[1]\n): ScriptState {\n  const [status, setStatus] = useState<ScriptState>('loading');\n  const stringifiedOptions = JSON.stringify(options);\n\n  useEffect(() => {\n    async function loadScriptWrapper() {\n      try {\n        setStatus('loading');\n        await loadScript(url, options);\n        setStatus('done');\n      } catch (error) {\n        setStatus('error');\n      }\n    }\n\n    loadScriptWrapper();\n  }, [url, stringifiedOptions, options]);\n\n  return status;\n}\n\ntype ScriptState = 'loading' | 'done' | 'error';\n","import {useState, useEffect, useCallback} from 'react';\nimport {useLoadScript} from './load-script.js';\nimport type {Model3d} from './storefront-api-types.js';\nimport type {PartialDeep} from 'type-fest';\nimport type {ModelViewerElement} from '@google/model-viewer/lib/model-viewer.js';\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/no-namespace\n  namespace JSX {\n    interface IntrinsicElements {\n      'model-viewer': PartialDeep<\n        ModelViewerElement,\n        {recurseIntoArrays: true}\n      >;\n    }\n  }\n}\n\ntype ModelViewerProps = Omit<\n  PartialDeep<JSX.IntrinsicElements['model-viewer'], {recurseIntoArrays: true}>,\n  'src'\n> &\n  ModelViewerBaseProps;\n\ntype ModelViewerBaseProps = {\n  /** An object with fields that correspond to the Storefront API's [Model3D object](https://shopify.dev/api/storefront/latest/objects/model3d). */\n  data: PartialDeep<Model3d, {recurseIntoArrays: true}>;\n  /** The callback to invoke when the 'error' event is triggered. Refer to [error in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-loading-events-error). */\n  onError?: (event: Event) => void;\n  /** The callback to invoke when the `load` event is triggered. Refer to [load in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-loading-events-load). */\n  onLoad?: (event: Event) => void;\n  /** The callback to invoke when the 'preload' event is triggered. Refer to [preload in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-loading-events-preload). */\n  onPreload?: (event: Event) => void;\n  /** The callback to invoke when the 'model-visibility' event is triggered. Refer to [model-visibility in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-loading-events-modelVisibility). */\n  onModelVisibility?: (event: Event) => void;\n  /** The callback to invoke when the 'progress' event is triggered. Refer to [progress in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-loading-events-progress). */\n  onProgress?: (event: Event) => void;\n  /** The callback to invoke when the 'ar-status' event is triggered. Refer to [ar-status in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-augmentedreality-events-arStatus). */\n  onArStatus?: (event: Event) => void;\n  /** The callback to invoke when the 'ar-tracking' event is triggered. Refer to [ar-tracking in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-augmentedreality-events-arTracking). */\n  onArTracking?: (event: Event) => void;\n  /** The callback to invoke when the 'quick-look-button-tapped' event is triggered. Refer to [quick-look-button-tapped in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-augmentedreality-events-quickLookButtonTapped). */\n  onQuickLookButtonTapped?: (event: Event) => void;\n  /** The callback to invoke when the 'camera-change' event is triggered. Refer to [camera-change in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-stagingandcameras-events-cameraChange). */\n  onCameraChange?: (event: Event) => void;\n  /** The callback to invoke when the 'environment-change' event is triggered. Refer to [environment-change in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-lightingandenv-events-environmentChange).  */\n  onEnvironmentChange?: (event: Event) => void;\n  /**  The callback to invoke when the 'play' event is triggered. Refer to [play in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-animation-events-play). */\n  onPlay?: (event: Event) => void;\n  /**  The callback to invoke when the 'pause' event is triggered. Refer to [pause in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-animation-events-pause). */\n  onPause?: (event: Event) => void;\n  /** The callback to invoke when the 'scene-graph-ready' event is triggered. Refer to [scene-graph-ready in the <model-viewer> documentation](https://modelviewer.dev/docs/index.html#entrydocs-scenegraph-events-sceneGraphReady). */\n  onSceneGraphReady?: (event: Event) => void;\n};\n\n/**\n * The `ModelViewer` component renders a 3D model (with the `model-viewer` custom element) for\n * the Storefront API's [Model3d object](https://shopify.dev/api/storefront/reference/products/model3d).\n *\n * The `model-viewer` custom element is lazily downloaded through a dynamically-injected `<script type=\"module\">` tag when the `<ModelViewer />` component is rendered\n *\n * ModelViewer is using version `1.21.1` of the `@google/model-viewer` library.\n */\nexport function ModelViewer(props: ModelViewerProps) {\n  const [modelViewer, setModelViewer] = useState<undefined | HTMLElement>(\n    undefined\n  );\n  const callbackRef = useCallback((node: HTMLElement) => {\n    setModelViewer(node);\n  }, []);\n  const {data, children, className, ...passthroughProps} = props;\n\n  const modelViewerLoadedStatus = useLoadScript(\n    'https://unpkg.com/@google/model-viewer@v1.12.1/dist/model-viewer.min.js',\n    {\n      module: true,\n    }\n  );\n\n  useEffect(() => {\n    if (!modelViewer) {\n      return;\n    }\n    if (passthroughProps.onError)\n      modelViewer.addEventListener('error', passthroughProps.onError);\n    if (passthroughProps.onLoad)\n      modelViewer.addEventListener('load', passthroughProps.onLoad);\n    if (passthroughProps.onPreload)\n      modelViewer.addEventListener('preload', passthroughProps.onPreload);\n    if (passthroughProps.onModelVisibility)\n      modelViewer.addEventListener(\n        'model-visibility',\n        passthroughProps.onModelVisibility\n      );\n    if (passthroughProps.onProgress)\n      modelViewer.addEventListener('progress', passthroughProps.onProgress);\n    if (passthroughProps.onArStatus)\n      modelViewer.addEventListener('ar-status', passthroughProps.onArStatus);\n    if (passthroughProps.onArTracking)\n      modelViewer.addEventListener(\n        'ar-tracking',\n        passthroughProps.onArTracking\n      );\n    if (passthroughProps.onQuickLookButtonTapped)\n      modelViewer.addEventListener(\n        'quick-look-button-tapped',\n        passthroughProps.onQuickLookButtonTapped\n      );\n    if (passthroughProps.onCameraChange)\n      modelViewer.addEventListener(\n        'camera-change',\n        passthroughProps.onCameraChange\n      );\n    if (passthroughProps.onEnvironmentChange)\n      modelViewer.addEventListener(\n        'environment-change',\n        passthroughProps.onEnvironmentChange\n      );\n    if (passthroughProps.onPlay)\n      modelViewer.addEventListener('play', passthroughProps.onPlay);\n    if (passthroughProps.onPause)\n      modelViewer.addEventListener('ar-status', passthroughProps.onPause);\n    if (passthroughProps.onSceneGraphReady)\n      modelViewer.addEventListener(\n        'scene-graph-ready',\n        passthroughProps.onSceneGraphReady\n      );\n\n    return () => {\n      if (modelViewer == null) {\n        return;\n      }\n      if (passthroughProps.onError)\n        modelViewer.removeEventListener('error', passthroughProps.onError);\n      if (passthroughProps.onLoad)\n        modelViewer.removeEventListener('load', passthroughProps.onLoad);\n      if (passthroughProps.onPreload)\n        modelViewer.removeEventListener('preload', passthroughProps.onPreload);\n      if (passthroughProps.onModelVisibility)\n        modelViewer.removeEventListener(\n          'model-visibility',\n          passthroughProps.onModelVisibility\n        );\n      if (passthroughProps.onProgress)\n        modelViewer.removeEventListener(\n          'progress',\n          passthroughProps.onProgress\n        );\n      if (passthroughProps.onArStatus)\n        modelViewer.removeEventListener(\n          'ar-status',\n          passthroughProps.onArStatus\n        );\n      if (passthroughProps.onArTracking)\n        modelViewer.removeEventListener(\n          'ar-tracking',\n          passthroughProps.onArTracking\n        );\n      if (passthroughProps.onQuickLookButtonTapped)\n        modelViewer.removeEventListener(\n          'quick-look-button-tapped',\n          passthroughProps.onQuickLookButtonTapped\n        );\n      if (passthroughProps.onCameraChange)\n        modelViewer.removeEventListener(\n          'camera-change',\n          passthroughProps.onCameraChange\n        );\n      if (passthroughProps.onEnvironmentChange)\n        modelViewer.removeEventListener(\n          'environment-change',\n          passthroughProps.onEnvironmentChange\n        );\n      if (passthroughProps.onPlay)\n        modelViewer.removeEventListener('play', passthroughProps.onPlay);\n      if (passthroughProps.onPause)\n        modelViewer.removeEventListener('ar-status', passthroughProps.onPause);\n      if (passthroughProps.onSceneGraphReady)\n        modelViewer.removeEventListener(\n          'scene-graph-ready',\n          passthroughProps.onSceneGraphReady\n        );\n    };\n  }, [\n    modelViewer,\n    passthroughProps.onArStatus,\n    passthroughProps.onArTracking,\n    passthroughProps.onCameraChange,\n    passthroughProps.onEnvironmentChange,\n    passthroughProps.onError,\n    passthroughProps.onLoad,\n    passthroughProps.onModelVisibility,\n    passthroughProps.onPause,\n    passthroughProps.onPlay,\n    passthroughProps.onPreload,\n    passthroughProps.onProgress,\n    passthroughProps.onQuickLookButtonTapped,\n    passthroughProps.onSceneGraphReady,\n  ]);\n\n  if (modelViewerLoadedStatus !== 'done') {\n    // TODO: What do we want to display while the model-viewer library loads?\n    return null;\n  }\n\n  if (!data.sources?.[0]?.url) {\n    const sourcesUrlError = `<ModelViewer/> requires 'data.sources' prop to be an array, with an object that has a property 'url' on it. Rendering 'null'`;\n    if (__HYDROGEN_DEV__) {\n      throw new Error(sourcesUrlError);\n    } else {\n      console.error(sourcesUrlError);\n      return null;\n    }\n  }\n\n  if (__HYDROGEN_DEV__ && !data.alt) {\n    console.warn(\n      `<ModelViewer/> requires the 'data.alt' prop for accessibility`\n    );\n  }\n\n  return (\n    <model-viewer\n      // @ts-expect-error ref should exist\n      ref={callbackRef}\n      {...passthroughProps}\n      className={className}\n      id={passthroughProps.id ?? data.id}\n      src={data.sources[0].url}\n      alt={data.alt ?? null}\n      camera-controls={passthroughProps.cameraControls ?? true}\n      poster={(passthroughProps.poster || data.previewImage?.url) ?? null}\n      autoplay={passthroughProps.autoplay ?? true}\n      loading={passthroughProps.loading}\n      reveal={passthroughProps.reveal}\n      ar={passthroughProps.ar}\n      ar-modes={passthroughProps.arModes}\n      ar-scale={passthroughProps.arScale}\n      // @ts-expect-error arPlacement should exist as a type, not sure why it doesn't. https://modelviewer.dev/docs/index.html#entrydocs-augmentedreality-attributes-arPlacement\n      ar-placement={passthroughProps.arPlacement}\n      ios-src={passthroughProps.iosSrc}\n      touch-action={passthroughProps.touchAction}\n      disable-zoom={passthroughProps.disableZoom}\n      orbit-sensitivity={passthroughProps.orbitSensitivity}\n      auto-rotate={passthroughProps.autoRotate}\n      auto-rotate-delay={passthroughProps.autoRotateDelay}\n      // @ts-expect-error rotationPerSecond should exist as a type, not sure why it doesn't. https://modelviewer.dev/docs/index.html#entrydocs-stagingandcameras-attributes-rotationPerSecond\n      rotation-per-second={passthroughProps.rotationPerSecond}\n      interaction-policy={passthroughProps.interactionPolicy}\n      interaction-prompt={passthroughProps.interactionPrompt}\n      interaction-prompt-style={passthroughProps.interactionPromptStyle}\n      interaction-prompt-threshold={passthroughProps.interactionPromptThreshold}\n      camera-orbit={passthroughProps.cameraOrbit}\n      camera-target={passthroughProps.cameraTarget}\n      field-of-view={passthroughProps.fieldOfView}\n      max-camera-orbit={passthroughProps.maxCameraOrbit}\n      min-camera-orbit={passthroughProps.minCameraOrbit}\n      max-field-of-view={passthroughProps.maxFieldOfView}\n      min-field-of-view={passthroughProps.minFieldOfView}\n      bounds={passthroughProps.bounds}\n      interpolation-decay={passthroughProps.interpolationDecay ?? 100}\n      skybox-image={passthroughProps.skyboxImage}\n      environment-image={passthroughProps.environmentImage}\n      exposure={passthroughProps.exposure}\n      shadow-intensity={passthroughProps.shadowIntensity ?? 0}\n      shadow-softness={passthroughProps.shadowSoftness ?? 0}\n      animation-name={passthroughProps.animationName}\n      animation-crossfade-duration={passthroughProps.animationCrossfadeDuration}\n      variant-name={passthroughProps.variantName}\n      orientation={passthroughProps.orientation}\n      scale={passthroughProps.scale}\n    >\n      {children}\n    </model-viewer>\n  );\n}\n","import {Image, type ShopifyImageProps} from './Image.js';\nimport {Video} from './Video.js';\nimport {ExternalVideo} from './ExternalVideo.js';\nimport {ModelViewer} from './ModelViewer.js';\nimport type {MediaEdge as MediaEdgeType} from './storefront-api-types.js';\nimport type {PartialDeep} from 'type-fest';\nimport type {ModelViewerElement} from '@google/model-viewer/lib/model-viewer.js';\n\ntype BaseProps = React.HTMLAttributes<\n  HTMLImageElement | HTMLVideoElement | HTMLIFrameElement | ModelViewerElement\n>;\nexport interface MediaFileProps extends BaseProps {\n  /** An object with fields that correspond to the Storefront API's [Media object](https://shopify.dev/api/storefront/reference/products/media). */\n  data: PartialDeep<MediaEdgeType['node'], {recurseIntoArrays: true}>;\n  /** The options for the `Image`, `Video`, `ExternalVideo`, or `ModelViewer` components. */\n  mediaOptions?: MediaOptions;\n}\n\ntype MediaOptions = {\n  /** Props that will only apply when an `<Image />` is rendered */\n  image?: Omit<ShopifyImageProps, 'data'>;\n  /** Props that will only apply when a `<Video />` is rendered */\n  video?: Omit<React.ComponentProps<typeof Video>, 'data'>;\n  /** Props that will only apply when an `<ExternalVideo />` is rendered */\n  externalVideo?: Omit<\n    React.ComponentProps<typeof ExternalVideo>['options'],\n    'data'\n  >;\n  /** Props that will only apply when a `<ModelViewer />` is rendered */\n  modelViewer?: Omit<typeof ModelViewer, 'data'>;\n};\n\n/**\n * The `MediaFile` component renders the media for the Storefront API's\n * [Media object](https://shopify.dev/api/storefront/reference/products/media). It renders an `Image`, a\n * `Video`, an `ExternalVideo`, or a `ModelViewer` depending on the `__typename` of the `data` prop.\n */\nexport function MediaFile({\n  data,\n  mediaOptions,\n  ...passthroughProps\n}: MediaFileProps) {\n  switch (data.__typename) {\n    case 'MediaImage': {\n      if (!data.image) {\n        const noDataImage = `<MediaFile/>: 'data.image' does not exist for __typename of 'MediaImage'; rendering 'null' by default.`;\n        if (__HYDROGEN_DEV__) {\n          throw new Error(noDataImage);\n        } else {\n          console.warn(noDataImage);\n          return null;\n        }\n      }\n\n      return (\n        <Image\n          {...passthroughProps}\n          {...mediaOptions?.image}\n          data={data.image}\n        />\n      );\n    }\n    case 'Video': {\n      return (\n        <Video {...passthroughProps} {...mediaOptions?.video} data={data} />\n      );\n    }\n    case 'ExternalVideo': {\n      return (\n        <ExternalVideo\n          {...passthroughProps}\n          {...mediaOptions?.externalVideo}\n          data={data}\n        />\n      );\n    }\n    case 'Model3d': {\n      return (\n        // @ts-expect-error There are issues with the inferred HTML attribute types here for ModelViewer (and contentEditable), but I think that's a little bit beyond me at the moment\n        <ModelViewer\n          {...passthroughProps}\n          {...mediaOptions?.modelViewer}\n          data={data}\n        />\n      );\n    }\n    default: {\n      const typenameMissingMessage = `<MediaFile /> requires the '__typename' property to exist on the 'data' prop in order to render the matching sub-component for this type of media.`;\n      if (__HYDROGEN_DEV__) {\n        throw new Error(typenameMissingMessage);\n      } else {\n        console.error(`${typenameMissingMessage}  Rendering 'null' by default`);\n        return null;\n      }\n    }\n  }\n}\n","import type {\n  Collection,\n  GenericFile,\n  Metafield as MetafieldBaseType,\n  MoneyV2,\n  Page,\n  Product,\n  ProductVariant,\n} from './storefront-api-types.js';\nimport type {PartialDeep, Simplify} from 'type-fest';\nimport {flattenConnection} from './flatten-connection.js';\n\n/**\n * A temporary function that will be renamed to `parseMetafield()` in a future release.\n *\n * A function that uses `metafield.type` to parse the Metafield's `value` or `reference` or `references` (depending on the `type`) and put it in `metafield.parsedValue`\n *\n * TypeScript developers can use the type `ParsedMetafields` from this package to get the returned object's type correct. For example:\n *\n * ```\n * parseMetafield<ParsedMetafields['boolean']>({type: 'boolean', value: 'false'}\n * ```\n */\nexport function parseMetafield<ReturnGeneric>(\n  metafield: PartialDeep<MetafieldBaseType, {recurseIntoArrays: true}>\n): ReturnGeneric {\n  if (!metafield.type) {\n    const noTypeError = `parseMetafield(): The 'type' field is required in order to parse the Metafield.`;\n    if (__HYDROGEN_DEV__) {\n      throw new Error(noTypeError);\n    } else {\n      console.error(`${noTypeError} Returning 'parsedValue' of 'null'`);\n      return {\n        ...metafield,\n        parsedValue: null,\n      } as ReturnGeneric;\n    }\n  }\n\n  switch (metafield.type) {\n    case 'boolean':\n      return {\n        ...metafield,\n        parsedValue: metafield.value === 'true',\n      } as ReturnGeneric;\n\n    case 'collection_reference':\n    case 'file_reference':\n    case 'page_reference':\n    case 'product_reference':\n    case 'variant_reference':\n      return {\n        ...metafield,\n        parsedValue: metafield.reference,\n      } as ReturnGeneric;\n\n    case 'color':\n    case 'multi_line_text_field':\n    case 'single_line_text_field':\n    case 'url':\n      return {\n        ...metafield,\n        parsedValue: metafield.value,\n      } as ReturnGeneric;\n\n    // TODO: 'money' should probably be parsed even further to like `useMoney()`, but that logic needs to be extracted first so it's not a hook\n    case 'dimension':\n    case 'money':\n    case 'json':\n    case 'rating':\n    case 'volume':\n    case 'weight':\n    case 'list.color':\n    case 'list.dimension':\n    case 'list.number_integer':\n    case 'list.number_decimal':\n    case 'list.rating':\n    case 'list.single_line_text_field':\n    case 'list.url':\n    case 'list.volume':\n    case 'list.weight': {\n      let parsedValue = null;\n      try {\n        parsedValue = parseJSON(metafield.value ?? '');\n      } catch (err) {\n        const parseError = `parseMetafield(): attempted to JSON.parse the 'metafield.value' property, but failed.`;\n        if (__HYDROGEN_DEV__) {\n          throw new Error(parseError);\n        } else {\n          console.error(`${parseError} Returning 'null' for 'parsedValue'`);\n        }\n        parsedValue = null;\n      }\n      return {\n        ...metafield,\n        parsedValue,\n      } as ReturnGeneric;\n    }\n\n    case 'date':\n    case 'date_time':\n      return {\n        ...metafield,\n        parsedValue: new Date(metafield.value ?? ''),\n      } as ReturnGeneric;\n\n    case 'list.date':\n    case 'list.date_time': {\n      const jsonParseValue = parseJSON(metafield?.value ?? '') as string[];\n      return {\n        ...metafield,\n        parsedValue: jsonParseValue.map((dateString) => new Date(dateString)),\n      } as ReturnGeneric;\n    }\n\n    case 'number_decimal':\n    case 'number_integer':\n      return {\n        ...metafield,\n        parsedValue: Number(metafield.value),\n      } as ReturnGeneric;\n\n    case 'list.collection_reference':\n    case 'list.file_reference':\n    case 'list.page_reference':\n    case 'list.product_reference':\n    case 'list.variant_reference':\n      return {\n        ...metafield,\n        parsedValue: flattenConnection(metafield.references ?? undefined),\n      } as ReturnGeneric;\n\n    default: {\n      const typeNotFoundError = `parseMetafield(): the 'metafield.type' you passed in is not supported. Your type: \"${metafield.type}\". If you believe this is an error, please open an issue on GitHub.`;\n      if (__HYDROGEN_DEV__) {\n        throw new Error(typeNotFoundError);\n      } else {\n        console.error(\n          `${typeNotFoundError}  Returning 'parsedValue' of 'null'`\n        );\n        return {\n          ...metafield,\n          parsedValue: null,\n        } as ReturnGeneric;\n      }\n    }\n  }\n}\n\n/**\n * Parses a JSON string while preventing prototype injection attacks.\n */\nexport function parseJSON(json: string) {\n  if (String(json).includes('__proto__')) {\n    return JSON.parse(json, (k, v) => {\n      if (k !== '__proto__') return v;\n    });\n  }\n  return JSON.parse(json);\n}\n\n// taken from https://shopify.dev/apps/metafields/types\nexport const allMetafieldTypesArray = [\n  'boolean',\n  'collection_reference',\n  'color',\n  'date',\n  'date_time',\n  'dimension',\n  'file_reference',\n  'json',\n  'money',\n  'multi_line_text_field',\n  'number_decimal',\n  'number_integer',\n  'page_reference',\n  'product_reference',\n  'rating',\n  'single_line_text_field',\n  'url',\n  'variant_reference',\n  'volume',\n  'weight',\n  // list metafields\n  'list.collection_reference',\n  'list.color',\n  'list.date',\n  'list.date_time',\n  'list.dimension',\n  'list.file_reference',\n  'list.number_integer',\n  'list.number_decimal',\n  'list.page_reference',\n  'list.product_reference',\n  'list.rating',\n  'list.single_line_text_field',\n  'list.url',\n  'list.variant_reference',\n  'list.volume',\n  'list.weight',\n] as const;\n\n/** A union of all the supported `metafield.type`s */\nexport type MetafieldTypeTypes = (typeof allMetafieldTypesArray)[number];\n\n/**\n * A mapping of a Metafield's `type` to the TypeScript type that is returned from `parseMetafield()`\n * For example, when using `parseMetafield()`, the type will be correctly returned when used like the following:\n *\n * ```\n * const parsedMetafield = parseMetafield<ParsedMetafields['boolean']>(metafield);`\n * ```\n * `parsedMetafield.parsedValue`'s type is now `boolean`\n */\nexport type ParsedMetafields<ExtraTypeGeneric = void> = {\n  /** A Metafield that's been parsed, with a `parsedValue` of `boolean` */\n  boolean: Simplify<BooleanParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of a `Collection` object (as defined by the Storefront API) */\n  collection_reference: Simplify<CollectionParsedRefMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `string` */\n  color: Simplify<ColorParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `Date` */\n  date: Simplify<DatesParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `Date` */\n  date_time: Simplify<DatesParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `Measurement` */\n  dimension: Simplify<MeasurementParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of a `GenericFile` object (as defined by the Storefront API) */\n  file_reference: Simplify<FileRefParsedMetafield>;\n  /**\n   * A Metafield that's been parsed, with a `parsedValue` of type `unknown`, unless you pass in the type as a generic. For example:\n   *\n   * ```\n   * ParsedMetafields<MyJsonType>['json']\n   * ```\n   */\n  json: Simplify<JsonParsedMetafield<ExtraTypeGeneric>>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `Money` */\n  money: Simplify<MoneyParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `string` */\n  multi_line_text_field: Simplify<TextParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `number` */\n  number_decimal: Simplify<NumberParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `number` */\n  number_integer: Simplify<NumberParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of a `Page` object (as defined by the Storefront API) */\n  page_reference: Simplify<PageParsedRefMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of a `Product` object (as defined by the Storefront API) */\n  product_reference: Simplify<ProductParsedRefMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `Rating` */\n  rating: Simplify<RatingParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `string` */\n  single_line_text_field: Simplify<TextParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `string` */\n  url: Simplify<TextParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of a `ProductVariant` object (as defined by the Storefront API) */\n  variant_reference: Simplify<VariantParsedRefMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `Measurement` */\n  volume: Simplify<MeasurementParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of type `Measurement` */\n  weight: Simplify<MeasurementParsedMetafield>;\n  // list metafields\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of `Collection` objects (as defined by the Storefront API) */\n  'list.collection_reference': Simplify<CollectionListParsedRefMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of strings */\n  'list.color': Simplify<ColorListParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of Date objects */\n  'list.date': Simplify<DatesListParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of Date objects */\n  'list.date_time': Simplify<DatesListParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of `Measurement` objects */\n  'list.dimension': Simplify<MeasurementListParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of `GenericFile` objects (as defined by the Storefront API) */\n  'list.file_reference': Simplify<FileListParsedRefMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of numbers */\n  'list.number_integer': Simplify<NumberListParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of numbers */\n  'list.number_decimal': Simplify<NumberListParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of `Page` objects (as defined by the Storefront API) */\n  'list.page_reference': Simplify<PageListParsedRefMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of `Product` objects (as defined by the Storefront API) */\n  'list.product_reference': Simplify<ProductListParsedRefMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of `Rating`s */\n  'list.rating': Simplify<RatingListParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of strings */\n  'list.single_line_text_field': Simplify<TextListParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of strings */\n  'list.url': Simplify<TextListParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of `ProductVariant` objects (as defined by the Storefront API) */\n  'list.variant_reference': Simplify<VariantListParsedRefMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of `Measurement`s */\n  'list.volume': Simplify<MeasurementListParsedMetafield>;\n  /** A Metafield that's been parsed, with a `parsedValue` of an array of `Measurement`s */\n  'list.weight': Simplify<MeasurementListParsedMetafield>;\n};\n\ninterface ParsedBase extends MetafieldBaseType {\n  type: MetafieldTypeTypes;\n  parsedValue: unknown;\n}\n\ninterface BooleanParsedMetafield extends ParsedBase {\n  type: 'boolean';\n  parsedValue: boolean | null;\n}\ntype CollectionParsedRefMetafield = MetafieldBaseType & {\n  type: 'collection_reference';\n  parsedValue: Collection | null;\n};\ntype ColorParsedMetafield = MetafieldBaseType & {\n  type: 'color';\n  parsedValue: string | null;\n};\ntype DatesParsedMetafield = MetafieldBaseType & {\n  type: 'date' | 'date_time';\n  parsedValue: Date | null;\n};\n\ntype MeasurementParsedMetafield = MetafieldBaseType & {\n  type: 'dimension' | 'weight' | 'volume';\n  parsedValue: Measurement | null;\n};\n\ntype FileRefParsedMetafield = MetafieldBaseType & {\n  type: 'file_reference';\n  parsedValue: GenericFile | null;\n};\n\ntype JsonParsedMetafield<JsonTypeGeneric = void> = MetafieldBaseType & {\n  type: 'json';\n  parsedValue: JsonTypeGeneric extends void ? unknown : JsonTypeGeneric | null;\n};\n\ntype MoneyParsedMetafield = MetafieldBaseType & {\n  type: 'money';\n  parsedValue: MoneyV2 | null;\n};\n\ntype TextParsedMetafield = MetafieldBaseType & {\n  type: 'single_line_text_field' | 'multi_line_text_field' | 'url';\n  parsedValue: string | null;\n};\n\ntype NumberParsedMetafield = MetafieldBaseType & {\n  type: 'number_decimal' | 'number_integer';\n  parsedValue: number | null;\n};\n\ntype PageParsedRefMetafield = MetafieldBaseType & {\n  type: 'page_reference';\n  parsedValue: Page | null;\n};\n\ntype ProductParsedRefMetafield = MetafieldBaseType & {\n  type: 'product_reference';\n  parsedValue: Product | null;\n};\n\ntype RatingParsedMetafield = MetafieldBaseType & {\n  type: 'rating';\n  parsedValue: Rating | null;\n};\n\ntype VariantParsedRefMetafield = MetafieldBaseType & {\n  type: 'variant_reference';\n  parsedValue: ProductVariant | null;\n};\n\ntype CollectionListParsedRefMetafield = MetafieldBaseType & {\n  type: 'list.collection_reference';\n  parsedValue: Array<Collection> | null;\n};\n\ntype ColorListParsedMetafield = MetafieldBaseType & {\n  type: 'list.color';\n  parsedValue: Array<string> | null;\n};\n\ntype DatesListParsedMetafield = MetafieldBaseType & {\n  type: 'list.date' | 'list.date_time';\n  parsedValue: Array<Date> | null;\n};\n\ntype MeasurementListParsedMetafield = MetafieldBaseType & {\n  type: 'list.dimension' | 'list.weight' | 'list.volume';\n  parsedValue: Array<Measurement> | null;\n};\n\ntype FileListParsedRefMetafield = MetafieldBaseType & {\n  type: 'list.file_reference';\n  parsedValue: Array<GenericFile> | null;\n};\n\ntype TextListParsedMetafield = MetafieldBaseType & {\n  type: 'list.single_line_text_field' | 'list.url';\n  parsedValue: Array<string> | null;\n};\n\ntype NumberListParsedMetafield = MetafieldBaseType & {\n  type: 'list.number_decimal' | 'list.number_integer';\n  parsedValue: Array<number> | null;\n};\n\ntype PageListParsedRefMetafield = MetafieldBaseType & {\n  type: 'list.page_reference';\n  parsedValue: Array<Page> | null;\n};\n\ntype ProductListParsedRefMetafield = MetafieldBaseType & {\n  type: 'list.product_reference';\n  parsedValue: Array<Product> | null;\n};\n\ntype RatingListParsedMetafield = MetafieldBaseType & {\n  type: 'list.rating';\n  parsedValue: Array<Rating> | null;\n};\n\ntype VariantListParsedRefMetafield = MetafieldBaseType & {\n  type: 'list.variant_reference';\n  parsedValue: Array<ProductVariant> | null;\n};\n\nexport type Measurement = {\n  unit: string;\n  value: number;\n};\n\nexport interface Rating {\n  value: number;\n  scale_min: number;\n  scale_max: number;\n}\n","import {useMemo} from 'react';\nimport {useShop} from './ShopifyProvider.js';\nimport {CurrencyCode, MoneyV2} from './storefront-api-types.js';\n\nexport type UseMoneyValue = {\n  /**\n   * The currency code from the `MoneyV2` object.\n   */\n  currencyCode: CurrencyCode;\n  /**\n   * The name for the currency code, returned by `Intl.NumberFormat`.\n   */\n  currencyName?: string;\n  /**\n   * The currency symbol returned by `Intl.NumberFormat`.\n   */\n  currencySymbol?: string;\n  /**\n   * The currency narrow symbol returned by `Intl.NumberFormat`.\n   */\n  currencyNarrowSymbol?: string;\n  /**\n   * The localized amount, without any currency symbols or non-number types from the `Intl.NumberFormat.formatToParts` parts.\n   */\n  amount: string;\n  /**\n   * All parts returned by `Intl.NumberFormat.formatToParts`.\n   */\n  parts: Intl.NumberFormatPart[];\n  /**\n   * A string returned by `new Intl.NumberFormat` for the amount and currency code,\n   * using the `locale` value in the [`LocalizationProvider` component](https://shopify.dev/api/hydrogen/components/localization/localizationprovider).\n   */\n  localizedString: string;\n  /**\n   * The `MoneyV2` object provided as an argument to the hook.\n   */\n  original: MoneyV2;\n  /**\n   * A string with trailing zeros removed from the fractional part, if any exist. If there are no trailing zeros, then the fractional part remains.\n   * For example, `$640.00` turns into `$640`.\n   * `$640.42` remains `$640.42`.\n   */\n  withoutTrailingZeros: string;\n  /**\n   * A string without currency and without trailing zeros removed from the fractional part, if any exist. If there are no trailing zeros, then the fractional part remains.\n   * For example, `$640.00` turns into `640`.\n   * `$640.42` turns into `640.42`.\n   */\n  withoutTrailingZerosAndCurrency: string;\n};\n\n/**\n * The `useMoney` hook takes a [MoneyV2 object](https://shopify.dev/api/storefront/reference/common-objects/moneyv2) and returns a\n * default-formatted string of the amount with the correct currency indicator, along with some of the parts provided by\n * [Intl.NumberFormat](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat).\n * Uses `locale` from `ShopifyProvider`\n */\nexport function useMoney(money: MoneyV2): UseMoneyValue {\n  const {locale} = useShop();\n\n  if (!locale) {\n    throw new Error(\n      `useMoney(): Unable to get 'locale' from 'useShop()', which means that 'locale' was not passed to '<ShopifyProvider/>'. 'locale' is required for 'useMoney()' to work`\n    );\n  }\n\n  const amount = parseFloat(money.amount);\n\n  const options = useMemo(\n    () => ({\n      style: 'currency',\n      currency: money.currencyCode,\n    }),\n    [money.currencyCode]\n  );\n\n  const defaultFormatter = useLazyFormatter(locale, options);\n\n  const nameFormatter = useLazyFormatter(locale, {\n    ...options,\n    currencyDisplay: 'name',\n  });\n\n  const narrowSymbolFormatter = useLazyFormatter(locale, {\n    ...options,\n    currencyDisplay: 'narrowSymbol',\n  });\n\n  const withoutTrailingZerosFormatter = useLazyFormatter(locale, {\n    ...options,\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  });\n\n  const withoutCurrencyFormatter = useLazyFormatter(locale);\n\n  const withoutTrailingZerosOrCurrencyFormatter = useLazyFormatter(locale, {\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  });\n\n  const isPartCurrency = (part: Intl.NumberFormatPart) =>\n    part.type === 'currency';\n\n  // By wrapping these properties in functions, we only\n  // create formatters if they are going to be used.\n  const lazyFormatters = useMemo(\n    () => ({\n      original: () => money,\n      currencyCode: () => money.currencyCode,\n\n      localizedString: () => defaultFormatter().format(amount),\n\n      parts: () => defaultFormatter().formatToParts(amount),\n\n      withoutTrailingZeros: () =>\n        amount % 1 === 0\n          ? withoutTrailingZerosFormatter().format(amount)\n          : defaultFormatter().format(amount),\n\n      withoutTrailingZerosAndCurrency: () =>\n        amount % 1 === 0\n          ? withoutTrailingZerosOrCurrencyFormatter().format(amount)\n          : withoutCurrencyFormatter().format(amount),\n\n      currencyName: () =>\n        nameFormatter().formatToParts(amount).find(isPartCurrency)?.value ??\n        money.currencyCode, // e.g. \"US dollars\"\n\n      currencySymbol: () =>\n        defaultFormatter().formatToParts(amount).find(isPartCurrency)?.value ??\n        money.currencyCode, // e.g. \"USD\"\n\n      currencyNarrowSymbol: () =>\n        narrowSymbolFormatter().formatToParts(amount).find(isPartCurrency)\n          ?.value ?? '', // e.g. \"$\"\n\n      amount: () =>\n        defaultFormatter()\n          .formatToParts(amount)\n          .filter((part) =>\n            ['decimal', 'fraction', 'group', 'integer', 'literal'].includes(\n              part.type\n            )\n          )\n          .map((part) => part.value)\n          .join(''),\n    }),\n    [\n      money,\n      amount,\n      nameFormatter,\n      defaultFormatter,\n      narrowSymbolFormatter,\n      withoutCurrencyFormatter,\n      withoutTrailingZerosFormatter,\n      withoutTrailingZerosOrCurrencyFormatter,\n    ]\n  );\n\n  // Call functions automatically when the properties are accessed\n  // to keep these functions as an implementation detail.\n  return useMemo(\n    () =>\n      new Proxy(lazyFormatters as unknown as UseMoneyValue, {\n        get: (target, key) => Reflect.get(target, key)?.call(null),\n      }),\n    [lazyFormatters]\n  );\n}\n\nfunction useLazyFormatter(locale: string, options?: Intl.NumberFormatOptions) {\n  return useMemo(() => {\n    let memoized: Intl.NumberFormat;\n    return () => (memoized ??= new Intl.NumberFormat(locale, options));\n  }, [locale, options]);\n}\n","import {type ReactNode} from 'react';\nimport {useMoney} from './useMoney.js';\nimport type {MoneyV2, UnitPriceMeasurement} from './storefront-api-types.js';\nimport type {PartialDeep} from 'type-fest';\n\ninterface CustomProps<ComponentGeneric extends React.ElementType> {\n  /** An HTML tag or React Component to be rendered as the base element wrapper. The default is `div`. */\n  as?: ComponentGeneric;\n  /** An object with fields that correspond to the Storefront API's [MoneyV2 object](https://shopify.dev/api/storefront/reference/common-objects/moneyv2). */\n  data: PartialDeep<MoneyV2, {recurseIntoArrays: true}>;\n  /** Whether to remove the currency symbol from the output. */\n  withoutCurrency?: boolean;\n  /** Whether to remove trailing zeros (fractional money) from the output. */\n  withoutTrailingZeros?: boolean;\n  /** A [UnitPriceMeasurement object](https://shopify.dev/api/storefront/latest/objects/unitpricemeasurement). */\n  measurement?: PartialDeep<UnitPriceMeasurement, {recurseIntoArrays: true}>;\n  /** Customizes the separator between the money output and the measurement output. Used with the `measurement` prop. Defaults to `'/'`. */\n  measurementSeparator?: ReactNode;\n}\n\n// This article helps understand the typing here https://www.benmvp.com/blog/polymorphic-react-components-typescript/ Ben is the best :)\nexport type MoneyProps<ComponentGeneric extends React.ElementType> =\n  CustomProps<ComponentGeneric> &\n    Omit<\n      React.ComponentPropsWithoutRef<ComponentGeneric>,\n      keyof CustomProps<ComponentGeneric>\n    >;\n\n/**\n * The `Money` component renders a string of the Storefront API's\n * [MoneyV2 object](https://shopify.dev/api/storefront/reference/common-objects/moneyv2) according to the\n * `locale` in the `ShopifyProvider` component.\n */\nexport function Money<ComponentGeneric extends React.ElementType = 'div'>({\n  data,\n  as,\n  withoutCurrency,\n  withoutTrailingZeros,\n  measurement,\n  measurementSeparator = '/',\n  ...passthroughProps\n}: MoneyProps<ComponentGeneric>) {\n  if (!isMoney(data)) {\n    throw new Error(\n      `<Money/> needs a valid 'data' prop that has 'amount' and 'currencyCode'`\n    );\n  }\n  const moneyObject = useMoney(data);\n  const Wrapper = as ?? 'div';\n\n  let output = moneyObject.localizedString;\n\n  if (withoutCurrency || withoutTrailingZeros) {\n    if (withoutCurrency && !withoutTrailingZeros) {\n      output = moneyObject.amount;\n    } else if (!withoutCurrency && withoutTrailingZeros) {\n      output = moneyObject.withoutTrailingZeros;\n    } else {\n      // both\n      output = moneyObject.withoutTrailingZerosAndCurrency;\n    }\n  }\n\n  return (\n    <Wrapper {...passthroughProps}>\n      {output}\n      {measurement && measurement.referenceUnit && (\n        <>\n          {measurementSeparator}\n          {measurement.referenceUnit}\n        </>\n      )}\n    </Wrapper>\n  );\n}\n\n// required in order to narrow the money object down and make TS happy\nfunction isMoney(\n  maybeMoney: PartialDeep<MoneyV2, {recurseIntoArrays: true}>\n): maybeMoney is MoneyV2 {\n  return (\n    typeof maybeMoney.amount === 'string' &&\n    !!maybeMoney.amount &&\n    typeof maybeMoney.currencyCode === 'string' &&\n    !!maybeMoney.currencyCode\n  );\n}\n","import type {\n  MoneyV2,\n  UnitPriceMeasurement,\n  Product,\n} from './storefront-api-types.js';\nimport {Money, type MoneyProps} from './Money.js';\nimport type {PartialDeep} from 'type-fest';\nimport {flattenConnection} from './flatten-connection.js';\n\nexport interface ProductPriceProps {\n  /** A Storefront API [Product object](https://shopify.dev/api/storefront/reference/products/product). */\n  data: PartialDeep<Product, {recurseIntoArrays: true}>;\n  /** The type of price. Valid values: `regular` (default) or `compareAt`. */\n  priceType?: 'regular' | 'compareAt';\n  /** The type of value. Valid values: `min` (default), `max` or `unit`. */\n  valueType?: 'max' | 'min' | 'unit';\n  /** The ID of the variant. */\n  variantId?: string;\n}\n\n/**\n * The `ProductPrice` component renders a `Money` component with the product\n * [`priceRange`](https://shopify.dev/api/storefront/reference/products/productpricerange)'s `maxVariantPrice` or `minVariantPrice`, for either the regular price or compare at price range.\n */\nexport function ProductPrice<ComponentGeneric extends React.ElementType>(\n  props: ProductPriceProps &\n    Omit<MoneyProps<ComponentGeneric>, 'data' | 'measurement'>\n) {\n  const {\n    priceType = 'regular',\n    variantId,\n    valueType = 'min',\n    data: product,\n    ...passthroughProps\n  } = props;\n\n  if (product == null) {\n    throw new Error(`<ProductPrice/> requires a product as the 'data' prop`);\n  }\n\n  let price: Partial<MoneyV2> | undefined | null;\n  let measurement: Partial<UnitPriceMeasurement> | undefined | null;\n\n  const variant = variantId\n    ? flattenConnection(product?.variants ?? {}).find(\n        (variant) => variant?.id === variantId\n      ) ?? null\n    : null;\n\n  if (priceType === 'compareAt') {\n    if (variantId && variant) {\n      if (variant.compareAtPriceV2?.amount === variant.priceV2?.amount) {\n        return null;\n      }\n      price = variant.compareAtPriceV2;\n    } else if (valueType === 'max') {\n      price = product?.compareAtPriceRange?.maxVariantPrice;\n    } else {\n      price = product?.compareAtPriceRange?.minVariantPrice;\n    }\n  } else {\n    if (variantId && variant) {\n      price = variant.priceV2;\n      if (valueType === 'unit') {\n        price = variant.unitPrice;\n        measurement = variant.unitPriceMeasurement;\n      }\n    } else if (valueType === 'max') {\n      price = product.priceRange?.maxVariantPrice;\n    } else {\n      price = product.priceRange?.minVariantPrice;\n    }\n  }\n\n  if (!price) {\n    return null;\n  }\n\n  if (measurement) {\n    return (\n      <Money {...passthroughProps} data={price} measurement={measurement} />\n    );\n  }\n\n  return <Money {...passthroughProps} data={price} />;\n}\n","import type {\n  ShopifyMonorailPayload,\n  ShopifyMonorailEvent,\n  ShopifyGId,\n} from './analytics-types.js';\n\n/**\n * Builds a Shopify Monorail event from a Shopify Monorail payload and a schema ID.\n * @param payload - The Monorail payload\n * @param schemaId - The schema ID to use\n * @returns The formatted payload\n **/\nexport function schemaWrapper(\n  schemaId: string,\n  payload: ShopifyMonorailPayload\n): ShopifyMonorailEvent {\n  return {\n    schema_id: schemaId,\n    payload,\n    metadata: {\n      event_created_at_ms: Date.now(),\n    },\n  };\n}\n\n/**\n * Parses global id (gid) and returns the resource type and id.\n * @see https://shopify.dev/api/usage/gids\n * @param gid - A shopify GID (string)\n *\n * @example\n * ```ts\n * const {id, resource} = parseGid('gid://shopify/Order/123')\n * // => id = \"123\", resource = 'Order'\n *\n *  * const {id, resource} = parseGid('gid://shopify/Cart/abc123')\n * // => id = \"abc123\", resource = 'Cart'\n * ```\n **/\nexport function parseGid(gid: string | undefined): ShopifyGId {\n  const defaultReturn = {id: '', resource: null};\n\n  if (typeof gid !== 'string') {\n    return defaultReturn;\n  }\n\n  // TODO: add support for parsing query parameters on complex gids\n  // Reference: https://shopify.dev/api/usage/gids\n  const matches = gid.match(/^gid:\\/\\/shopify\\/(\\w+)\\/([a-z0-9]+)/);\n\n  if (!matches || matches.length === 1) {\n    return defaultReturn;\n  }\n  const id = matches[2] ?? null;\n  const resource = matches[1] ?? null;\n\n  return {id, resource};\n}\n\n/**\n * Filters properties from an object and returns a new object with only the properties that have a truthy value.\n * @param keyValuePairs - An object of key-value pairs\n * @param formattedData - An object which will hold the truthy values\n * @returns The formatted object\n **/\nexport function addDataIf(\n  keyValuePairs: ShopifyMonorailPayload,\n  formattedData: ShopifyMonorailPayload\n): ShopifyMonorailPayload {\n  if (typeof keyValuePairs !== 'object') {\n    return {};\n  }\n  Object.entries(keyValuePairs).forEach(([key, value]) => {\n    if (value) {\n      formattedData[key] = value;\n    }\n  });\n  return formattedData;\n}\n\n/**\n * Utility that errors if a function is called on the server.\n * @param fnName - The name of the function\n * @returns A boolean\n **/\nexport function errorIfServer(fnName: string): boolean {\n  if (typeof document === 'undefined') {\n    console.error(\n      `${fnName} should only be used within the useEffect callback or event handlers`\n    );\n    return true;\n  }\n  return false;\n}\n","import {useShop} from './ShopifyProvider.js';\nimport {useLoadScript} from './load-script.js';\nimport {parseGid} from './analytics-utils.js';\n\n// By using 'never' in the \"or\" cases below, it makes these props \"exclusive\" and means that you cannot pass both of them; you must pass either one OR the other.\ntype ShopPayButtonProps = ShopPayButtonStyleProps &\n  (ShopPayVariantIds | ShopPayVariantAndQuantities);\n\ntype ShopPayButtonStyleProps = {\n  /** A string of classes to apply to the `div` that wraps the Shop Pay button. */\n  className?: string;\n  /** A string that's applied to the [CSS custom property (variable)](https://developer.mozilla.org/en-US/docs/Web/CSS/--*) `--shop-pay-button-width` for the [Buy with Shop Pay component](https://shopify.dev/custom-storefronts/tools/web-components#buy-with-shop-pay-component). */\n  width?: string;\n};\n\ntype ShopPayVariantIds = {\n  /** An array of IDs of the variants to purchase with Shop Pay. This will only ever have a quantity of 1 for each variant. If you want to use other quantities, then use `variantIdsAndQuantities`. */\n  variantIds: string[];\n  /** An array of variant IDs and quantities to purchase with Shop Pay. */\n  variantIdsAndQuantities?: never;\n};\n\ntype ShopPayVariantAndQuantities = {\n  /** An array of IDs of the variants to purchase with Shop Pay. This will only ever have a quantity of 1 for each variant. If you want to use other quantities, then use `variantIdsAndQuantities`. */\n  variantIds?: never;\n  /** An array of variant IDs and quantities to purchase with Shop Pay. */\n  variantIdsAndQuantities: Array<{\n    id: string;\n    quantity: number;\n  }>;\n};\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/no-namespace\n  namespace JSX {\n    interface IntrinsicElements {\n      'shop-pay-button': {\n        variants: string;\n        'store-url': string;\n      };\n    }\n  }\n}\n\nconst SHOPJS_URL =\n  'https://cdn.shopify.com/shopifycloud/shop-js/v1.0/client.js';\n\n/**\n * The `ShopPayButton` component renders a button that redirects to the Shop Pay checkout.\n * It renders a [`<shop-pay-button>`](https://shopify.dev/custom-storefronts/tools/web-components) custom element, for which it will lazy-load the source code automatically.\n * It relies on the `<ShopProvider>` context provider.\n */\nexport function ShopPayButton({\n  variantIds,\n  className,\n  variantIdsAndQuantities,\n  width,\n}: ShopPayButtonProps) {\n  const {storeDomain} = useShop();\n  const shopPayLoadedStatus = useLoadScript(SHOPJS_URL);\n\n  let ids: string[] = [];\n\n  if (variantIds && variantIdsAndQuantities) {\n    throw new Error(DoublePropsErrorMessage);\n  }\n\n  if (variantIds) {\n    ids = variantIds.reduce<string[]>((prev, curr) => {\n      const bareId = parseGid(curr).id;\n      if (bareId) {\n        prev.push(bareId);\n      }\n      return prev;\n    }, []);\n  } else if (variantIdsAndQuantities) {\n    ids = variantIdsAndQuantities.reduce<string[]>((prev, curr) => {\n      const bareId = parseGid(curr?.id).id;\n      if (bareId) {\n        prev.push(`${bareId}:${curr?.quantity ?? 1}`);\n      }\n      return prev;\n    }, []);\n  } else {\n    throw new Error(MissingPropsErrorMessage);\n  }\n\n  if (ids.length === 0) {\n    throw new Error(InvalidPropsErrorMessage);\n  }\n\n  const style = width\n    ? ({\n        '--shop-pay-button-width': width,\n      } as React.CSSProperties)\n    : undefined;\n\n  return (\n    <div className={className} style={style}>\n      {shopPayLoadedStatus === 'done' && (\n        <shop-pay-button store-url={storeDomain} variants={ids.join(',')} />\n      )}\n    </div>\n  );\n}\n\nexport const InvalidPropsErrorMessage = `You must pass in \"variantIds\" in the form of [\"gid://shopify/ProductVariant/1\"]`;\nexport const MissingPropsErrorMessage = `You must pass in either \"variantIds\" or \"variantIdsAndQuantities\" to ShopPayButton`;\nexport const DoublePropsErrorMessage = `You must provide either a variantIds or variantIdsAndQuantities prop, but not both in the ShopPayButton component`;\n","export const AnalyticsEventName = {\n  PAGE_VIEW: 'PAGE_VIEW',\n  ADD_TO_CART: 'ADD_TO_CART',\n} as const;\n\nexport const AnalyticsPageType = {\n  article: 'article',\n  blog: 'blog',\n  captcha: 'captcha',\n  cart: 'cart',\n  collection: 'collection',\n  customersAccount: 'customers/account',\n  customersActivateAccount: 'customers/activate_account',\n  customersAddresses: 'customers/addresses',\n  customersLogin: 'customers/login',\n  customersOrder: 'customers/order',\n  customersRegister: 'customers/register',\n  customersResetPassword: 'customers/reset_password',\n  giftCard: 'gift_card',\n  home: 'index',\n  listCollections: 'list-collections',\n  forbidden: '403',\n  notFound: '404',\n  page: 'page',\n  password: 'password',\n  product: 'product',\n  policy: 'policy',\n  search: 'search',\n} as const;\n\nexport const ShopifyAppSource = {\n  hydrogen: 'hydrogen',\n  headless: 'headless',\n} as const;\n\nexport const ShopifyAppId = {\n  hydrogen: '6167201',\n  headless: '12875497473',\n} as const;\n","import {useEffect} from 'react';\nimport {stringify} from 'worktop/cookie';\nimport {SHOPIFY_Y, SHOPIFY_S} from './cart-constants.js';\nimport {buildUUID, getShopifyCookies} from './cookies-utils.js';\n\nconst longTermLength = 60 * 60 * 24 * 360 * 1; // ~1 year expiry\nconst shortTermLength = 60 * 30; // 30 mins\n\n/**\n * Set user and session cookies and refresh the expiry time\n * @param hasUserConsent - Defaults to false. If hasUserConsent is true, we can set Shopify unique user\n * token cookie from expiry of 30 mins to 1 year\n * @param domain - The domain scope of the cookie\n * @example\n * ```tsx\n * import {useShopifyCookies} from '@shopify/hydrogen-react';\n *\n * useShopifyCookies(true, 'my-shop.com')\n * ```\n */\nexport function useShopifyCookies(hasUserConsent = false, domain = ''): void {\n  useEffect(() => {\n    const cookies = getShopifyCookies(document.cookie);\n\n    /**\n     * Set user and session cookies and refresh the expiry time\n     */\n    setCookie(\n      SHOPIFY_Y,\n      cookies[SHOPIFY_Y] || buildUUID(),\n      hasUserConsent ? longTermLength : shortTermLength,\n      domain\n    );\n    setCookie(\n      SHOPIFY_S,\n      cookies[SHOPIFY_S] || buildUUID(),\n      shortTermLength,\n      domain\n    );\n  });\n}\n\nfunction setCookie(\n  name: string,\n  value: string,\n  maxage: number,\n  domain: string\n): void {\n  document.cookie = stringify(name, value, {\n    maxage,\n    domain,\n    samesite: 'Lax',\n    path: '/',\n  });\n}\n","import {\n  ShopifyPageViewPayload,\n  ShopifyMonorailPayload,\n  ShopifyMonorailEvent,\n} from './analytics-types.js';\nimport {ShopifyAppId} from './analytics-constants.js';\nimport {addDataIf, schemaWrapper, parseGid} from './analytics-utils.js';\nimport {buildUUID} from './cookies-utils.js';\n\nconst SCHEMA_ID = 'trekkie_storefront_page_view/1.4';\nconst OXYGEN_DOMAIN = 'myshopify.dev';\n\nexport function pageView(\n  payload: ShopifyPageViewPayload\n): ShopifyMonorailEvent[] {\n  const pageViewPayload = payload;\n  const {id, resource} = parseGid(pageViewPayload.resourceId);\n  const resourceType = resource ? resource.toLowerCase() : undefined;\n  return [\n    schemaWrapper(\n      SCHEMA_ID,\n      addDataIf(\n        {\n          pageType: pageViewPayload.pageType,\n          customerId: pageViewPayload.customerId,\n          resourceType,\n          resourceId: parseInt(id),\n        },\n        formatPayload(pageViewPayload)\n      )\n    ),\n  ];\n}\n\nfunction formatPayload(\n  payload: ShopifyPageViewPayload\n): ShopifyMonorailPayload {\n  return {\n    appClientId: payload.shopifyAppSource\n      ? ShopifyAppId[payload.shopifyAppSource]\n      : ShopifyAppId.headless,\n    isMerchantRequest: isMerchantRequest(payload.url),\n    hydrogenSubchannelId: payload.storefrontId || '0',\n\n    isPersistentCookie: payload.hasUserConsent,\n    uniqToken: payload.uniqueToken,\n    visitToken: payload.visitToken,\n    microSessionId: buildUUID(),\n    microSessionCount: 1,\n\n    url: payload.url,\n    path: payload.path,\n    search: payload.search,\n    referrer: payload.referrer,\n    title: payload.title,\n\n    shopId: parseInt(parseGid(payload.shopId).id),\n    currency: payload.currency,\n    contentLanguage: payload.acceptedLanguage || 'en',\n  };\n}\n\nfunction isMerchantRequest(url: string): boolean {\n  if (typeof url !== 'string') {\n    return false;\n  }\n  const hostname = new URL(url).hostname;\n  if (hostname.indexOf(OXYGEN_DOMAIN) !== -1 || hostname === 'localhost') {\n    return true;\n  }\n  return false;\n}\n","import {\n  ShopifyAnalyticsPayload,\n  ShopifyPageViewPayload,\n  ShopifyAddToCartPayload,\n  ShopifyMonorailPayload,\n  ShopifyAnalyticsProduct,\n  ShopifyMonorailEvent,\n} from './analytics-types.js';\nimport {AnalyticsPageType, ShopifyAppSource} from './analytics-constants.js';\nimport {addDataIf, schemaWrapper, parseGid} from './analytics-utils.js';\nimport {buildUUID} from './cookies-utils.js';\n\nconst SCHEMA_ID = 'custom_storefront_customer_tracking/1.0';\nconst PAGE_RENDERED_EVENT_NAME = 'page_rendered';\nconst COLLECTION_PAGE_RENDERED_EVENT_NAME = 'collection_page_rendered';\nconst PRODUCT_PAGE_RENDERED_EVENT_NAME = 'product_page_rendered';\nconst PRODUCT_ADDED_TO_CART_EVENT_NAME = 'product_added_to_cart';\nconst SEARCH_SUBMITTED_EVENT_NAME = 'search_submitted';\n\nexport function pageView(\n  payload: ShopifyPageViewPayload\n): ShopifyMonorailEvent[] {\n  const pageViewPayload = payload;\n  const additionalPayload = {\n    canonical_url: pageViewPayload.canonicalUrl || pageViewPayload.url,\n    customer_id: pageViewPayload.customerId,\n  };\n  const pageType = pageViewPayload.pageType;\n  const pageViewEvents = [];\n\n  pageViewEvents.push(\n    schemaWrapper(\n      SCHEMA_ID,\n      addDataIf(\n        {\n          event_name: PAGE_RENDERED_EVENT_NAME,\n          ...additionalPayload,\n        },\n        formatPayload(pageViewPayload)\n      )\n    )\n  );\n\n  switch (pageType) {\n    case AnalyticsPageType.collection:\n      pageViewEvents.push(\n        schemaWrapper(\n          SCHEMA_ID,\n          addDataIf(\n            {\n              event_name: COLLECTION_PAGE_RENDERED_EVENT_NAME,\n              ...additionalPayload,\n              collection_name: pageViewPayload.collectionHandle,\n            },\n            formatPayload(pageViewPayload)\n          )\n        )\n      );\n      break;\n    case AnalyticsPageType.product:\n      pageViewEvents.push(\n        schemaWrapper(\n          SCHEMA_ID,\n          addDataIf(\n            {\n              event_name: PRODUCT_PAGE_RENDERED_EVENT_NAME,\n              ...additionalPayload,\n              products: formatProductPayload(pageViewPayload.products),\n              total_value: pageViewPayload.totalValue,\n            },\n            formatPayload(pageViewPayload)\n          )\n        )\n      );\n      break;\n    case AnalyticsPageType.search:\n      pageViewEvents.push(\n        schemaWrapper(\n          SCHEMA_ID,\n          addDataIf(\n            {\n              event_name: SEARCH_SUBMITTED_EVENT_NAME,\n              ...additionalPayload,\n              search_string: pageViewPayload.searchString,\n            },\n            formatPayload(pageViewPayload)\n          )\n        )\n      );\n      break;\n  }\n\n  return pageViewEvents;\n}\n\nexport function addToCart(\n  payload: ShopifyAddToCartPayload\n): ShopifyMonorailEvent[] {\n  const addToCartPayload = payload;\n  const cartToken = parseGid(addToCartPayload.cartId);\n  const cart_token = cartToken?.id ? `${cartToken.id}` : null;\n  return [\n    schemaWrapper(\n      SCHEMA_ID,\n      addDataIf(\n        {\n          event_name: PRODUCT_ADDED_TO_CART_EVENT_NAME,\n          customerId: addToCartPayload.customerId,\n          cart_token,\n          total_value: addToCartPayload.totalValue,\n          products: formatProductPayload(addToCartPayload.products),\n        },\n        formatPayload(addToCartPayload)\n      )\n    ),\n  ];\n}\n\nfunction formatPayload(\n  payload: ShopifyAnalyticsPayload\n): ShopifyMonorailPayload {\n  return {\n    source: payload.shopifyAppSource || ShopifyAppSource.headless,\n    hydrogenSubchannelId: payload.storefrontId || '0',\n\n    is_persistent_cookie: payload.hasUserConsent,\n    ccpa_enforced: false,\n    gdpr_enforced: false,\n    unique_token: payload.uniqueToken,\n    event_time: Date.now(),\n    event_id: buildUUID(),\n\n    event_source_url: payload.url,\n    referrer: payload.referrer,\n    user_agent: payload.userAgent,\n    navigation_type: payload.navigationType,\n    navigation_api: payload.navigationApi,\n\n    shop_id: parseInt(parseGid(payload.shopId).id),\n    currency: payload.currency,\n  };\n}\n\nfunction formatProductPayload(products?: ShopifyAnalyticsProduct[]): string[] {\n  return products\n    ? products.map((p: ShopifyAnalyticsProduct) => {\n        const product = addDataIf(\n          {\n            variant_gid: p.variantGid,\n            category: p.category,\n            sku: p.sku,\n            product_id: parseInt(parseGid(p.productGid).id),\n            variant_id: parseInt(parseGid(p.variantGid).id),\n          },\n          {\n            product_gid: p.productGid,\n            name: p.name,\n            variant: p.variantName || '',\n            brand: p.brand,\n            price: p.price,\n            quantity: Number(p.quantity || 0),\n          }\n        );\n        return JSON.stringify(product);\n      })\n    : [];\n}\n","import {SHOPIFY_S, SHOPIFY_Y} from './cart-constants.js';\nimport type {\n  ClientBrowserParameters,\n  ShopifyAddToCartPayload,\n  ShopifyAnalytics,\n  ShopifyPageViewPayload,\n  ShopifyMonorailEvent,\n} from './analytics-types.js';\nimport {AnalyticsEventName} from './analytics-constants.js';\nimport {errorIfServer} from './analytics-utils.js';\nimport {getShopifyCookies} from './cookies-utils.js';\n\nimport {pageView as trekkiePageView} from './analytics-schema-trekkie-storefront-page-view.js';\nimport {\n  pageView as customerPageView,\n  addToCart as customerAddToCart,\n} from './analytics-schema-custom-storefront-customer-tracking.js';\n\n/**\n * Sends analytics to Shopify\n * @param eventName - Type of analytics event\n * @param payload - The payload of the analytics event\n * @param shopDomain - Defaults to Shopify's analytics endpoint.\n * Supply the Online Store domain so that Shopify analytics can be sent under\n * the same top level domain. (You don't need to set this if you are sending\n * from the server side)\n *\n * @example\n * ```tsx\n * import {\n *   sendShopifyAnalytics,\n *   AnalyticsEventName,\n * } from '@shopify/hydrogen-react';\n *\n * sendShopifyAnalytics({\n *   eventName: AnalyticsEventName.PAGE_VIEW,\n *   payload,\n * }, 'my-shop.myshopify.com');\n * ```\n **/\nexport function sendShopifyAnalytics(\n  {eventName, payload}: ShopifyAnalytics,\n  shopDomain?: string\n): Promise<void> {\n  let events: ShopifyMonorailEvent[] = [];\n\n  if (eventName === AnalyticsEventName.PAGE_VIEW) {\n    const pageViewPayload = payload as ShopifyPageViewPayload;\n    events = events.concat(\n      trekkiePageView(pageViewPayload),\n      customerPageView(pageViewPayload)\n    );\n  } else if (eventName === AnalyticsEventName.ADD_TO_CART) {\n    events = events.concat(\n      customerAddToCart(payload as ShopifyAddToCartPayload)\n    );\n  }\n\n  return sendToShopify(events, shopDomain);\n}\n\ntype MonorailResponse = {\n  status: number;\n  message: string;\n};\n\nconst ERROR_MESSAGE = 'sendShopifyAnalytics request is unsuccessful';\n\nfunction sendToShopify(\n  events: ShopifyMonorailEvent[],\n  shopDomain?: string\n): Promise<void> {\n  const eventsToBeSent = {\n    events,\n    metadata: {\n      event_sent_at_ms: Date.now(),\n    },\n  };\n\n  try {\n    return fetch(\n      shopDomain\n        ? `https://${shopDomain}/.well-known/shopify/monorail/unstable/produce_batch`\n        : 'https://monorail-edge.shopifysvc.com/unstable/produce_batch',\n      {\n        method: 'post',\n        headers: {\n          'content-type': 'text/plain',\n        },\n        body: JSON.stringify(eventsToBeSent),\n      }\n    )\n      .then((response) => {\n        if (!response.ok) {\n          throw new Error('Response failed');\n        }\n        return response.text();\n      })\n      .then((data) => {\n        if (data) {\n          const jsonResponse = JSON.parse(data);\n          jsonResponse.result.forEach((eventResponse: MonorailResponse) => {\n            if (eventResponse.status !== 200) {\n              console.error(ERROR_MESSAGE, '\\n\\n', eventResponse.message);\n            }\n          });\n        }\n      })\n      .catch((err) => {\n        console.error(ERROR_MESSAGE, err);\n        if (__HYDROGEN_DEV__) {\n          throw new Error(ERROR_MESSAGE);\n        }\n      });\n  } catch (error) {\n    // Do nothing\n    return Promise.resolve();\n  }\n}\n\n/**\n * Gathers client browser values commonly used for analytics\n * @returns Empty object if executed on server\n * Otherwise:\n *   - uniqueToken: Shopify unique user token\n *   - visitToken: Shopify session token\n *   - url: location.href\n *   - path: location.pathname\n *   - search: location.search\n *   - referrer: document.referrer\n *   - userAgent: navigator.userAgent\n *   - navigationType: 'navigate' | 'reload' | 'back_forward' | 'prerender' | 'unknown <number>'\n *   - navigationApi: 'PerformanceNavigationTiming' | 'performance.navigation'\n **/\nexport function getClientBrowserParameters():\n  | ClientBrowserParameters\n  | Record<string, never> {\n  if (errorIfServer('getClientBrowserParameters')) {\n    return {};\n  }\n\n  const [navigationType, navigationApi] = getNavigationType();\n  const cookies = getShopifyCookies(document.cookie);\n\n  return {\n    uniqueToken: cookies[SHOPIFY_Y],\n    visitToken: cookies[SHOPIFY_S],\n    url: location.href,\n    path: location.pathname,\n    search: location.search,\n    referrer: document.referrer,\n    title: document.title,\n    userAgent: navigator.userAgent,\n    navigationType,\n    navigationApi,\n  };\n}\n\nfunction getNavigationTypeExperimental(): string | undefined {\n  try {\n    const navigationEntries =\n      performance?.getEntriesByType &&\n      performance?.getEntriesByType('navigation');\n\n    if (navigationEntries && navigationEntries[0]) {\n      // https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming\n      const rawType = (\n        window.performance.getEntriesByType(\n          'navigation'\n        )[0] as PerformanceNavigationTiming\n      )['type'];\n      const navType = rawType && rawType.toString();\n\n      return navType;\n    }\n  } catch (err) {\n    // Do nothing\n  }\n  return undefined;\n}\n\nfunction getNavigationTypeLegacy(): string | undefined {\n  try {\n    if (\n      PerformanceNavigation &&\n      performance?.navigation?.type !== null &&\n      performance?.navigation?.type !== undefined\n    ) {\n      //  https://developer.mozilla.org/en-US/docs/Web/API/Performance/navigation\n      const rawType = performance.navigation.type;\n      switch (rawType) {\n        case PerformanceNavigation.TYPE_NAVIGATE:\n          return 'navigate';\n          break;\n        case PerformanceNavigation.TYPE_RELOAD:\n          return 'reload';\n          break;\n        case PerformanceNavigation.TYPE_BACK_FORWARD:\n          return 'back_forward';\n          break;\n        default:\n          return `unknown: ${rawType}`;\n      }\n    }\n  } catch (err) {\n    // do nothing\n  }\n  return undefined;\n}\n\nfunction getNavigationType(): [string, string] {\n  try {\n    let navApi = 'PerformanceNavigationTiming';\n    let navType = getNavigationTypeExperimental();\n    if (!navType) {\n      navType = getNavigationTypeLegacy();\n      navApi = 'performance.navigation';\n    }\n    if (navType) {\n      return [navType, navApi];\n    } else {\n      return ['unknown', 'unknown'];\n    }\n  } catch (err) {\n    // do nothing\n  }\n  return ['error', 'error'];\n}\n"],"names":["t","n","e","r","o","a","i","u","c","f","s","l","v","y","p","d","x","m","h","b","S","w","j","E","R","N","O","_","k","T","q","z","A","B","C","index","useLayoutEffect","require$$0","g","useSyncExternalStoreShim_production_min","React","ReactSharedInternals","error","format","_len2","args","_key2","printWarning","level","ReactDebugCurrentFrame","stack","argsWithFormat","item","is","objectIs","useState","useEffect","useDebugValue","didWarnOld18Alpha","didWarnUncachedGetSnapshot","useSyncExternalStore","subscribe","getSnapshot","getServerSnapshot","value","cachedValue","_useState","inst","forceUpdate","checkIfSnapshotChanged","handleStoreChange","latestGetSnapshot","prevValue","nextValue","useSyncExternalStore$1","canUseDOM","isServerEnvironment","shim","useSyncExternalStore$2","useSyncExternalStoreShim_development","module","require$$1","withSelector_production_min","useRef","useMemo","useSyncExternalStoreWithSelector","selector","isEqual","instRef","_useMemo","hasMemo","memoizedSnapshot","memoizedSelection","memoizedSelector","nextSnapshot","_nextSelection","currentSelection","prevSnapshot","prevSelection","nextSelection","maybeGetServerSnapshot","getSnapshotWithSelector","getServerSnapshotWithSelector","getSelection","getServerSelection","withSelector_development","useConstant","fn","ref","__read","this","ar","identity","getServiceState","service","currentValue","state","useMachine","stateMachine","options","persistedStateRef","_a","initialMachine","_b","queue","interpret","createMachine","send","event","InterpreterStatus","useIsomorphicLayoutEffect","useServiceResult","useService","_prevState","nextState","useCallback","unsubscribe","storeSnapshot","flattenConnection","connection","noConnectionErr","edge","CartLineAdd","cartFragment","CartCreate","CartLineRemove","CartLineUpdate","CartNoteUpdate","CartBuyerIdentityUpdate","CartAttributesUpdate","CartDiscountCodesUpdate","CartQuery","defaultCartFragment","SFAPI_VERSION","warnings","warnOnce","string","createStorefrontClient","storeDomain","privateStorefrontToken","publicStorefrontToken","storefrontApiVersion","contentType","overrideProps","finalDomainUrl","finalContentType","getPublicTokenHeadersRaw","accessToken","ShopifyContext","createContext","ShopifyProvider","children","shopifyConfig","finalConfig","getShopifyDomain","useShop","shopContext","useContext","CART_ID_STORAGE_KEY","SHOPIFY_STOREFRONT_ID_HEADER","SHOPIFY_STOREFRONT_Y_HEADER","SHOPIFY_STOREFRONT_S_HEADER","SHOPIFY_Y","SHOPIFY_S","tokenHash","buildUUID","hash","crypto","randomValuesArray","hexTime","dateNumber","perfNumber","output","getShopifyCookies","cookies","cookieData","parse","useCartFetch","storefrontId","getPublicTokenHeaders","getStorefrontApiUrl","query","variables","headers","res","useCartActions","numCartLines","countryCode","fetchCart","cartFetch","cartId","cartCreate","cart","cartLineAdd","lines","cartLineUpdate","cartLineRemove","noteUpdate","note","buyerIdentityUpdate","buyerIdentity","cartAttributesUpdate","attributes","discountCodesUpdate","discountCodes","invokeCart","action","assign","context","INITIALIZING_CART_EVENTS","cartFromGraphQL","UPDATING_CART_EVENTS","createCartMachine","initialCart","useCartAPIStateMachine","onCartActionEntry","onCartActionOptimisticUI","onCartActionComplete","cartMachine","data","errors","resultEvent","eventFromFetchResult","isCartActionEvent","isCartFetchResultEvent","cartActionEvent","CartContext","useCart","CartProvider","onCreate","onLineAdd","onLineRemove","onLineUpdate","onNoteUpdate","onBuyerIdentityUpdate","onAttributesUpdate","onDiscountCodesUpdate","onCreateComplete","onLineAddComplete","onLineRemoveComplete","onLineUpdateComplete","onNoteUpdateComplete","onBuyerIdentityUpdateComplete","onAttributesUpdateComplete","onDiscountCodesUpdateComplete","customerAccessToken","prevCountryCode","setPrevCountryCode","prevCustomerAccessToken","setPrevCustomerAccessToken","customerOverridesCountryCode","cartState","cartSend","line","_d","_c","updatedLine","id","countryCodeNotUpdated","cartReady","cartCompleted","countryChanged","fetchingFromStorage","storageAvailable","onCartReadySend","cartEvent","_e","cartInput","cartDisplayState","useDelayedStateUntilHydration","cartContextValue","transposeStatus","_f","_g","status","isPending","startTransition","useTransition","delayedState","setDelayedState","firstTimePending","firstTimePendingFinished","type","storage","ProductOptionsContext","ProductProvider","product","explicitVariantId","variants","isProductVariantArray","getOptions","selectedVariant","setSelectedVariant","getVariantBasedOnIdProp","selectedOptions","setSelectedOptions","getSelectedOptions","newSelectedVariant","setSelectedOption","name","opts","getSelectedVariant","isOptionInStock","option","proposedVariant","sellingPlanGroups","sellingPlanGroup","selectedSellingPlan","setSelectedSellingPlan","selectedSellingPlanAllocation","allocation","useProduct","choices","variant","map","memo","opt","foundVariant","optionSet","maybeVariantArray","BaseButton","props","as","onClick","defaultOnClick","buttonRef","passthroughProps","handleOnClick","clickShouldContinue","Component","AddToCartButton","addingItem","setAddingItem","quantity","sellingPlanId","accessibleAddingToCartLabel","linesAdd","variantId","disabled","handleAddItem","BuyNowButton","checkoutUrl","loading","setLoading","handleBuyNow","CartCheckoutButton","requestedCheckout","setRequestedCheckout","storefrontApiCustomScalars","ExternalVideo","frameBorder","allow","allowFullScreen","finalUrl","urlObject","key","PRODUCTION_CDN_HOSTNAMES","LOCAL_CDN_HOSTNAMES","ALL_CDN_HOSTNAMES","IMG_SRC_SET_SIZES","addImageSizeParametersToUrl","src","width","height","crop","scale","newUrl","multipliedScale","finalWidth","shopifyImageLoader","params","newSrc","allowedHostname","getShopifyImageDimensions","sfapiImage","loaderOptions","elementProps","aspectRatio","Image","loader","widths","decoding","rest","missingUrlError","imgElementWidth","imgElementHeight","finalSrc","maxWidth","finalSrcset","internalImageSrcSet","hasCustomWidths","size","setSizes","srcGenerator","Video","previewImageOptions","playsInline","controls","sourceProps","posterUrl","source","SCRIPTS_LOADED","loadScript","isScriptLoaded","promise","resolve","reject","script","useLoadScript","url","setStatus","stringifiedOptions","loadScriptWrapper","ModelViewer","modelViewer","setModelViewer","callbackRef","node","className","modelViewerLoadedStatus","MediaFile","mediaOptions","parseMetafield","metafield","parsedValue","parseJSON","jsonParseValue","dateString","typeNotFoundError","json","useMoney","money","locale","amount","defaultFormatter","useLazyFormatter","nameFormatter","narrowSymbolFormatter","withoutTrailingZerosFormatter","withoutCurrencyFormatter","withoutTrailingZerosOrCurrencyFormatter","isPartCurrency","part","lazyFormatters","target","memoized","Money","withoutCurrency","withoutTrailingZeros","measurement","measurementSeparator","isMoney","moneyObject","Wrapper","maybeMoney","ProductPrice","priceType","valueType","price","schemaWrapper","schemaId","payload","parseGid","gid","defaultReturn","matches","resource","addDataIf","keyValuePairs","formattedData","errorIfServer","fnName","SHOPJS_URL","ShopPayButton","variantIds","variantIdsAndQuantities","shopPayLoadedStatus","ids","DoublePropsErrorMessage","prev","curr","bareId","MissingPropsErrorMessage","InvalidPropsErrorMessage","style","AnalyticsEventName","AnalyticsPageType","ShopifyAppSource","ShopifyAppId","longTermLength","shortTermLength","useShopifyCookies","hasUserConsent","domain","setCookie","maxage","stringify","SCHEMA_ID","OXYGEN_DOMAIN","pageView","pageViewPayload","resourceType","formatPayload","isMerchantRequest","hostname","PAGE_RENDERED_EVENT_NAME","COLLECTION_PAGE_RENDERED_EVENT_NAME","PRODUCT_PAGE_RENDERED_EVENT_NAME","PRODUCT_ADDED_TO_CART_EVENT_NAME","SEARCH_SUBMITTED_EVENT_NAME","additionalPayload","pageType","pageViewEvents","formatProductPayload","addToCart","addToCartPayload","cartToken","cart_token","products","sendShopifyAnalytics","eventName","shopDomain","events","trekkiePageView","customerPageView","customerAddToCart","sendToShopify","ERROR_MESSAGE","eventsToBeSent","response","eventResponse","err","getClientBrowserParameters","navigationType","navigationApi","getNavigationType","getNavigationTypeExperimental","navigationEntries","rawType","getNavigationTypeLegacy","navApi","navType"],"mappings":"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"}